#temple check triggers, saves some time and space
#if you don't use these after they're merged, I will yell at you
has_temple_complex = { #any version
	OR = {
		has_province_modifier = temple_complex
		has_province_modifier = damaged_temple_complex
		has_province_modifier = derelict_temple_complex
		has_province_modifier = ruined_temple_complex
		has_province_modifier = corrupted_temple_complex
		has_province_modifier = corrupted_temple_complex_inactive
	}
}

has_non_ruined_temple_complex = {
	OR = {
		has_province_modifier = temple_complex
		has_province_modifier = damaged_temple_complex
		has_province_modifier = derelict_temple_complex
		has_province_modifier = corrupted_temple_complex
		has_province_modifier = corrupted_temple_complex_inactive
	}
}

has_non_corrupted_temple_complex = {
	OR = {
		has_province_modifier = temple_complex
		has_province_modifier = damaged_temple_complex
		has_province_modifier = derelict_temple_complex
		has_province_modifier = ruined_temple_complex
	}
}

has_non_ruined_or_corrupted_temple_complex = {
	OR = {
		has_province_modifier = temple_complex
		has_province_modifier = damaged_temple_complex
		has_province_modifier = derelict_temple_complex
	}
}

has_damaged_derelict_or_corrupted_temple_complex = {
	OR = {
		has_province_modifier = damaged_temple_complex
		has_province_modifier = derelict_temple_complex
		has_province_modifier = corrupted_temple_complex
	}
}

has_non_corrupted_corrupted_or_ruined_temple_complex = {
	OR = {
		has_province_modifier = corrupted_temple_complex
		has_province_modifier = ruined_temple_complex
		has_province_modifier = temple_complex
	}
}

#### The Rending ####

#####################

own_domain = {
	OR = { # a workaround to bypass the fact that type = all is a special case in calc_true_if
		$great_spirit$_spirit_area = {
			type = all
			country_or_non_sovereign_subject_holds = ROOT
		}
		always = no
	}
}

owned_domains = {
	calc_true_if = {
		amount = $number$
		own_domain = { great_spirit = yanhe }
		own_domain = { great_spirit = dhenbasana }
		own_domain = { great_spirit = tughayasa }
		own_domain = { great_spirit = hengdu_bowu }
		own_domain = { great_spirit = hukai }
		own_domain = { great_spirit = telebei }
		own_domain = { great_spirit = phokhao }
		own_domain = { great_spirit = gehet_ketine }
		own_domain = { great_spirit = lupulan }
		own_domain = { great_spirit = semat_tidukhai }
		own_domain = { great_spirit = cinulau }
		own_domain = { great_spirit = hokuma }
	}
}


can_hire_hunter = {
	own_domain = { great_spirit = $great_spirit$ }
	OR = {
		ai = no
		AND = { # ai can take option only if no player own a province in spirit domain
			ai = yes
			$great_spirit$_spirit_area = {
				type = all
				owner = {
					ai = yes
				}
			}
		}
	}
}

can_choose_new_appeasement_target = {
	OR = {
		has_country_flag = rending_appease_flag
		has_country_flag = rending_primary_done
	}
	OR = {
		AND = {
			marutha_spirit_area = {
				type = any
				country_or_non_sovereign_subject_holds = ROOT
			}
			NOT = { has_country_flag = marutha_appeased }
		}
		AND = {
			dhenbasana_spirit_area = {
				type = any
				country_or_non_sovereign_subject_holds = ROOT
			}
			NOT = { has_country_flag = dhenbasana_appeased }
		}
		AND = {
			kharunyana_spirit_area = {
				type = any
				country_or_non_sovereign_subject_holds = ROOT
			}
			NOT = { has_country_flag = kharunyana_appeased }
		}
		AND = {
			tughayasa_spirit_area = {
				type = any
				country_or_non_sovereign_subject_holds = ROOT
			}
			NOT = { has_country_flag = tughayasa_appeased }
		}
		AND = {
			hengdu_bowu_spirit_area = {
				type = any
				country_or_non_sovereign_subject_holds = ROOT
			}
			NOT = { has_country_flag = hengdu_bowu_appeased }
		}
		AND = {
			OR = {
				hukai_spirit_area = {
					type = any
					country_or_non_sovereign_subject_holds = ROOT
				}
				telebei_spirit_area = {
					type = any
					country_or_non_sovereign_subject_holds = ROOT
				}									
			}
			NOT = { has_country_flag = hukai_telebei_appeased }
		}
		AND = {
			phokhao_spirit_area = {
				type = any
				country_or_non_sovereign_subject_holds = ROOT
			}
			NOT = { has_country_flag = phokhao_appeased }
		}
		AND = {
			gehet_ketine_spirit_area = {
				type = any
				country_or_non_sovereign_subject_holds = ROOT
			}
			NOT = { has_country_flag = gehet_ketine_appeased }
		}
		AND = {
			lupulan_spirit_area = {
				type = any
				country_or_non_sovereign_subject_holds = ROOT
			}
			NOT = { has_country_flag = lupulan_appeased }
		}
		AND = {
			cinulau_spirit_area = {
				type = any
				country_or_non_sovereign_subject_holds = ROOT
			}
			NOT = { has_country_flag = cinulau_appeased }
		}
		AND = {
			yanhe_spirit_area = {
				type = any
				country_or_non_sovereign_subject_holds = ROOT
			}
			NOT = { has_country_flag = yanhe_appeased }
		}
		AND = {
			hokuma_spirit_area = {
				type = any
				country_or_non_sovereign_subject_holds = ROOT
			}
			NOT = { has_country_flag = hokuma_appeased }
		}
		AND = {
			huszien_spirit_area = {
				type = any
				country_or_non_sovereign_subject_holds = ROOT
			}
			NOT = { has_country_flag = huszien_appeased }
		}
	}
}

is_scouring_domain = {
	OR = {
		has_country_flag = hokuma_scouring
		has_country_flag = yanhe_scouring
		has_country_flag = kharunyana_scouring
		has_country_flag = phokhao_scouring
		has_country_flag = hengdu_bowu_scouring
		has_country_flag = cinulau_scouring
		has_country_flag = lupulan_scouring
		has_country_flag = dhenbasana_scouring
		has_country_flag = marutha_scouring
		has_country_flag = gehet_ketine_scouring
		has_country_flag = hukai_telebei_scouring
		has_country_flag = huszien_scouring
		has_country_flag = tughayasa_scouring
	}
}

has_unique_spirit_interaction = {
	OR = {
		is_or_was_tag = { tag = Y09 } #Bianfang
	}
}

can_afford_restoration = {
	check_variable = {
		which = CurrentAdmPower
		which = AdmPowerCost
	}
	check_variable = {
		which = CurrentDipPower
		which = DipPowerCost
	}
	check_variable = {
		which = CurrentMilPower
		which = MilPowerCost
	}
	check_variable = {
		which = CurrentTreasury
		which = TreasuryCost
	}
}

has_appeased_marutha = {
	custom_trigger_tooltip = {
		tooltip = has_appeased_marutha_tt
		has_country_flag = marutha_appeased
	}
}

has_appeased_dhenbasana = {
	custom_trigger_tooltip = {
		tooltip = has_appeased_dhenbasana_tt
		has_country_flag = dhenbasana_appeased
	}
}

has_appeased_kharunyana = {
	custom_trigger_tooltip = {
		tooltip = has_appeased_kharunyana_tt
		has_country_flag = kharunyana_appeased
	}
}

has_appeased_tughayasa = {
	custom_trigger_tooltip = {
		tooltip = has_appeased_tughayasa_tt
		has_country_flag = tughayasa_appeased
	}
}

has_appeased_hengdu_bowu = {
	custom_trigger_tooltip = {
		tooltip = has_appeased_hengdu_bowu_tt
		has_country_flag = hengdu_bowu_appeased
	}
}

has_appeased_hukai_telebei = {
	custom_trigger_tooltip = {
		tooltip = has_appeased_hukai_telebei_tt
		has_country_flag = hukai_telebei_appeased
	}
}

has_appeased_phokhao = {
	custom_trigger_tooltip = {
		tooltip = has_appeased_phokhao_tt
		has_country_flag = phokhao_appeased
	}
}

has_appeased_gehet_ketine = {
	custom_trigger_tooltip = {
		tooltip = has_appeased_gehet_ketine_tt
		has_country_flag = gehet_ketine_appeased
	}
}

has_appeased_lupulan = {
	custom_trigger_tooltip = {
		tooltip = has_appeased_lupulan_tt
		has_country_flag = lupulan_appeased
	}
}

has_appeased_cinulau = {
	custom_trigger_tooltip = {
		tooltip = has_appeased_cinulau_tt
		has_country_flag = cinulau_appeased
	}
}

has_appeased_yanhe = {
	custom_trigger_tooltip = {
		tooltip = has_appeased_yanhe_tt
		has_country_flag = yanhe_appeased
	}
}

has_appeased_hokuma = {
	custom_trigger_tooltip = {
		tooltip = has_appeased_hokuma_tt
		has_country_flag = hokuma_appeased
	}
}

has_appeased_huszien = {
	custom_trigger_tooltip = {
		tooltip = has_appeased_huszien_tt
		has_country_flag = huszien_appeased
	}
}

rending_is_over = {
	custom_trigger_tooltip = {
		tooltip = rending_is_over_tt
		has_global_flag = rending_over
	}
}

rending_has_happened = {
	custom_trigger_tooltip = {
		tooltip = rending_has_happened_tt
		has_global_flag = rending_happened
	}
}

rending_has_not_happened = {
	custom_trigger_tooltip = {
		tooltip = rending_has_not_happened_tt
		NOT = { has_global_flag = rending_happened }
	}
}

is_inundated_temple_area = {
	OR = {
		AND = {
			province_group = sramaya_temple_area
			4420 = { has_province_modifier = R36_inundated_temple_complex }
		}
		AND = {
			province_group = sarnavan_temple_area
			4510 = { has_province_modifier = R36_inundated_temple_complex }
		}
		AND = {
			province_group = tughayasa_temple_area
			4527 = { has_province_modifier = R36_inundated_temple_complex }
		}
		AND = {
			province_group = khadisrapur_temple_area
			4465 = { has_province_modifier = R36_inundated_temple_complex }
		}
		AND = {
			province_group = khirnadhiman_temple_area
			4499 = { has_province_modifier = R36_inundated_temple_complex }
		}
		AND = {
			province_group = phangban_temple_area
			4396 = { has_province_modifier = R36_inundated_temple_complex }
		}
	}
}
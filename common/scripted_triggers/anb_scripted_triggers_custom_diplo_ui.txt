#Scripted triggers for custom UI diploactions go here
#Example uses of these are for frame triggers + and button triggers for ai_acceptance
#ai_acceptance triggers that use VATs require an effect to calculate values for the tooltip
#Place scripted effects in common\scripted_effects\anb_scripted_effects_custom_diplo_ui.txt

# is_variable_between = {
# 	check_variable = { which = $var$ value = $low$ } #Above low
# 	NOT = {
# 		AND = {
# 			check_variable = { which = $var$ value = $high$ } #Not above high
# 			NOT = { is_variable_equal = { which = $var$ value = $high$ } } #Edge case
# 		}
# 	}
# }
is_variable_mostly_outside_range = {
	# __Greater than__ or equal to $high$
	# Less than $low$
	OR = {
		check_variable = { which = $var$ value = $high$ }
		NOT = { check_variable = { which = $var$ value = $low$ } }
	}
}

#window_number = $window_number$
custdip_sort_ascending = {
	NOT = { check_variable = { which = show_diplo_container value = $window_number$ } }
}
# custdip_sort_descending = {
# 	# check_variable = { which = show_diplo_container value = check_number }
# 	is_variable_equal = { which = show_diplo_container value = $next_number$ }
# 	NOT = { is_variable_equal = { which = show_diplo_container value = $window_number$ } }
# }

custdip_general_button_trigger = {
	hidden_trigger = {
		OR = {
			#Put scripted triggers for any subcategories in here
			custdip_general_overlord_trigger = yes
			# is_subject = yes
			# has_global_flag = custdip_debug
		}
	}
}
custdip_government_button_trigger = {
	hidden_trigger = {
		OR = {
			#Put scripted triggers for any subcategories in here
			custdip_government_raja_trigger = yes
			# has_global_flag = custdip_debug
		}
	}
}
custdip_religion_button_trigger = {
	hidden_trigger = {
		OR = {
			#Put scripted triggers for any subcategories in here
			custdip_religion_nsc_trigger = yes
			custdip_religion_rs_trigger = yes
			custdip_religion_sp_trigger = yes
			# has_global_flag = custdip_debug
		}
	}
}
custdip_cultural_button_trigger = {
	hidden_trigger = {
		OR = {
			#Put scripted triggers for any subcategories in here
			# has_global_flag = custdip_debug
			always = no
		}
	}
}
custdip_estates_button_trigger = {
	hidden_trigger = {
		OR = {
			#Put scripted triggers for any subcategories in here
			custdip_estates_vampires_trigger = yes
			# has_global_flag = custdip_debug
		}
	}
}
custdip_unique_button_trigger = {
	hidden_trigger = {
		OR = {
			#Put scripted triggers for any subcategories in here
			custdip_unique_Y20_trigger = yes
			custdip_unique_Y10_trigger = yes
			custdip_unique_Z99_trigger = yes
			custdip_unique_B58_trigger = yes
			custdip_unique_F35_trigger = yes
			custdip_unique_B32_trigger = yes
			custdip_unique_J33_trigger = yes
			custdip_unique_Z97_trigger = yes
			custdip_unique_B02_trigger = yes
			custdip_unique_H85_trigger = yes
			custdip_unique_B37_trigger = yes
			custdip_unique_Y25_trigger = yes
			# has_global_flag = custdip_debug
		}
	}
}

custdip_general_overlord_trigger = {
	# num_of_subjects = 1 #Change in the future if necessary
	OR = {
		autonomous_vassal = 1
		centaur_dominion = 1
	}
}
custdip_government_raja_trigger = {
	is_the_raja = yes
}
custdip_religion_nsc_trigger = {
	religion = bulwari_sun_cult
	OR = {
		has_country_modifier = nsc_incense_itar_hasis
		has_country_modifier = nsc_dagger_derumasil
	}
}
custdip_religion_rs_trigger = {
	religion = rinta_seekers
	is_incident_active = incident_rinta_light_up_the_night_sky
	has_country_flag = enabled_light_up_the_night_sky_decision 
	NOT = { has_global_flag = rinta_disable_stealing_funds_flag }
}
custdip_religion_sp_trigger = {
	religion = shadow_pact
	owns = 5689 # this is just for the monument for now, remove this if more diplo actions added to shadow pact
}

custdip_estates_vampires_trigger = {
	OR = {
		has_country_flag = has_vampires_estate
		has_estate = estate_vampires
	}
}
custdip_unique_Y20_trigger = {
	is_or_was_tag = { tag = Y20 }
}
custdip_unique_Y10_trigger = {
	is_or_was_tag = { tag = Y10 }
	mission_completed = yingzhen_everything_permitted
}
custdip_unique_Z99_trigger = {
	tag = Z99
}
custdip_unique_B58_trigger = {
	tag = B58
	mission_completed = adenica_dutiful_servent
}
custdip_unique_F35_trigger = {
	tag = F35
	has_country_flag = azkabar_eclipse_enabled
}
custdip_unique_B32_trigger = {
	tag = B32
}
custdip_unique_J33_trigger = {
	tag = J33
	has_government_mechanic = kalsyto_influence_mechanic
	#If different tags are meant to get this, perhaps a gov interactions tab will be needed
	#Possibly: has_reform = lake_bastion_of_democracy
	#The original diplo actions use: has_government_mechanic = kalsyto_influence_mechanic
}
custdip_unique_Z97_trigger = {
	tag = Z97
}
custdip_unique_B02_trigger = {
	tag = B02
	has_country_flag = corintar_guidance
}
custdip_unique_H85_trigger = {
	tag = H85
	has_country_flag = flag_truedagger_can_do_assassination
}
custdip_unique_B37_trigger = {
	tag = B37
	has_country_flag = in_shadowmoon_conspiracy
}
custdip_unique_Y25_trigger = {
	tag = Y25
	has_country_flag = request_fealty_activated
}













#################################################
# Variable Arithmetic Triggers					#
#	 for ai_acceptance in the custom diplo UI	#
#################################################

feiten_skyport_ai_acceptance_trigger = {
	variable_arithmetic_trigger = {
		custom_tooltip = trigger_ai_accept_string
		# custom_tooltip = feiten_buy_skyport_rights_mercantilism_tt
		#Export all variables first - they're temporary, it's ok, and necessary
		# export_to_variable = { which = ai_accept_var value = trigger_value:always } #0
		#Can skip this and directly export mercantilism first
		export_to_variable = { which = ai_accept_var value = trigger_value:mercantilism who = ROOT with = THIS }
		multiply_variable = { which = ai_accept_var value = -0.5 }
		
		#Base
		change_variable = { which = ai_accept_var value = -20 }
		#They are subject
		if = {
			limit = { ROOT = { is_subject_of = FROM } }
			variable_arithmetic_trigger = {
				change_variable = { which = ai_accept_var value = 25 }
			}
		}
		#Neutral attitude
		if = {
			limit = { ROOT = { ai_attitude = { who = FROM attitude = attitude_neutral } } }
			variable_arithmetic_trigger = {
				change_variable = { which = ai_accept_var value = -10 }
			}
		}
		#Negative attitude
		if = {
			limit = {
				ROOT = {
					OR = {
						ai_attitude = { who = FROM attitude = attitude_hostile }
						ai_attitude = { who = FROM attitude = attitude_rivalry }
						ai_attitude = { who = FROM attitude = attitude_outraged }
						ai_attitude = { who = FROM attitude = attitude_disloyal }
						ai_attitude = { who = FROM attitude = attitude_rebellious }
						ai_attitude = { who = FROM attitude = attitude_threatened }
						ai_attitude = { who = FROM attitude = attitude_domineering }
					}
				}
			}
			variable_arithmetic_trigger = {
				change_variable = { which = ai_accept_var value = -1000 }
			}
		}
		#They are republic
		if = {
			limit = { ROOT = { government = republic } }
			variable_arithmetic_trigger = {
				change_variable = { which = ai_accept_var value = 5 }
			}
		}
		#Religion
		if = {
			limit = { ROOT = { NOT = { religion_group = FROM } } }
			variable_arithmetic_trigger = {
				change_variable = { which = ai_accept_var value = -5 }
			}
		}
		#They have good trade
		if = {
			limit = { ROOT = { home_trade_node = { has_most_province_trade_power = ROOT } } }
			variable_arithmetic_trigger = {
				change_variable = { which = ai_accept_var value = -10 }
			}
		}
		#Not sure whether else/if is ok, using if's for now
		#Opinion
		if = {
			limit = { ROOT = { has_opinion = { who = FROM value = 199 } } }
			variable_arithmetic_trigger = {
				change_variable = { which = ai_accept_var value = 50 }
			}
		}
		if = {
			limit = {
				ROOT = {
					has_opinion = { who = FROM value = 150 }
					NOT = { has_opinion = { who = FROM value = 199 } }
				}
			}
			variable_arithmetic_trigger = {
				change_variable = { which = ai_accept_var value = 40 }
			}
		}
		if = {
			limit = {
				ROOT = {
					has_opinion = { who = FROM value = 100 }
					NOT = { has_opinion = { who = FROM value = 150 } }
				}
			}
			variable_arithmetic_trigger = {
				change_variable = { which = ai_accept_var value = 25 }
			}
		}
		if = {
			limit = {
				ROOT = {
					has_opinion = { who = FROM value = 50 }
					NOT = { has_opinion = { who = FROM value = 100 } }
				}
			}
			variable_arithmetic_trigger = {
				change_variable = { which = ai_accept_var value = 10 }
			}
		}
		#Trust
		if = {
			limit = { ROOT = { trust = { who = FROM value = 100 } } }
			variable_arithmetic_trigger = {
				change_variable = { which = ai_accept_var value = 25 }
			}
		}
		if = {
			limit = {
				ROOT = {
					trust = { who = FROM value = 90 }
					NOT = { trust = { who = FROM value = 100 } }
				}
			}
			variable_arithmetic_trigger = {
				change_variable = { which = ai_accept_var value = 20 }
			}
		}
		if = {
			limit = {
				ROOT = {
					trust = { who = FROM value = 80 }
					NOT = { trust = { who = FROM value = 90 } }
				}
			}
			variable_arithmetic_trigger = {
				change_variable = { which = ai_accept_var value = 15 }
			}
		}
		if = {
			limit = {
				ROOT = {
					trust = { who = FROM value = 70 }
					NOT = { trust = { who = FROM value = 80 } }
				}
			}
			variable_arithmetic_trigger = {
				change_variable = { which = ai_accept_var value = 10 }
			}
		}
		if = {
			limit = {
				ROOT = {
					trust = { who = FROM value = 60 }
					NOT = { trust = { who = FROM value = 70 } }
				}
			}
			variable_arithmetic_trigger = {
				change_variable = { which = ai_accept_var value = 5 }
			}
		}
		#Alliance
		if = {
			limit = { ROOT = { alliance_with = FROM } }
			variable_arithmetic_trigger = {
				change_variable = { which = ai_accept_var value = 10 }
			}
		}
		#Final check - passed as a string
		$custom_trigger$
	}
}

Y25_fealty_ai_acceptance_trigger = {
	variable_arithmetic_trigger = {
		custom_tooltip = trigger_ai_accept_string
		#Export all variables first - they're temporary, it's ok, and necessary
		export_to_variable = { which = ai_accept_var value = trigger_value:always } #=0
		export_to_variable = { which = temp_vassalisation_reasons value = modifier:accept_vassalization_reasons who = FROM with = THIS }
		export_to_variable = { which = temp_diplomatic_reputation value = modifier:diplomatic_reputation who = FROM }
		export_to_variable = { which = temp_dip value = DIP who = FROM }
		export_to_variable = { which = temp_mil value = MIL who = FROM }
		export_to_variable = { which = temp_our_dev value = total_development who = FROM }
		export_to_variable = { which = temp_their_dev value = total_development who = ROOT }
		export_to_variable = { which = temp_prestige value = prestige who = FROM }

		#Y25Base
		change_variable = { which = ai_accept_var value = -45 }
		#Y25OurSize
		change_variable = { which = ai_accept_var which = temp_our_dev }
		#Y25TheirSize
		subtract_variable = { which = ai_accept_var which = temp_their_dev }
		#Y25vassalizationreasons
		change_variable = { which = ai_accept_var which = temp_vassalisation_reasons }
		#Y25dipRep
		multiply_variable = { which = temp_diplomatic_reputation value = 2 }
		change_variable = { which = ai_accept_var which = temp_diplomatic_reputation }
		#Y25RulerDip
		if = {
			limit = { FROM = { dip = 3 } }
			variable_arithmetic_trigger = {
				multiply_variable = { which = temp_dip value = 2 }
				change_variable = { which = ai_accept_var which = temp_dip }
			}
		}
		#Y25RulerMil
		if = {
			limit = { FROM = { mil = 3 } }
			variable_arithmetic_trigger = {
				change_variable = { which = ai_accept_var which = temp_mil }
			}
		}
		#Y25TooBig
		if = {
			limit = { ROOT = { total_development = 150 } }
			variable_arithmetic_trigger = {
				change_variable = { which = ai_accept_var value = -150 }
			}
		}
		#Y25Prestigious
		if = {
			limit = { FROM = { prestige = 50 } }
			variable_arithmetic_trigger = {
				multiply_variable = { which = temp_prestige value = 0.25 }
				change_variable = { which = ai_accept_var which = temp_prestige }
			}
		}
		#Y25Assertive
		if = {
			limit = { FROM = { power_projection = 50 } }
			variable_arithmetic_trigger = {
				change_variable = { which = ai_accept_var value = 15 }
			}
		}
		#Y25Powerful
		if = {
			limit = {
				FROM = {
					army_strength = {
						who = ROOT
						value = 1.5
					}
				}
			}
			variable_arithmetic_trigger = {
				change_variable = { which = ai_accept_var value = 15 }
			}
		}
		#Y25Weak
		if = {
			limit = {
				FROM = {
					NOT = {
						army_strength = {
							who = ROOT
							value = 0.6
						}
					}
				}
			}
			variable_arithmetic_trigger = {
				change_variable = { which = ai_accept_var value = -45 }
			}
		}
		#Y25ImperialClaims
		if = {
			limit = { FROM = { government_rank = 3 } }
			variable_arithmetic_trigger = {
				change_variable = { which = ai_accept_var value = 20 }
			}
		}
		#Final check - passed as a string
		$custom_trigger$
	}
}

J33_invite_into_democratic_sphere_ai_acceptance_trigger = {
	variable_arithmetic_trigger = {
		custom_tooltip = trigger_ai_accept_string
		#Export all variables first - they're temporary, it's ok, and necessary
		export_to_variable = { which = ai_accept_var value = trigger_value:always } #=0
		export_to_variable = { which = temp_opinion value = opinion who = ROOT with = FROM }
		export_to_variable = { which = temp_trust value = trust who = ROOT with = FROM }
		export_to_variable = { which = temp_diplomatic_reputation value = modifier:diplomatic_reputation who = FROM }
		# export_to_variable = { which = temp_our_dev value = total_development who = FROM }
		export_to_variable = { which = temp_their_dev value = total_development who = ROOT }
		export_to_variable = { which = temp_border_distance value = border_distance who = FROM with = ROOT }

		#DIPLO_OPPINION
		multiply_variable = { which = temp_opinion value = 0.125 }
		change_variable = { which = ai_accept_var which = temp_opinion }

		#AI_TRUST_TOWARDS_FROM
		subtract_variable = { which = temp_trust value = 50 }
		#1 trust = +4 ai points
		multiply_variable = { which = temp_trust value = 0.4 }
		change_variable = { which = ai_accept_var which = temp_trust }
		#AI_DIPLOMATIC_REPUTATION
		#1 rep = 3
		multiply_variable = { which = temp_diplomatic_reputation value = 3 }
		change_variable = { which = ai_accept_var which = temp_diplomatic_reputation }
		#AI_TOTAL_DEVELOPMENT
		if = {
			limit = {
				NOT = {
					AND = {
						FROM = { has_government_attribute = emissary_of_liberty }
						OR = {
							ROOT = { is_revolutionary = yes }
							ROOT = { has_country_modifier = discontent_sowed }
						}
					}
				}
			}
			variable_arithmetic_trigger = {
				multiply_variable = { which = temp_their_dev value = -0.25 }
				change_variable = { which = ai_accept_var which = temp_their_dev }
			}
		}
		if = {
			limit = {
				FROM = { has_government_attribute = emissary_of_liberty }
				OR = {
					ROOT = { is_revolutionary = yes }
					ROOT = { has_country_modifier = discontent_sowed }
				}
				NOT = {
					AND = {
						ROOT = { is_revolutionary = yes }
						ROOT = { has_country_modifier = discontent_sowed }
						FROM = { has_country_modifier = J33_revolutionary_vanguard }
					}
				}
			}
			variable_arithmetic_trigger = {
				multiply_variable = { which = temp_their_dev value = -0.125 }
				change_variable = { which = ai_accept_var which = temp_their_dev }
			}
		}
		if = {
			limit = {
				FROM = {
					has_government_attribute = emissary_of_liberty
					has_country_modifier = J33_revolutionary_vanguard
				}
				ROOT = {
					is_revolutionary = yes
					has_country_modifier = discontent_sowed
				}
			}
			variable_arithmetic_trigger = {
				multiply_variable = { which = temp_their_dev value = -0.0625 }
				change_variable = { which = ai_accept_var which = temp_their_dev }
			}
		}
		#DIPLO_HAS_AI_HAS_OWN_SUBJECTS_TT
		if = {
			limit = { ROOT = { num_of_subjects = 1 } }
			variable_arithmetic_trigger = {
				change_variable = { which = ai_accept_var value = -20 }
			}
		}
		#KALSYTO_LIBERATOR_TT
		if = {
			limit = {
				ROOT = {
					capital_scope = {
						OR = {
							continent = asia
							superregion = east_serpentspine_superregion
						}
					}
				}
				FROM = { has_country_flag = J33_liberator_haless }
			}
			variable_arithmetic_trigger = {
				change_variable = { which = ai_accept_var value = 20 }
			}
		}
		#KALSYTO_RACIAL_TT
		if = {
			limit = {
				OR = {
					AND = {
						ROOT = { culture_is_dwarven = yes }
						FROM = { has_country_flag = J33_pro_dwarf }
					}
					AND = {
						ROOT = { culture_is_goblin = yes }
						FROM = { has_country_flag = J33_pro_goblin }
					}
				}
			}
			variable_arithmetic_trigger = {
				change_variable = { which = ai_accept_var value = 15 }
			}
		}
		if = {
			limit = {
				OR = {
					AND = {
						ROOT = { culture_is_goblin = yes }
						FROM = { has_country_flag = J33_pro_dwarf }
					}
					AND = {
						ROOT = { culture_is_dwarven = yes }
						FROM = { has_country_flag = J33_pro_goblin }
					}
				}
			}
			variable_arithmetic_trigger = {
				change_variable = { which = ai_accept_var value = -15 }
			}
		}
		#KALSYTO_COLONIAL_TT
		if = {
			limit = {
				ROOT = {
					has_global_flag = J33_agitated_colonies_flag
					is_former_colonial_nation = yes
				}
			}
			variable_arithmetic_trigger = {
				change_variable = { which = ai_accept_var value = 25 }
			}
		}
		#KALSYTO_BLACKMAIL_TT
		if = {
			limit = { FROM = { spy_ideas = 7 } }
			variable_arithmetic_trigger = {
				change_variable = { which = ai_accept_var value = 15 }
			}
		}
		
		#KALSYTO_LIBERATION_TT
		if = {
			limit = {
				FROM = { has_country_flag = J33_liberation_GP }
				ROOT = {
					OR = {
						has_opinion_modifier = {
							modifier = released_in_peace
							who = FROM
							value = 10
						}
						has_opinion_modifier = {
							modifier = returned_core_to_me
							who = FROM
							value = 50
						}
					}
				}
			}
			variable_arithmetic_trigger = {
				change_variable = { which = ai_accept_var value = 15 }
			}
		}
		#attitude_rivalry_DIPLO_ATTITUDE_TT
		#attitude_hostile_DIPLO_ATTITUDE_TT
		#attitude_outraged_DIPLO_ATTITUDE_TT
		#attitude_domineering_DIPLO_ATTITUDE_TT
		if = {
			limit = {
				OR = {
					ROOT = { ai_attitude = { who = FROM attitude = attitude_rivalry } }
					ROOT = { ai_attitude = { who = FROM attitude = attitude_hostile } }
					ROOT = { ai_attitude = { who = FROM attitude = attitude_outraged } }
					ROOT = { ai_attitude = { who = FROM attitude = attitude_domineering } }
				}
			}
			variable_arithmetic_trigger = {
				change_variable = { which = ai_accept_var value = -1000 }
			}
		}
		#attitude_neutral_DIPLO_ATTITUDE_TT
		if = {
			limit = { ROOT = { ai_attitude = { who = FROM attitude = attitude_neutral } } }
			variable_arithmetic_trigger = {
				change_variable = { which = ai_accept_var value = -10 }
			}
		}
		#attitude_allied_DIPLO_ATTITUDE_TT
		#attitude_friendly_DIPLO_ATTITUDE_TT
		#attitude_threatened_DIPLO_ATTITUDE_TT
		if = {
			limit = {
				OR = {
					ROOT = { ai_attitude = { who = FROM attitude = attitude_allied } }
					ROOT = { ai_attitude = { who = FROM attitude = attitude_friendly } }
					AND = {
						ROOT = { ai_attitude = { who = FROM attitude = attitude_threatened } }
						FROM = { NOT = { has_country_flag = J33_citizen_superiority } }
					}
				}
			}
			variable_arithmetic_trigger = {
				change_variable = { which = ai_accept_var value = 20 }
			}
		}
		#attitude_threatened_DIPLO_ATTITUDE_TT
		if = {
			limit = {
				AND = {
					ROOT = { ai_attitude = { who = FROM attitude = attitude_threatened } }
					FROM = { has_country_flag = J33_citizen_superiority }
				}
			}
			variable_arithmetic_trigger = {
				change_variable = { which = ai_accept_var value = 30 }
			}
		}
		#attitude_loyal_DIPLO_ATTITUDE_TT
		if = {
			limit = {
				ROOT = { ai_attitude = { who = FROM attitude = attitude_loyal } }
			}
			variable_arithmetic_trigger = {
				change_variable = { which = ai_accept_var value = 1000 }
			}
		}
		#DIPLO_BORDER_DISTANCE_TT
		if = {
			limit = { FROM = { NOT = { has_country_modifier = J33_global_effort } } }
			#5 units = -1
			variable_arithmetic_trigger = {
				multiply_variable = { which = temp_border_distance value = -0.2 }
				change_variable = { which = ai_accept_var which = temp_border_distance }
			}
		}
		#J33_republic_TT
		if = {
			limit = {
				ROOT = {
					government = republic
					NOT = { has_global_flag = J33_liberty_flag }
				}
			}
			variable_arithmetic_trigger = {
				change_variable = { which = ai_accept_var value = 25 }
			}
		}
		if = {
			limit = {
				ROOT = {
					government = republic
					has_global_flag = J33_liberty_flag
				}
			}
			variable_arithmetic_trigger = {
				change_variable = { which = ai_accept_var value = 75 }
			}
		}
		# J33_native_TT
		if = {
			limit = { ROOT = { government = native } }
			variable_arithmetic_trigger = {
				change_variable = { which = ai_accept_var value = -10 }
			}
		}
		# J33_tribal_TT
		# if = {
		# 	limit = { ROOT = { government = tribal } }
		# 	variable_arithmetic_trigger = {
		# 		change_variable = { which = ai_accept_var value = 0 }
		# 	}
		# }
		#J33_theocracy_TT
		if = {
			limit = {
				ROOT = { government = theocracy }
				NOT = { has_global_flag = J33_singular_divine_flag }
			}
			variable_arithmetic_trigger = {
				change_variable = { which = ai_accept_var value = -10 }
			}
		}
		if = {
			limit = {
				ROOT = { government = theocracy }
				has_global_flag = J33_singular_divine_flag
			}
			variable_arithmetic_trigger = {
				change_variable = { which = ai_accept_var value = 25 }
			}
		}
		#J33_monarchy_TT
		if = {
			limit = { ROOT = { government = monarchy } }
			variable_arithmetic_trigger = {
				change_variable = { which = ai_accept_var value = -25 }
			}
		}
		#kalsyto_influence_counter_TT
		change_variable = { which = ai_accept_var which = kalsyto_influence_counter }

		#Final check - passed as a string
		$custom_trigger$
	}
}

Z97_spread_ravelian_faith_ai_acceptance_trigger = {
	variable_arithmetic_trigger = {
		custom_tooltip = trigger_ai_accept_string
		#Export all variables first - they're temporary, it's ok, and necessary
		export_to_variable = { which = ai_accept_var value = trigger_value:always } #=0
		export_to_variable = { which = temp_opinion value = opinion who = ROOT with = FROM }
		export_to_variable = { which = temp_trust value = trust who = ROOT with = FROM }
		export_to_variable = { which = temp_diplomatic_reputation value = modifier:diplomatic_reputation who = FROM }
		export_to_variable = { which = temp_their_dev value = total_development who = ROOT }
		export_to_variable = { which = temp_border_distance value = border_distance who = FROM with = ROOT }


		#Erudite scaling modifiers
		if = {
			limit = {
				FROM = { has_country_modifier = z97_debate2_erudite1 }
			}
			variable_arithmetic_trigger = {
				change_variable = { which = ai_accept_var value = 25 }
			}
		}
		if = {
			limit = {
				FROM = { has_country_modifier = z97_debate2_erudite2 }
			}
			variable_arithmetic_trigger = {
				change_variable = { which = ai_accept_var value = 50 }
			}
		}
		if = {
			limit = {
				FROM = { has_country_modifier = z97_debate2_erudite3 }
			}
			variable_arithmetic_trigger = {
				change_variable = { which = ai_accept_var value = 75 }
			}
		}

		#DIPLO_OPPINION
		multiply_variable = { which = temp_opinion value = 0.125 }
		change_variable = { which = ai_accept_var which = temp_opinion }


		
		#AI_TRUST_TOWARDS_FROM
		subtract_variable = { which = temp_trust value = 50 }
		change_variable = { which = ai_accept_var which = temp_trust }
		
		#AI_DIPLOMATIC_REPUTATION
		multiply_variable = { which = temp_diplomatic_reputation value = 5 }
		change_variable = { which = ai_accept_var which = temp_diplomatic_reputation }

		#AI_TOTAL_DEVELOPMENT
		multiply_variable = { which = temp_their_dev value = -0.1 }
		change_variable = { which = ai_accept_var which = temp_their_dev }

		#DIPLO_BORDER_DISTANCE_TT
		multiply_variable = { which = temp_border_distance value = -0.1 }
		change_variable = { which = ai_accept_var which = temp_border_distance }

		#attitude_rivalry_DIPLO_ATTITUDE_TT
		#attitude_hostile_DIPLO_ATTITUDE_TT
		#attitude_outraged_DIPLO_ATTITUDE_TT
		#attitude_domineering_DIPLO_ATTITUDE_TT
		if = {
			limit = {
				OR = {
					ROOT = { ai_attitude = { who = FROM attitude = attitude_rivalry } }
					ROOT = { ai_attitude = { who = FROM attitude = attitude_hostile } }
					ROOT = { ai_attitude = { who = FROM attitude = attitude_outraged } }
					ROOT = { ai_attitude = { who = FROM attitude = attitude_domineering } }
				}
			}
			variable_arithmetic_trigger = {
				change_variable = { which = ai_accept_var value = -1000 }
			}
		}
		#attitude_neutral_DIPLO_ATTITUDE_TT
		if = {
			limit = { ROOT = { ai_attitude = { who = FROM attitude = attitude_neutral } } }
			variable_arithmetic_trigger = {
				change_variable = { which = ai_accept_var value = -20 }
			}
		}

		#attitude_friendly_DIPLO_ATTITUDE_TT
		#attitude_threatened_DIPLO_ATTITUDE_TT
		if = {
			limit = {
				OR = {
					ROOT = { ai_attitude = { who = FROM attitude = attitude_friendly } }
					ROOT = { ai_attitude = { who = FROM attitude = attitude_threatened } }
				}
			}
			variable_arithmetic_trigger = {
				change_variable = { which = ai_accept_var value = 10 }
			}
		}

		#attitude_allied_DIPLO_ATTITUDE_TT
		if = {
			limit = { ROOT = { ai_attitude = { who = FROM attitude = attitude_allied } } }
			variable_arithmetic_trigger = {
				change_variable = { which = ai_accept_var value = 50 }
			}
		}
		
		#Final check - passed as a string
		$custom_trigger$
	}
}
Z97_spread_ravelian_estates_ai_acceptance_trigger = {
	variable_arithmetic_trigger = {
		custom_tooltip = trigger_ai_accept_string
		#Export all variables first - they're temporary, it's ok, and necessary
		export_to_variable = { which = ai_accept_var value = trigger_value:always } #=0
		export_to_variable = { which = temp_opinion value = opinion who = ROOT with = FROM }
		export_to_variable = { which = temp_trust value = trust who = ROOT with = FROM }
		export_to_variable = { which = temp_diplomatic_reputation value = modifier:diplomatic_reputation who = FROM }
		export_to_variable = { which = temp_their_dev value = total_development who = ROOT }
		export_to_variable = { which = temp_border_distance value = border_distance who = FROM with = ROOT }


		#Erudite scaling modifiers
		if = {
			limit = {
				FROM = { has_country_modifier = z97_debate2_erudite1 }
			}
			variable_arithmetic_trigger = {
				change_variable = { which = ai_accept_var value = 25 }
			}
		}
		if = {
			limit = {
				FROM = { has_country_modifier = z97_debate2_erudite2 }
			}
			variable_arithmetic_trigger = {
				change_variable = { which = ai_accept_var value = 50 }
			}
		}
		if = {
			limit = {
				FROM = { has_country_modifier = z97_debate2_erudite3 }
			}
			variable_arithmetic_trigger = {
				change_variable = { which = ai_accept_var value = 75 }
			}
		}

		#DIPLO_OPPINION
		multiply_variable = { which = temp_opinion value = 0.125 }
		change_variable = { which = ai_accept_var which = temp_opinion }


		
		#AI_TRUST_TOWARDS_FROM
		subtract_variable = { which = temp_trust value = 50 }
		change_variable = { which = ai_accept_var which = temp_trust }
		
		#AI_DIPLOMATIC_REPUTATION
		multiply_variable = { which = temp_diplomatic_reputation value = 5 }
		change_variable = { which = ai_accept_var which = temp_diplomatic_reputation }

		#AI_TOTAL_DEVELOPMENT
		multiply_variable = { which = temp_their_dev value = -0.1 }
		change_variable = { which = ai_accept_var which = temp_their_dev }

		#DIPLO_BORDER_DISTANCE_TT
		multiply_variable = { which = temp_border_distance value = -0.1 }
		change_variable = { which = ai_accept_var which = temp_border_distance }

		#attitude_rivalry_DIPLO_ATTITUDE_TT
		#attitude_hostile_DIPLO_ATTITUDE_TT
		#attitude_outraged_DIPLO_ATTITUDE_TT
		#attitude_domineering_DIPLO_ATTITUDE_TT
		if = {
			limit = {
				OR = {
					ROOT = { ai_attitude = { who = FROM attitude = attitude_rivalry } }
					ROOT = { ai_attitude = { who = FROM attitude = attitude_hostile } }
					ROOT = { ai_attitude = { who = FROM attitude = attitude_outraged } }
					ROOT = { ai_attitude = { who = FROM attitude = attitude_domineering } }
				}
			}
			variable_arithmetic_trigger = {
				change_variable = { which = ai_accept_var value = -1000 }
			}
		}
		#attitude_neutral_DIPLO_ATTITUDE_TT
		if = {
			limit = { ROOT = { ai_attitude = { who = FROM attitude = attitude_neutral } } }
			variable_arithmetic_trigger = {
				change_variable = { which = ai_accept_var value = -20 }
			}
		}

		#attitude_friendly_DIPLO_ATTITUDE_TT
		#attitude_threatened_DIPLO_ATTITUDE_TT
		if = {
			limit = {
				OR = {
					ROOT = { ai_attitude = { who = FROM attitude = attitude_friendly } }
					ROOT = { ai_attitude = { who = FROM attitude = attitude_threatened } }
				}
			}
			variable_arithmetic_trigger = {
				change_variable = { which = ai_accept_var value = 10 }
			}
		}

		#attitude_allied_DIPLO_ATTITUDE_TT
		if = {
			limit = { ROOT = { ai_attitude = { who = FROM attitude = attitude_allied } } }
			variable_arithmetic_trigger = {
				change_variable = { which = ai_accept_var value = 50 }
			}
		}
		
		#ravstate_already_religious_mages_tt
		if = {
			limit = { ROOT = { has_estate_privilege = estate_mages_organization_religious } }
			variable_arithmetic_trigger = {
				change_variable = { which = ai_accept_var value = 50 }
			}
		}
		#ravstate_already_ravstate_artificers_tt
		if = {
			limit = { ROOT = { has_estate_privilege = estate_artificers_organization_ravelian_control } }
			variable_arithmetic_trigger = {
				change_variable = { which = ai_accept_var value = 50 }
			}
		}

		#Final check - passed as a string
		$custom_trigger$
	}
}
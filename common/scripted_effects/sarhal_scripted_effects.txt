night_coven_collapse = {
	#1. Reform Done
	if = {
		limit = {
			NOT = {
				OR = {
					has_country_flag = night_coven_reform_prog_1
					has_country_flag = night_coven_reform_prog_2
					has_country_flag = night_coven_reform_prog_3
					has_country_flag = night_coven_reform_prog_4
					has_country_flag = night_coven_reform_prog_5
				}
			}
		}
		set_country_flag = night_coven_reform_prog_1
	}
	#2. Reform Done
	else_if = {
		limit = { has_country_flag = night_coven_reform_prog_1 }
		set_country_flag = night_coven_reform_prog_2
		clr_country_flag = night_coven_reform_prog_1
	}
	#3. Reform Done
	else_if = {
		limit = { has_country_flag = night_coven_reform_prog_2 }
		set_country_flag = night_coven_reform_prog_3
		clr_country_flag = night_coven_reform_prog_2
	}
	#4. Reform Done
	else_if = {
		limit = { has_country_flag = night_coven_reform_prog_3 }
		set_country_flag = night_coven_reform_prog_4
		clr_country_flag = night_coven_reform_prog_3
	}
	#5. Reform Done
	else_if = {
		limit = { has_country_flag = night_coven_reform_prog_4 }
		set_country_flag = night_coven_reform_prog_5
		clr_country_flag = night_coven_reform_prog_4
	}
    release_all_subjects = yes #prevents exploit with having opm subjects who get their land returned

	#return provinces
    every_owned_province = {
        limit = { NOT = { region = shadow_swamp_region } }
		remove_core = S70

		#alive core tag
		if = {
			limit = { 
				any_core_country = {
					NOT = { 
						tag = S70 #Trolls
						tag = F68 #Rombeni
					}
					exists = yes
				}
			}
			random_core_country = {
				limit = {
					NOT = { 
						tag = S70 #Trolls
						tag = F68 #Rombeni
					}
					exists = yes
				}
				save_event_target_as = new_owner
			}
			cede_province = event_target:new_owner
			province_event = { id = shadow.3 }
		}
		#dead core tag
		else_if = {
			limit = { 
				any_core_country = {
					NOT = { 
						tag = S70 #Trolls
						tag = F68 #Rombeni
					}
				}
			}
			random_core_country = {
				limit = {
					NOT = { 
						tag = S70 #Trolls
						tag = F68 #Rombeni
					}
				}
				save_event_target_as = new_owner
			}
			cede_province = event_target:new_owner
			event_target:new_owner = { country_event = { id = anbennar_setup.3 } }
		}
		#previous owner
		else = { cede_province = previous_owner }
	}

	#fallback
	if = {
		limit = { any_owned_province = { NOT = { region = shadow_swamp_region } } }
		every_owned_province = {
			limit = { NOT = { region = shadow_swamp_region } }
			random_neighbor_province = {
				limit = { 
					is_city = yes
					NOT = {
						owned_by = S70 #Trolls
						owned_by = F68 #Rombeni
					}
				}
				owner = { save_event_target_as = new_owner }
			}
			cede_province = event_target:new_owner
		}
	}
}

add_yezel_mora_misery_gov_power = {
	# I want this to handle the 3 tiers, but also both constant amounts and variable
	# amounts of power added
	# Note that + is hardcoded in gov_power_var_effect_granular so at the moment you cannot subtract a variable
	# amount of gov power, but you can use a negative constant value
	if = {
		limit = {
			has_government_mechanic = yezel_mora_misery_mechanic_t1
		}
	[[var_amount]
		gov_power_var_effect_granular = {
			mechanic = yezel_mora_misery_mechanic_t1
			power = yezel_mora_misery_power_t1
			var = $var_amount$
			sign = +
		}
	]
	[[const_amount]
		add_government_power = {
			mechanic_type = yezel_mora_misery_mechanic_t1
			power_type = yezel_mora_misery_power_t1
			value = $const_amount$
		}
	]		
	}
	if = {
		limit = {
			has_government_mechanic = yezel_mora_misery_mechanic_t2
		}
	[[var_amount]
		gov_power_var_effect_granular = {
			mechanic = yezel_mora_misery_mechanic_t2
			power = yezel_mora_misery_power_t2
			var = $var_amount$
			sign = +
		}
	]
	[[const_amount]
		add_government_power = {
			mechanic_type = yezel_mora_misery_mechanic_t2
			power_type = yezel_mora_misery_power_t2
			value = $const_amount$
		}
	]	
	}
	if = {
		limit = {
			has_government_mechanic = yezel_mora_misery_mechanic_t3
		}
	[[var_amount]
		gov_power_var_effect_granular = {
			mechanic = yezel_mora_misery_mechanic_t3
			power = yezel_mora_misery_power_t3
			var = $var_amount$
			sign = +
		}
	]
	[[const_amount]
		add_government_power = {
			mechanic_type = yezel_mora_misery_mechanic_t3
			power_type = yezel_mora_misery_power_t3
			value = $const_amount$
		}
	]	
	}
}

yezel_mora_misery_gain_scale_variable = {
	# multiply by OE % over 100, so 160% OE modifiers these amounts by +60%
	if = {
		limit = {
			overextension_percentage = 1
		}
		export_to_variable = {
			variable_name = yezel_mora_misery_overextension
			value = trigger_value:overextension_percentage
		}
		multiply_variable = {
			which = $var$
			which = yezel_mora_misery_overextension
		}
	}

	#This is the scaling factor from the "plane alignment" modifiers
	multiply_variable = {
		which = $var$
		which = yezel_mora_misery_gain_yearly_modifier
	}
}

yezel_mora_misery_yearly_check = {
	# As the planes align, misery gain is scaled up until 1703 when it goes backwards.
	# The first few have the same modifier, so we only need to change the frame variable for the background.
	if = {
		limit = {
			is_year = 1481
			NOT = { is_year = 1482 }
		}
		set_variable = {
			which = yezel_mora_misery_alignment_icon_frame_var
			value = 2
		}
	}
	if = {
		limit = {
			is_year = 1518
			NOT = { is_year = 1519 }
		}
		set_variable = {
			which = yezel_mora_misery_alignment_icon_frame_var
			value = 3
		}
	}
	if = {
		limit = {
			is_year = 1555
			NOT = { is_year = 1556 }
		}
		# The modifiers are just for the icon and tooltip.
		# yezel_mora_misery_gain_yearly_modifier controls the actual change
		remove_country_modifier = yezel_mora_misery_gain_mod_1444
		add_country_modifier = {
			name = yezel_mora_misery_gain_mod_1555
			duration = -1
		}
		set_variable = {
			which = yezel_mora_misery_gain_yearly_modifier
			value = 0.5
		}
		set_variable = {
			which = yezel_mora_misery_alignment_icon_frame_var
			value = 4
		}
		# This event tells the player that the alignment and modifier have changed
		country_event = {
			id = shadow.8
		}
	}
	if = {
		limit = {
			is_year = 1592
			NOT = { is_year = 1593 }
		}
		remove_country_modifier = yezel_mora_misery_gain_mod_1555
		add_country_modifier = {
			name = yezel_mora_misery_gain_mod_1592
			duration = -1
		}
		set_variable = {
			which = yezel_mora_misery_gain_yearly_modifier
			value = 0.75
		}
		set_variable = {
			which = yezel_mora_misery_alignment_icon_frame_var
			value = 5
		}
		country_event = {
			id = shadow.8
		}
	}
	if = {
		limit = {
			is_year = 1629
			NOT = { is_year = 1630 }
		}
		remove_country_modifier = yezel_mora_misery_gain_mod_1592
		add_country_modifier = {
			name = yezel_mora_misery_gain_mod_1629
			duration = -1
		}
		set_variable = {
			which = yezel_mora_misery_gain_yearly_modifier
			value = 0.9
		}
		set_variable = {
			which = yezel_mora_misery_alignment_icon_frame_var
			value = 6
		}
		country_event = {
			id = shadow.8
		}
	}
	if = {
		limit = {
			is_year = 1666
			NOT = { is_year = 1667 }
		}
		remove_country_modifier = yezel_mora_misery_gain_mod_1629
		add_country_modifier = {
			name = yezel_mora_misery_gain_mod_1666
			duration = -1
		}
		set_variable = {
			which = yezel_mora_misery_gain_yearly_modifier
			value = 1
		}
		set_variable = {
			which = yezel_mora_misery_alignment_icon_frame_var
			value = 7
		}
		country_event = {
			id = shadow.8
		}
	}
	if = {
		limit = {
			is_year = 1703
			NOT = { is_year = 1704 }
		}
		remove_country_modifier = yezel_mora_misery_gain_mod_1666
		add_country_modifier = {
			name = yezel_mora_misery_gain_mod_1703
			duration = -1
		}
		set_variable = {
			which = yezel_mora_misery_gain_yearly_modifier
			value = 0.75
		}
		set_variable = {
			which = yezel_mora_misery_alignment_icon_frame_var
			value = 8
		}
		country_event = {
			id = shadow.8
		}
	}
	if = {
		limit = {
			is_year = 1740
			NOT = { is_year = 1741 }
		}
		remove_country_modifier = yezel_mora_misery_gain_mod_1703
		add_country_modifier = {
			name = yezel_mora_misery_gain_mod_1740
			duration = -1
		}
		set_variable = {
			which = yezel_mora_misery_gain_yearly_modifier
			value = 0.5
		}
		set_variable = {
			which = yezel_mora_misery_alignment_icon_frame_var
			value = 9
		}
		country_event = {
			id = shadow.8
		}
	}
	if = {
		limit = {
			is_year = 1777
			NOT = { is_year = 1778 }
		}
		remove_country_modifier = yezel_mora_misery_gain_mod_1740
		add_country_modifier = {
			name = yezel_mora_misery_gain_mod_1777
			duration = -1
		}
		set_variable = {
			which = yezel_mora_misery_gain_yearly_modifier
			value = 0
		}
		set_variable = {
			which = yezel_mora_misery_alignment_icon_frame_var
			value = 10
		}
		country_event = {
			id = shadow.8
		}
	}
}

yezel_mora_misery_monthly_gain = {

	# Misery gain from unrest, stablity, etc
	set_variable = {
		which = yezel_mora_misery_gain
		value = 0
	}

	# +1 misery per point of negative stab
	if = {
		limit = { NOT = { stability = -2 } }
		change_variable = { which = yezel_mora_misery_gain value = 3 }
	}
	else_if = {
		limit = { NOT = { stability = -1 } }
		change_variable = { which = yezel_mora_misery_gain value = 2 }
	}
	else_if = {
		limit = { NOT = { stability = 0 } }
		change_variable = { which = yezel_mora_misery_gain value = 1 }
	}

	# +0.05 misery per province with 90+ devastation
	every_owned_province = {
		limit = {
			devastation = 90
		}
		ROOT = {
			change_variable = {
				which = yezel_mora_misery_gain
				value = 0.05
			}
		}
	}

	# +1 misery per 2 unrest above 0

	# We can't export this global unrest to a variable :( so use a binary search to be most optimal
	if = { limit = { unrest = 18 } # 18-32
		if = { limit = { unrest = 26 } # 26-32
			if = { limit = { unrest = 30 } # 30-32
				if = { limit = { unrest = 32 } # 32
					change_variable = { which = yezel_mora_misery_gain value = 16 }
				}
				else = { # 30
					change_variable = { which = yezel_mora_misery_gain value = 15 }
				}
			}
			else = { # 26-28
				if = { limit = { unrest = 28 } # 28
					change_variable = { which = yezel_mora_misery_gain value = 14 }
				}
				else = { # 26
					change_variable = { which = yezel_mora_misery_gain value = 13 }
				}
			}
		}
		else = { # 18-24
			if = { limit = { unrest = 22 } # 22-24
				if = { limit = { unrest = 24 } # 24
					change_variable = { which = yezel_mora_misery_gain value = 12 }
				}
				else = { # 22
					change_variable = { which = yezel_mora_misery_gain value = 11 }
				}
			}
			else = { # 18-20
				if = { limit = { unrest = 20 } # 20
					change_variable = { which = yezel_mora_misery_gain value = 10 }
				}
				else = { # 18
					change_variable = { which = yezel_mora_misery_gain value = 9 }
				}
			}
		}
	}
	else_if = { limit = { unrest = 2 }  # 2-16
		if = { limit = { unrest = 10 } # 10-16
			if = { limit = { unrest = 14 } # 14-16
				if = { limit = { unrest = 16 } # 16
					change_variable = { which = yezel_mora_misery_gain value = 8 }
				}
				else = { # 14
					change_variable = { which = yezel_mora_misery_gain value = 7 }
				}
			}
			else = { # 10-12
				if = { limit = { unrest = 12 } # 12
					change_variable = { which = yezel_mora_misery_gain value = 6 }
				}
				else = { # 10
					change_variable = { which = yezel_mora_misery_gain value = 5 }
				}
			}
		}
		else = { # 2-8
			if = { limit = { unrest = 6 } # 6-8
				if = { limit = { unrest = 8 } # 8
					change_variable = { which = yezel_mora_misery_gain value = 4 }
				}
				else = { # 6
					change_variable = { which = yezel_mora_misery_gain value = 3 }
				}
			}
			else = { # 2-4
				if = { limit = { unrest = 4 } # 4
					change_variable = { which = yezel_mora_misery_gain value = 2 }
				}
				else = { # 2
					change_variable = { which = yezel_mora_misery_gain value = 1 }
				}
			}
		}
	}
	# I think 32 global unrest is a more than reasonable cap. I've never seen it go that high.

	# Scale by overextension and the plane alignment modifier
	yezel_mora_misery_gain_scale_variable = {
		var = yezel_mora_misery_gain
	}

	# The above numbers are the yearly gain
	divide_variable = {
		which = yezel_mora_misery_gain
		value = 12
	}
	
	add_yezel_mora_misery_gov_power = {
		var_amount = yezel_mora_misery_gain
	}
}

mother_akasik_province = {
	if = {
		limit = {
			owns = $prov$
			$prov$ = {
			[[gained]
				religion = mother_akasik
				NOT = { has_province_flag = akasik_controlled }
			]
			[[lost]
				NOT = { has_province_flag = not_akasik_controlled }
			]
			}
		}
	[[gained]
		$prov$ = {
			set_province_flag = akasik_controlled
			clr_province_flag = not_akasik_controlled
		}
		REB = { change_variable = { akasik_mountains = 1 } }
	]
	[[lost]
		$prov$ = {
			set_province_flag = not_akasik_controlled
			clr_province_flag = akasik_controlled
		}
		REB = { subtract_variable = { akasik_mountains = 1 } }
	]
		country_event = { id = mother_akasik.3 }
		every_country = {
			limit = { religion = mother_akasik }
			country_event = { id = mother_akasik.3 }
		}
	}
}

mother_akasik_mountain_control_check = {
	if = {
		limit = {
			region = akasik_region
			has_terrain = mountain
		}
		if = {
			limit = {
				religion = mother_akasik
				owner = { religion = mother_akasik }
				NOT = { has_province_flag = akasik_controlled }
			}
			REB = { change_variable = { akasik_mountains = 1 } }
			set_province_flag = akasik_controlled
			clr_province_flag = not_akasik_controlled
			every_country = {
				limit = { religion = mother_akasik }
				country_event = { id = mother_akasik.3 }
			}
		}
		if = { # cannot be else_if or the country_event will fail to fire
			limit = {
				NOT = {
					AND = {
						religion = mother_akasik
						owner = { religion = mother_akasik }
					}
				}
				NOT = { has_province_flag = not_akasik_controlled }
			}
			REB = { subtract_variable = { akasik_mountains = 1 } }
			set_province_flag = not_akasik_controlled
			clr_province_flag = akasik_controlled
			every_country = {
				limit = { religion = mother_akasik }
				country_event = { id = mother_akasik.3 }
			}
		}
	}
}

all_owned_nakavy_avo_shrines_deactivate_effect = {
	every_owned_province = {
		limit = { #Should there be a shrine there?
			OR = {
				province_group = shrine_provinces
				continent = africa
			}
			has_any_nakavy_avo_shrine_in_province_trigger = yes
		}
		nakavy_avo_shrines_deactivate_all_province_effect = yes
	}
}
nakavy_avo_shrines_deactivate_all_province_effect = {
	if = {
		limit = { has_province_modifier = lel_shrine_province_active }
		remove_province_modifier = lel_shrine_province_active
		add_permanent_province_modifier = { name = lel_shrine_province duration = -1 }
	}
	
	if = {
		limit = { has_province_modifier = kolo_shrine_province_active }
		remove_province_modifier = kolo_shrine_province_active
		add_permanent_province_modifier = { name = kolo_shrine_province duration = -1 }
	}
	
	if = {
		limit = { has_province_modifier = the_nakazy_shrine_province_active }
		remove_province_modifier = the_nakazy_shrine_province_active
		add_permanent_province_modifier = { name = the_nakazy_shrine_province duration = -1 }
	}
	
	if = {
		limit = { has_province_modifier = turozi_shrine_province_active }
		remove_province_modifier = turozi_shrine_province_active
		add_permanent_province_modifier = { name = turozi_shrine_province duration = -1 }
	}
	
	if = {
		limit = { has_province_modifier = yuye_shrine_province_active }
		remove_province_modifier = yuye_shrine_province_active
		add_permanent_province_modifier = { name = yuye_shrine_province duration = -1 }
	}
	
	if = {
		limit = { has_province_modifier = ozamdi_shrine_province_active }
		remove_province_modifier = ozamdi_shrine_province_active
		add_permanent_province_modifier = { name = ozamdi_shrine_province duration = -1 }
	}
	
	if = {
		limit = { has_province_modifier = jyva_shrine_province_active }
		remove_province_modifier = jyva_shrine_province_active
		add_permanent_province_modifier = { name = jyva_shrine_province duration = -1 }
	}
	
	if = {
		limit = { has_province_modifier = ytrai_shrine_province_active }
		remove_province_modifier = ytrai_shrine_province_active
		add_permanent_province_modifier = { name = ytrai_shrine_province duration = -1 }
	}
	
	if = {
		limit = { has_province_modifier = drongray_shrine_province_active }
		remove_province_modifier = drongray_shrine_province_active
		add_permanent_province_modifier = { name = drongray_shrine_province duration = -1 }
	}
	
	if = {
		limit = { has_province_modifier = elinao_shrine_province_active }
		remove_province_modifier = elinao_shrine_province_active
		add_permanent_province_modifier = { name = elinao_shrine_province duration = -1 }
	}
	
	if = {
		limit = { has_province_modifier = begga2_shrine_province_active }
		remove_province_modifier = begga2_shrine_province_active
		add_permanent_province_modifier = { name = begga2_shrine_province duration = -1 }
	}
	
	if = {
		limit = { has_province_modifier = nakinta_shrine_province_active }
		remove_province_modifier = nakinta_shrine_province_active
		add_permanent_province_modifier = { name = nakinta_shrine_province duration = -1 }
	}
}
nakavy_avo_shrines_activate_owned_deity_shrine_effect = { # $deity$
	hidden_effect = {
		every_owned_province = {
			limit = { has_province_modifier = $deity$_shrine_province }
			nakavy_avo_shrines_activate_specific_deity_province_effect = { deity = $deity$ }
		}
	}
}
nakavy_avo_shrines_deactivate_owned_deity_shrine_effect = { # $deity$
	hidden_effect = {
		every_owned_province = {
			limit = { has_province_modifier = $deity$_shrine_province_active }
			nakavy_avo_shrines_deactivate_specific_deity_province_effect = { deity = $deity$ }
		}
	}
}
nakavy_avo_shrines_activate_specific_deity_province_effect = {
	remove_province_modifier = $deity$_shrine_province
	add_permanent_province_modifier = {
		name = $deity$_shrine_province_active
		duration = -1
	}
}
nakavy_avo_shrines_deactivate_specific_deity_province_effect = {
	remove_province_modifier = $deity$_shrine_province_active
	add_permanent_province_modifier = {
		name = $deity$_shrine_province
		duration = -1
	}
}
nakavy_avo_destroy_shrine_province_effect = { # $deity$
	if = {
		limit = { has_province_modifier = $deity$_shrine_province }
		remove_province_modifier = $deity$_shrine_province
	}
	if = {
		limit = { has_province_modifier = $deity$_shrine_province_active }
		remove_province_modifier = $deity$_shrine_province_active
		if = {
			limit = { owner = { has_ruler_modifier = $deity$_shrine } }
			#Check if they have a different shrine of the same deity before removing the ruler mod
			owner = { country_event = { id = fahvanosy.12 } }
		}
	}
	if = {
		limit = { has_province_modifier = shrine_guard_garisson }
		remove_province_modifier = shrine_guard_garisson
	}
	hidden_effect = {
		if = { #Make sure there's no other shrines in the province before clearing flag
			limit = { NOT = { has_any_nakavy_avo_shrine_in_province_trigger = yes } }
			clr_province_flag = has_nakavy_avo_shrine
		}
	}
}
nakavy_avo_add_shrine_province_effect = { # $deity$
	if = {
		limit = { owner = { has_personal_deity = $deity$ } }
		add_permanent_province_modifier = { name = $deity$_shrine_province_active duration = -1 }
		owner = {
			if = {
				limit = { NOT = { has_ruler_modifier = $deity$_shrine } }
				add_ruler_modifier = { name = $deity$_shrine duration = -1 }
			}
		}
	}
	else = {
		add_permanent_province_modifier = { name = $deity$_shrine_province duration = -1 }
	}
	if = {
		limit = { owner = { has_reform = shrine_guardians_reform } }
		add_province_modifier = { name = shrine_guard_garisson duration = -1 }
	}
	hidden_effect = { set_province_flag = has_nakavy_avo_shrine }
}

#bulwar
bulwar_parliament_bulding_effect = {
	custom_tooltip = bulwar_parliament_bulding_effect_tt
	hidden_effect = {
		every_owned_province = {
			limit = {
				OR = {
					holy_order = servants_of_surael_order
					holy_order = jasienes_daughters_order
					holy_order = servants_of_surakel_order
				}
				has_production_building_trigger = yes
				has_seat_in_parliament = yes
			}
			add_province_modifier = {
				name = bulwar_parliament_buliding_modifier_$VALUE$
				duration = 3650
			}
		}
	}
}

bulwar_parliament_fort_effect = {
	custom_tooltip = bulwar_parliament_fort_effect_tt
	hidden_effect = {
		every_owned_province = {
			limit = {
				OR = {
					holy_order = order_of_exemplars_order
					holy_order = militant_jadd_order
					holy_order = militant_jadd_order_upgraded
					holy_order = eduz_nabari_order
					holy_order = the_unforgivable_order
				}
				has_fort_building_trigger = yes
				has_seat_in_parliament = yes
			}
			add_province_modifier = {
				name = bulwar_parliament_fort_modifier_$VALUE$
				duration = 3650
			}
		}
	}
}
calculate_gardener_duty_effect = {	
	if = {
		limit = { owner = { has_estate_privilege = estate_church_dictate_understanding } }
		if = {
			limit = {
				NOT = { religion_group = bulwari }
				NOT = { superregion= bulwar_superregion }
				NOT = { #Evil Religions
					religion = xhazobkult
					religion = devouring_path
					religion = tswohvwohii
					religion = chahinanito
					religion = song_servants
					religion = leechfather
				}
				NOT = {
					culture = sun_elf
					culture = desert_elf
					culture = dawn_elf
					culture = zanlibi
					culture_group = bulwari
				}
			}
			add_province_modifier = {
				name = estate_church_dictate_understanding_mod
				duration = -1
			}
		}
		else = {
			remove_province_modifier = estate_church_dictate_understanding_mod
		}
	}
}
bulwarize_province = {
	if = { 
		limit = { region = harpy_hills_region }
		if = { 
			limit = { 
				OR = {
					area = kuz_mountains_area
					area = kuzak_area
					area = imuluses_area
				}
			}
			change_culture = kuzarami
		}
		else = {
			change_culture = gelkar
		}
	}
	else_if = {
		limit = { region = bahar_region }
		change_culture = bahari
	}
	else_if = {
		limit = { region = far_salahad_region }
		if = { 
			limit = { 
				OR = {
					area = dasmatus_area
					area = zallirkor_area
					province_id = 4400
				}
			}
			change_culture = maqeti
		}
		else = {
			change_culture = masnsih
		}
	}
	else_if = {
		limit = { region = far_bulwar_region }
		if = { 
			limit = { 
				OR = {
					area = avamezan_area
					area = sareyand_area
				}
			}
			change_culture = zanite
		}
		else_if = { 
			limit = { 
				OR = {
					area = garpix_zokka_area
					area = jikarzax_area
					area = xhurgrum_area
					area = eastern_krahway_area
				}
			}
			change_culture = masnsih
		}
		else = {
			change_culture = surani
		}
	}
	else_if = {
		limit = { region = bulwar_proper_region }
		if = { 
			limit = { 
				OR = {
					area = sur_mountains_area
					area = garpix_tluukt_area
					area = grixekyr_area
					province_id = 689
				}
			}
			change_culture = sadnatu
		}
		else_if = { 
			limit = { 
				OR = {
					area = kumarkand_area
					area = bulwar_area
					area = harklum_area
					area = south_naza_area
					area = traz_buranun_area
					area = north_naza_area
					area = east_naza_area
					area = jixobix_area
				}
			}
			change_culture = zanite
		}
		else = {
			change_culture = brasanni
		}
	}
}

##Aakhetist

change_aakhet_approval = {
	custom_tooltip = change_aakhet_approval_tooltip_$value$
	custom_tooltip = aakhetist_current_approval_tooltip
	hidden_effect = {
		change_variable = { aakhet_approval = $value$ }
	
		#overflow and not host
		if = {
			limit = { 
				check_variable = { aakhet_approval = 101 } 
				NOT = {
					has_global_flag = aakhet_hostless
					has_country_flag = current_aakhet_host
					overlord = { has_country_flag = current_aakhet_host } 
				}
			}
			set_variable = { which = aakhet_overflow which = aakhet_approval }
			change_variable = { aakhet_overflow = -100 }
			if = {
				limit = { check_variable = { aakhet_overflow = 30 } }
				event_target:aakhet_host = { set_country_flag = aakhet_reduction_30 country_event = { id = aakhetist.02 } }
			}
			if = {
				limit = {
					NOT = { check_variable = { aakhet_overflow = 30 } }
					check_variable = { aakhet_overflow = 25 }
				}
				event_target:aakhet_host = { set_country_flag = aakhet_reduction_25 country_event = { id = aakhetist.02 } }
			}
			if = {
				limit = {
					NOT = { check_variable = { aakhet_overflow = 25 } }
					check_variable = { aakhet_overflow = 20 }
				}
				event_target:aakhet_host = { set_country_flag = aakhet_reduction_20 country_event = { id = aakhetist.02 } }
			}
			if = {
				limit = {
					NOT = { check_variable = { aakhet_overflow = 20 } }
					check_variable = { aakhet_overflow = 15 }
				}
				event_target:aakhet_host = { set_country_flag = aakhet_reduction_15 country_event = { id = aakhetist.02 } }
			}
			if = {
				limit = {
					NOT = { check_variable = { aakhet_overflow = 15 } }
					check_variable = { aakhet_overflow = 10 }
				}
				event_target:aakhet_host = { set_country_flag = aakhet_reduction_10 country_event = { id = aakhetist.02 } }
			}
			if = {
				limit = {
					NOT = { check_variable = { aakhet_overflow = 10 } }
					check_variable = { aakhet_overflow = 5 }
				}
				event_target:aakhet_host = { set_country_flag = aakhet_reduction_5 country_event = { id = aakhetist.02 } }
			}
			set_variable = { aakhet_approval = 100 }
			set_variable = { aakhet_overflow = 0 }
		}
		#just overflow
		if = {
			limit = { 
				check_variable = { aakhet_approval = 101 }
				OR = { 
					has_country_flag = current_aakhet_host
					overlord = { has_country_flag = current_aakhet_host } 
				}
			}
			set_variable = { aakhet_approval = 100 }
		}
		#Aakhet is hostless
		if = {
			limit = {
				check_variable = { aakhet_approval = 101 }
				has_global_flag = aakhet_hostless
			}
			set_variable = { aakhet_approval = 100 }
			clr_global_flag = aakhet_hostless
			country_event = { id = aakhetist.01 }
		}
		#below 0 and not host
		if = {
			limit = { 
				NOT = {
					check_variable = { aakhet_approval = 1 } 
					has_country_flag = current_aakhet_host 
				}
			}
			set_variable = { aakhet_approval = 0 }
		}
		#below 0 and host
		if = {
			limit = { 
				NOT = { check_variable = { aakhet_approval = 1 } }
				has_country_flag = current_aakhet_host 
			}
			set_variable = { aakhet_approval = 0 }
			country_event = { id = aakhetist.03 }
		}
	}
}

#to be done in host scope
aakhet_movement = {
	hidden_effect = {
		clr_country_flag = current_aakhet_host

		if = {
			limit = { 
				any_country = {
					religion = aakhetist
					ai = no
					check_variable = { aakhet_approval = 90 }
				}
			}
			random_country = {
				limit = { religion = aakhetist ai = no check_variable = { aakhet_approval = 90 } }
				country_event = { id = aakhetist.01 }
			}
		}
		if = {
			limit = { 
				NOT = {
					any_country = {
						religion = aakhetist
						ai = no
						check_variable = { aakhet_approval = 90 }
					}
				}
				any_country = {
					religion = aakhetist
				}
			}
			random_country = {
				limit = {
					religion = aakhetist
					any_known_country = {
						religion = aakhetist
						NOT = { check_variable = { which = aakhet_approval which = PREV } }
					}
				}
				country_event = { id = aakhetist.01 }
			}
		}
		else = { clr_country_flag = current_aakhet_host clear_global_event_target = aakhet_host set_global_flag = aakhet_hostless }
	}
}

aakhet_reset = {
	if = {
		limit = { 
			has_country_flag = current_aakhet_host 
			OR = {
				NOT = { religion = aakhetist }
				exists = no
			} 
		}
		clr_country_flag = current_aakhet_host
		clear_global_event_target = aakhet_host
		set_global_flag = aakhet_hostless
	}
}


###Adeen
adeen_increase_appease = {
	if = {
		limit = {
			NOT = {
				has_estate_privilege = estate_adeen_adeen_curtailed
				has_estate_privilege = estate_adeen_adeen_integrated
			}
		}
		custom_tooltip = adeen_temp_appeased
		hidden_effect = {
			change_variable = {
				which = adeen_appease_count
				value = 1
			}
		}
	}
}

adeen_spawn_rebels_condition = {
	if = {
		limit = {
			NOT = { 
				estate_loyalty = {
					estate = estate_adeen
					loyalty = 60
				}
				has_estate_privilege = estate_adeen_adeen_curtailed
				has_estate_privilege = estate_adeen_adeen_integrated
			}
		}
		random_owned_province = {
			limit = { is_overseas = no }
			spawn_rebels = {
				type = adeen_rebels
				size = 2
			}
		}
	}
}

adeen_decrease_appease = {
	if = {
		limit = {
			NOT = {
				has_estate_privilege = estate_adeen_adeen_curtailed
				has_estate_privilege = estate_adeen_adeen_integrated
				has_country_flag = adeen_rebel_skip
			}
		}
		custom_tooltip = adeen_temp_displeased
		hidden_effect = {
			change_variable = {
				which = adeen_appease_count
				value = -1
			}
		}
		adeen_spawn_rebels_condition = yes
	}
}

adeen_remove_privilege = {
	if = {
		limit = {
			NOT = {
				has_estate_privilege = estate_adeen_adeen_curtailed
				has_estate_privilege = estate_adeen_adeen_integrated
			}
		}
		adeen_decrease_appease = yes
	}
	add_country_modifier = { name = adeen_revoke_cooldown_mod duration = 730 }
}

adeen_increasing_corruption_low = {
	if = {
		limit = {
			adeen_limit_min = yes
		}
		add_corruption = 0.2
	}
	else_if = {
		limit = {
			adeen_limit_low = yes
		}
		add_corruption = 0.4
	}
	else_if = {
		limit = {
			adeen_limit_mid = yes
		}
		add_corruption = 0.7
	}
	else_if = {
		limit = {
			adeen_limit_high = yes
		}
		add_corruption = 1
	}
}

adeen_increasing_corruption_high = {
	if = {
		limit = {
			adeen_limit_min = yes
		}
		add_corruption = 0.3
	}
	else_if = {
		limit = {
			adeen_limit_low = yes
		}
		add_corruption = 0.5
	}
	else_if = {
		limit = {
			adeen_limit_mid = yes
		}
		add_corruption = 1
	}
	else_if = {
		limit = {
			adeen_limit_high = yes
		}
		add_corruption = 1.5
	}
}

adeen_more_events = {
	if = {
		limit = {
			NOT = {
				has_estate_privilege = estate_adeen_adeen_curtailed
				has_estate_privilege = estate_adeen_adeen_integrated
			}
		}
		custom_tooltip = adeen_additional_events
	}
}

adeen_rebel_chance = {
	if = {
		limit = {
			adeen_limit_min = yes
			NOT = {
				estate_loyalty = {
					estate = estate_adeen
					loyalty = 60
				}
			}
		}
		random_list = {
			1 = {
				random_owned_province = {
					limit = { is_overseas = no }
					spawn_rebels = {
						type = adeen_rebels
						size = 1.5
					}
				}
			}
			1 = {
			}
		}
	}
	else_if = {
		limit = {
			adeen_limit_low = yes
			NOT = {
				estate_loyalty = {
					estate = estate_adeen
					loyalty = 60
				}
			}
		}
		random_list = {
			3 = {
				random_owned_province = {
					limit = { is_overseas = no }
					spawn_rebels = {
						type = adeen_rebels
						size = 2
					}
				}
			}
			1 = {
			}
		}
	}
	else_if = {
		limit = {
			adeen_limit_mid = yes
			NOT = {
				estate_loyalty = {
					estate = estate_adeen
					loyalty = 65
				}
			}
		}
		random_list = {
			3 = {
				random_owned_province = {
					limit = { is_overseas = no }
					spawn_rebels = {
						type = adeen_rebels
						size = 2
					}
				}
			}
			1 = {
			}
		}
	}
	else_if = {
		limit = {
			adeen_limit_high = yes
			NOT = {
				estate_loyalty = {
					estate = estate_adeen
					loyalty = 65
				}
			}
		}
		random_list = {
			3 = {
				random_owned_province = {
					limit = { is_overseas = no }
					spawn_rebels = {
						type = adeen_rebels
						size = 2.5
					}
				}
			}
			1 = {
			}
		}
	}
}

adeen_temp_loyalty_debuff = { #This should be changed to else_if when else_if is fixed
	if = {
		limit = {
			adeen_limit_min = yes
		}
		add_estate_loyalty_modifier = {
			estate = estate_adeen
			desc = $desc$
			loyalty = -15
			duration = 3650
		}
	}
	if = {
		limit = {
			adeen_limit_low = yes
		}
		add_estate_loyalty_modifier = {
			estate = estate_adeen
			desc = $desc$
			loyalty = -15
			duration = 3650
		}
	}
	if = {
		limit = {
			adeen_limit_mid = yes
		}
		add_estate_loyalty_modifier = {
			estate = estate_adeen
			desc = $desc$
			loyalty = -20
			duration = 3650
		}
	}
	if = {
		limit = {
			adeen_limit_high = yes
		}
		add_estate_loyalty_modifier = {
			estate = estate_adeen
			desc = $desc$
			loyalty = -20
			duration = 3650
		}
	}
	adeen_rebel_chance = yes
}

adeen_loyalty_debuff = { #This should be changed to else_if when else_if is fixed
	if = {
		limit = {
			adeen_limit_min = yes
		}
		add_estate_loyalty = {
			estate = estate_adeen
			loyalty = -15
		}
	}
	if = {
		limit = {
			adeen_limit_low = yes
		}
		add_estate_loyalty = {
			estate = estate_adeen
			loyalty = -15
		}
	}
	if = {
		limit = {
			adeen_limit_mid = yes
		}
		add_estate_loyalty = {
			estate = estate_adeen
			loyalty = -20
		}
	}
	if = {
		limit = {
			adeen_limit_high = yes
		}
		add_estate_loyalty = {
			estate = estate_adeen
			loyalty = -20
		}
	}
	adeen_rebel_chance = yes
}



###Planetouched
set_heir_specific_planetouched_effect = {
    set_heir_flag = heir_ruler_planetouched_personality
	force_add_heir_personality = { personality = $type$_planetouched_personality }
} 

set_heir_random_planetouched_effect = {
    random_list = {
        1 = { set_heir_specific_planetouched_effect = { type = fire } }
        1 = { set_heir_specific_planetouched_effect = { type = water } }
        1 = { set_heir_specific_planetouched_effect = { type = earth } }
        1 = { set_heir_specific_planetouched_effect = { type = wind } }
        1 = { set_heir_specific_planetouched_effect = { type = shadow } }
        1 = { set_heir_specific_planetouched_effect = { type = life } }
    }
}

set_ruler_specific_planetouched_effect = {
    add_ruler_personality = $type$_planetouched_personality
} 

set_ruler_random_planetouched_effect = {
    random_list = {
        1 = { set_ruler_specific_planetouched_effect = { type = fire } }
        1 = { set_ruler_specific_planetouched_effect = { type = water } }
        1 = { set_ruler_specific_planetouched_effect = { type = earth } }
        1 = { set_ruler_specific_planetouched_effect = { type = wind } }
        1 = { set_ruler_specific_planetouched_effect = { type = shadow } }
        1 = { set_ruler_specific_planetouched_effect = { type = life } }
    }
}

# Used in on_actions under on_heir_needed_theocracy.
roll_theocracy_heir_planetouched_effect = { 
	if = { limit = { heir_can_be_planetouched_theocracy = yes }
		if = { limit = { has_ruler_flag = heir_ruler_planetouched_personality }
			random = { 
                chance = 1 
                country_event = { id = planetouched.102 days = 120 }
            }
		}
		if = { limit = { NOT = { has_ruler_flag = heir_ruler_planetouched_personality } }
			random = {
                chance = 10
                country_event = { id = planetouched.102 days = 120 }
            }
		}
	}
}

#currently broken, doesn't give trait when in scripted_effect
create_planetouched_general_effect = {
	if = {
		limit = { army_tradition = 80 }
		define_general = {
			fire = 5
			shock = 5
			manuever = 5
			siege = 3
			trait = planetouched_commander_personality
		}
	}
	else_if = {
		limit = { army_tradition = 60 }
		define_general = {
			fire = 4
			shock = 5
			manuever = 5
			siege = 2
			trait = planetouched_commander_personality
		}
	}
	else_if = {
		limit = { army_tradition = 40 }
		define_general = {
			fire = 3
			shock = 5
			manuever = 4
			siege = 1
			trait = planetouched_commander_personality
		}
	}
	else_if = {
		limit = { army_tradition = 20 }
		define_general = {
			fire = 3
			shock = 4
			manuever = 3
			siege = 1
			trait = planetouched_commander_personality
		}
	}
	else = {
		define_general = {
			fire = 2
			shock = 3
			manuever = 3
			siege = 1
			trait = planetouched_commander_personality
		}
	}
}

estate_action_GRANT_GENERALSHIP_ADMIRALSHIP_ADASA = {
	create_leader_scaling_with_tradition = {
		leader = general
		type = army
	}
	create_leader_scaling_with_tradition = {
		leader = admiral
		type = navy
	}
	add_estate_loyalty = {
		estate = estate_adeen
		loyalty = -15
	}
}





###Genie Cult
genie_cult_power_loss = {
	hidden_effect = {
		subtract_variable = {
			which = genie_cult_power_counter
			value = $value$
		}
	}
}

genie_cult_cooldown = {
	hidden_effect = {
		add_country_modifier = {
			name = genie_cult_cooldown_mod
			duration = 1825
			hidden = yes
		}
	}
}

#Shelokmengi breadbasket reform scripted effect
S57_shelokmengi_breadbasket = {
	if = {
		limit = { 
			NOT = { has_country_modifier = S57_shelokmengi_breadbasketlv$level$ }
		}
		remove_country_modifier = S57_shelokmengi_breadbasketlv00
		remove_country_modifier = S57_shelokmengi_breadbasketlv01
		remove_country_modifier = S57_shelokmengi_breadbasketlv02
		remove_country_modifier = S57_shelokmengi_breadbasketlv03
		remove_country_modifier = S57_shelokmengi_breadbasketlv04
		remove_country_modifier = S57_shelokmengi_breadbasketlv05
		remove_country_modifier = S57_shelokmengi_breadbasketlv06
		remove_country_modifier = S57_shelokmengi_breadbasketlv07
		remove_country_modifier = S57_shelokmengi_breadbasketlv08
		remove_country_modifier = S57_shelokmengi_breadbasketlv09
		remove_country_modifier = S57_shelokmengi_breadbasketlv10
		remove_country_modifier = S57_shelokmengi_breadbasketlv11
		if = {
			limit = { NOT = { has_country_flag = shelokmengi_no_notify_breadbasket_change } }
			country_event = {
				id = flavor_shelokmengi.1$level$
			}
		}
		add_country_modifier = { 
			name = S57_shelokmengi_breadbasketlv$level$
			duration = -1
		}
	}
}


#noukahi pantheon
pilgrimage_success_increase = {
	custom_tooltip = pilgrimage_success_increase_tt
	hidden_effect = {
		change_variable = {
			which = np_journey_success
			value = 1
		}
	}
}

pilgrimage_success_decrease = {
	custom_tooltip = pilgrimage_success_decrease_tt
	hidden_effect = {
		change_variable = {
			which = np_journey_success
			value = -1
		}
	}
}

np_pilgrimmage_setup = {
	add_ruler_modifier = { 
		name = np_on_pilgrimage_mod
		duration = -1  
		desc = np_on_pilgrimage_mod_desc
	}
	set_ruler_flag = np_on_pilgrimage
	hidden_effect = {
		capital_scope = {
			add_province_triggered_modifier = noukahi_pantheon_randomness_ptm
		}
		set_variable = {
			which =  np_journey_progress 
			value = 0
		}
		set_variable = {
			which =  np_journey_success 
			value = 2
		}
		if = {
			limit = { has_ruler_flag = noukahi_so_stupid_pilgrimages_are_easier }
			pilgrimage_success_increase = yes
		}
	}
}

#Hisost Yamok
S23_increase_legacy = {
	if = {
		limit = {
			tag = S23
			or = {
				has_country_flag = s23_seble_heir
				has_country_flag = s23_seble_ruler
			}
		}
		custom_tooltip = S23_inc_legacy_1_tt
		custom_tooltip = S23_legacy_total_tt
		hidden_effect = {
			change_variable = { 
				which = hisost_legacy_points 
				value = 1 
			}
		}
	}
	else = {
		custom_tooltip = S23_legacy_over_tt
	}
}

aldarian_scripted_effect = {
	if = { #Aldarian event chain
		limit = {
			unit_owner = {
				has_country_flag = aldarian_is_general
				is_at_war = yes
				NOT = {
					has_country_modifier = aldarian_battle_cooldown
				}
			}
			general_with_name = "Aldarian Surpašilu"
		}
		unit_owner = {
			change_variable = {
				which = aldarian_battles_won 
				value = 1
			}
			add_country_modifier = {
				name = aldarian_battle_cooldown
				duration = 5
				hidden = yes
			}
			if = {
				limit = {
					check_variable = {
						which = aldarian_battles_won
						value = 2
					}
				}
				country_event = {
					id = bulwar_flavour.140
				}
			}
		}
	}
}

#Tiboktsamo
L53_rank_up_kolovadoy = {
	if = {
		limit = {
			has_ruler_flag = L53_tanynakazy_ruler
			NOT = { has_ruler_modifier = L53_kolovadoy_5 }
		}
		if = {
			limit = { has_ruler_modifier = L53_kolovadoy_4 }
			remove_country_modifier = L53_kolovadoy_4
			add_ruler_modifier = { name = L53_kolovadoy_5 duration = -1 }
			force_add_ruler_personality = { personality = legendary_conqueror_personality }
			hidden_effect = { set_country_flag = L53_reached_rank_5_kolovadoy }
		}
		else_if = {
			limit = { has_ruler_modifier = L53_kolovadoy_3 }
			remove_country_modifier = L53_kolovadoy_3
			add_ruler_modifier = { name = L53_kolovadoy_4 duration = -1 }
		}
		else_if = {
			limit = { has_ruler_modifier = L53_kolovadoy_2 }
			remove_country_modifier = L53_kolovadoy_2
			add_ruler_modifier = { name = L53_kolovadoy_3 duration = -1 }
		}
		else_if = {
			limit = { has_ruler_modifier = L53_kolovadoy_1 }
			remove_country_modifier = L53_kolovadoy_1
			add_ruler_modifier = { name = L53_kolovadoy_2 duration = -1 }
		}
		else = {
			add_ruler_modifier = { name = L53_kolovadoy_1 duration = -1 }
		}
	}
}

form_vyoronsi_nation_effect = {
	change_tag = S72
	hidden_effect = {
		dao_nako_region = {
			limit = { culture = ROOT }
			change_culture = vyoronsi
		}
		horashesh_region = {
			limit = { culture = ROOT }
			change_culture = vyoronsi
		}
	}
	custom_tooltip = S72_culture_tooltip
	primary_and_ruler_culture_change = { race = halfling new_culture = vyoronsi }
	hidden_effect = { restore_country_name = yes }
	#swap_non_generic_missions = yes #so people won't thing you get more missions and it might fix some issues related to mt and pirate missions getting messed up
	if = {
		limit = { NOT = { government_rank = 2 } }
		set_government_rank = 2
	}
	dao_nako_region = {
		limit = { NOT = { owned_by = ROOT } }
		add_permanent_claim = S72
	}
	horashesh_region = {
		limit = { NOT = { owned_by = ROOT } }
		add_permanent_claim = S72
	}
	if = {
		limit = { has_custom_ideas = no }
		country_event = { id = ideagroups.1 } #Swap Ideas
	}
	add_prestige = 25
	add_country_modifier = {
		name = "centralization_modifier"
		duration = 7300
	}
	5710 = {
		move_capital_effect = yes
		change_province_name = "Kolonoma"
		change_culture = ROOT
		change_religion = ROOT
	}
}

#Fangaulan Pantheon
fangaulan_pantheon_activate_holy_site = {
	trigger_switch = {
		on_trigger = province_id
		5808 = { #Junansuar
			remove_province_modifier = fangaulan_pantheon_junansuar_holy_site_inactive
			add_permanent_province_modifier = {
				name = fangaulan_pantheon_junansuar_holy_site_active
				duration = -1
			}
		}
		5710 = { #Kunolo
			remove_province_modifier = fangaulan_pantheon_kunolo_holy_site_inactive
			add_permanent_province_modifier = {
				name = fangaulan_pantheon_kunolo_holy_site_active
				duration = -1
			}
		}
		6098 = { #Rostgrax
			remove_province_modifier = fangaulan_pantheon_rostgrax_holy_site_inactive
			add_permanent_province_modifier = {
				name = fangaulan_pantheon_rostgrax_holy_site_active
				duration = -1
			}
		}
		5734 = { #Bogorr
			remove_province_modifier = fangaulan_pantheon_bogorr_holy_site_inactive
			add_permanent_province_modifier = {
				name = fangaulan_pantheon_bogorr_holy_site_active
				duration = -1
			}
		}
		5787 = { #Zitarr
			remove_province_modifier = fangaulan_pantheon_zitarr_holy_site_inactive
			add_permanent_province_modifier = {
				name = fangaulan_pantheon_zitarr_holy_site_active
				duration = -1
			}
		}
		390 = { #Sirik
			remove_province_modifier = fangaulan_pantheon_sirik_holy_site_inactive
			add_permanent_province_modifier = {
				name = fangaulan_pantheon_sirik_holy_site_active
				duration = -1
			}
		}
		477 = { #Bixanrit
			remove_province_modifier = fangaulan_pantheon_bixanrit_holy_site_inactive
			add_permanent_province_modifier = {
				name = fangaulan_pantheon_bixanrit_holy_site_active
				duration = -1
			}
		}
		5863 = { #Gamyi
			remove_province_modifier = fangaulan_pantheon_gamyi_holy_site_inactive
			add_permanent_province_modifier = {
				name = fangaulan_pantheon_gamyi_holy_site_active
				duration = -1
			}
		}
	}
	fangaulan_pantheon_increase_holy_site_count = yes
	fangaulan_pantheon_update_holy_site_bonus = yes
	clr_province_flag = fangaulan_pantheon_inactive_holy_site
	set_province_flag = fangaulan_pantheon_active_holy_site
}

fangaulan_pantheon_deactivate_holy_site = {
	trigger_switch = {
		on_trigger = province_id
		5808 = { #Junansuar
			remove_province_modifier = fangaulan_pantheon_junansuar_holy_site_active
			add_permanent_province_modifier = {
				name = fangaulan_pantheon_junansuar_holy_site_inactive
				duration = -1
			}
		}
		5710 = { #Kunolo
			remove_province_modifier = fangaulan_pantheon_kunolo_holy_site_active
			add_permanent_province_modifier = {
				name = fangaulan_pantheon_kunolo_holy_site_inactive
				duration = -1
			}
		}
		6098 = { #Rostgrax
			remove_province_modifier = fangaulan_pantheon_rostgrax_holy_site_active
			add_permanent_province_modifier = {
				name = fangaulan_pantheon_rostgrax_holy_site_inactive
				duration = -1
			}
		}
		5734 = { #Bogorr
			remove_province_modifier = fangaulan_pantheon_bogorr_holy_site_active
			add_permanent_province_modifier = {
				name = fangaulan_pantheon_bogorr_holy_site_inactive
				duration = -1
			}
		}
		5787 = { #Zitarr
			remove_province_modifier = fangaulan_pantheon_zitarr_holy_site_active
			add_permanent_province_modifier = {
				name = fangaulan_pantheon_zitarr_holy_site_inactive
				duration = -1
			}
		}
		390 = { #Sirik
			remove_province_modifier = fangaulan_pantheon_sirik_holy_site_active
			add_permanent_province_modifier = {
				name = fangaulan_pantheon_sirik_holy_site_inactive
				duration = -1
			}
		}
		477 = { #Bixanrit
			remove_province_modifier = fangaulan_pantheon_bixanrit_holy_site_active
			add_permanent_province_modifier = {
				name = fangaulan_pantheon_bixanrit_holy_site_inactive
				duration = -1
			}
		}
		5863 = { #Gamyi
			remove_province_modifier = fangaulan_pantheon_gamyi_holy_site_active
			add_permanent_province_modifier = {
				name = fangaulan_pantheon_gamyi_holy_site_inactive
				duration = -1
			}
		}
	}
	fangaulan_pantheon_decrease_holy_site_count = yes
	fangaulan_pantheon_update_holy_site_bonus = yes
	clr_province_flag = fangaulan_pantheon_active_holy_site
	set_province_flag = fangaulan_pantheon_inactive_holy_site
}

fangaulan_pantheon_increase_holy_site_count = {
	5811 = {
		change_variable = {
			which = FangaulanPantheonHolySiteCount
			value = 1
		}
	}
}

fangaulan_pantheon_decrease_holy_site_count = {
	5811 = {
		change_variable = {
			which = FangaulanPantheonHolySiteCount
			value = -1
		}
	}
}

fangaulan_pantheon_update_holy_site_bonus = { #Province
	if = {
		limit = {
			5811 = {
				is_variable_equal  = {
					which = FangaulanPantheonHolySiteCount
					value = 8
				}
			}
		}
		every_country = {
			limit = {
				religion = fangaulan_pantheon
			}
			fangaulan_pantheon_remove_all_religious_power_mod = yes
			add_country_modifier = {
				name = fangaulan_pantheon_religious_power_mod_8
				duration = -1
			}
		}
	}
	else_if = {
		limit = {
			5811 = {
				is_variable_equal  = {
					which = FangaulanPantheonHolySiteCount
					value = 7
				}
			}
		}
		every_country = {
			limit = {
				religion = fangaulan_pantheon
			}
			fangaulan_pantheon_remove_all_religious_power_mod = yes
			add_country_modifier = {
				name = fangaulan_pantheon_religious_power_mod_7
				duration = -1
			}
		}
	}
	else_if = {
		limit = {
			5811 = {
				is_variable_equal  = {
					which = FangaulanPantheonHolySiteCount
					value = 6
				}
			}
		}
		every_country = {
			limit = {
				religion = fangaulan_pantheon
			}
			fangaulan_pantheon_remove_all_religious_power_mod = yes
			add_country_modifier = {
				name = fangaulan_pantheon_religious_power_mod_6
				duration = -1
			}
		}
	}
	else_if = {
		limit = {
			5811 = {
				is_variable_equal  = {
					which = FangaulanPantheonHolySiteCount
					value = 5
				}
			}
		}
		every_country = {
			limit = {
				religion = fangaulan_pantheon
			}
			fangaulan_pantheon_remove_all_religious_power_mod = yes
			add_country_modifier = {
				name = fangaulan_pantheon_religious_power_mod_5
				duration = -1
			}
		}
	}
	else_if = {
		limit = {
			5811 = {
				is_variable_equal  = {
					which = FangaulanPantheonHolySiteCount
					value = 4
				}
			}
		}
		every_country = {
			limit = {
				religion = fangaulan_pantheon
			}
			fangaulan_pantheon_remove_all_religious_power_mod = yes
			add_country_modifier = {
				name = fangaulan_pantheon_religious_power_mod_4
				duration = -1
			}
		}
	}
	else_if = {
		limit = {
			5811 = {
				is_variable_equal  = {
					which = FangaulanPantheonHolySiteCount
					value = 3
				}
			}
		}
		every_country = {
			limit = {
				religion = fangaulan_pantheon
			}
			fangaulan_pantheon_remove_all_religious_power_mod = yes
			add_country_modifier = {
				name = fangaulan_pantheon_religious_power_mod_3
				duration = -1
			}
		}
	}
	else_if = {
		limit = {
			5811 = {
				is_variable_equal  = {
					which = FangaulanPantheonHolySiteCount
					value = 2
				}
			}
		}
		every_country = {
			limit = {
				religion = fangaulan_pantheon
			}
			fangaulan_pantheon_remove_all_religious_power_mod = yes
			add_country_modifier = {
				name = fangaulan_pantheon_religious_power_mod_2
				duration = -1
			}
		}
	}
	else_if = {
		limit = {
			5811 = {
				is_variable_equal  = {
					which = FangaulanPantheonHolySiteCount
					value = 1
				}
			}
		}
		every_country = {
			limit = {
				religion = fangaulan_pantheon
			}
			fangaulan_pantheon_remove_all_religious_power_mod = yes
			add_country_modifier = {
				name = fangaulan_pantheon_religious_power_mod_1
				duration = -1
			}
		}
	}
	else = {
		every_country = {
			limit = {
				religion = fangaulan_pantheon
			}
			fangaulan_pantheon_remove_all_religious_power_mod = yes
		}
	}
}

fangaulan_pantheon_apply_holy_site_bonus = { #Country
	fangaulan_pantheon_remove_all_religious_power_mod = yes
	if = {
		limit = {
			5811 = {
				is_variable_equal  = {
					which = FangaulanPantheonHolySiteCount
					value = 8
				}
			}
		}
		add_country_modifier = {
			name = fangaulan_pantheon_religious_power_mod_8
			duration = -1
		}
	}
	else_if = {
		limit = {
			5811 = {
				is_variable_equal  = {
					which = FangaulanPantheonHolySiteCount
					value = 7
				}
			}
		}
		add_country_modifier = {
			name = fangaulan_pantheon_religious_power_mod_7
			duration = -1
		}
	}
	else_if = {
		limit = {
			5811 = {
				is_variable_equal  = {
					which = FangaulanPantheonHolySiteCount
					value = 6
				}
			}
		}
		add_country_modifier = {
			name = fangaulan_pantheon_religious_power_mod_6
			duration = -1
		}
	}
	else_if = {
		limit = {
			5811 = {
				is_variable_equal  = {
					which = FangaulanPantheonHolySiteCount
					value = 5
				}
			}
		}
		add_country_modifier = {
			name = fangaulan_pantheon_religious_power_mod_5
			duration = -1
		}
	}
	else_if = {
		limit = {
			5811 = {
				is_variable_equal  = {
					which = FangaulanPantheonHolySiteCount
					value = 4
				}
			}
		}
		add_country_modifier = {
			name = fangaulan_pantheon_religious_power_mod_4
			duration = -1
		}
	}
	else_if = {
		limit = {
			5811 = {
				is_variable_equal  = {
					which = FangaulanPantheonHolySiteCount
					value = 3
				}
			}
		}
		add_country_modifier = {
			name = fangaulan_pantheon_religious_power_mod_3
			duration = -1
		}
	}
	else_if = {
		limit = {
			5811 = {
				is_variable_equal  = {
					which = FangaulanPantheonHolySiteCount
					value = 2
				}
			}
		}
		add_country_modifier = {
			name = fangaulan_pantheon_religious_power_mod_2
			duration = -1
		}
	}
	else_if = {
		limit = {
			5811 = {
				is_variable_equal  = {
					which = FangaulanPantheonHolySiteCount
					value = 1
				}
			}
		}
		add_country_modifier = {
			name = fangaulan_pantheon_religious_power_mod_1
			duration = -1
		}
	}
}

fangaulan_pantheon_remove_all_religious_power_mod = {
	remove_country_modifier = fangaulan_pantheon_religious_power_mod_8
	remove_country_modifier = fangaulan_pantheon_religious_power_mod_7
	remove_country_modifier = fangaulan_pantheon_religious_power_mod_6
	remove_country_modifier = fangaulan_pantheon_religious_power_mod_5
	remove_country_modifier = fangaulan_pantheon_religious_power_mod_4
	remove_country_modifier = fangaulan_pantheon_religious_power_mod_3
	remove_country_modifier = fangaulan_pantheon_religious_power_mod_2
	remove_country_modifier = fangaulan_pantheon_religious_power_mod_1
}

fangaulan_pantheon_apply_celebration_debuff = {
	custom_tooltip = fangaulan_pantheon_cant_reselect_tale_tt
	custom_tooltip = " " #Linebreak
	add_country_modifier = {
		name = fangaulan_pantheon_celebration_debuff
		duration = 1825 #5 years
	}
}

shifter_lodge_bonus_increase = {
	if = {
		limit = {
			has_estate_privilege = estate_nobility_patrons_of_the_lodges
		}
		if = {
			limit = { 
				has_country_modifier = hidden_shifter_amount_of_lodges_modifer_lv1
			}
			remove_country_modifier = hidden_shifter_amount_of_lodges_modifer_lv1
				add_country_modifier = {
					name = hidden_shifter_amount_of_lodges_modifer_lv2
					duration = -1
					hidden = yes
			}
		}
		else_if = {
			limit = { 
				has_country_modifier = hidden_shifter_amount_of_lodges_modifer_lv2
			}
			remove_country_modifier = hidden_shifter_amount_of_lodges_modifer_lv2
			add_country_modifier = {
				name = hidden_shifter_amount_of_lodges_modifer_lv3
				duration = -1
				hidden = yes
			}
		}
		else_if = {
			limit = { 
				has_country_modifier = hidden_shifter_amount_of_lodges_modifer_lv3
			}
			remove_country_modifier = hidden_shifter_amount_of_lodges_modifer_lv3
			add_country_modifier = {
				name = hidden_shifter_amount_of_lodges_modifer_lv4
				duration = -1
				hidden = yes
			}
		}
		else_if = {
			limit = { 
				has_country_modifier = hidden_shifter_amount_of_lodges_modifer_lv4
			}
			remove_country_modifier = hidden_shifter_amount_of_lodges_modifer_lv4
			add_country_modifier = {
				name = hidden_shifter_amount_of_lodges_modifer_lv5
				duration = -1
				hidden = yes
			}
		}
		else_if = {
			limit = { 
				has_country_modifier = hidden_shifter_amount_of_lodges_modifer_lv5
			}
			remove_country_modifier = hidden_shifter_amount_of_lodges_modifer_lv5
			add_country_modifier = {
				name = hidden_shifter_amount_of_lodges_modifer_lv6
				duration = -1
				hidden = yes
			}
		}
		else_if = { 
			limit = { 
				has_country_modifier = hidden_shifter_amount_of_lodges_modifer_lv6
			}
			if = {
				limit = {
					primary_culture = tanizu
				}
				add_country_modifier = {
					name = hidden_shifter_amount_of_lodges_modifer_lv7_tanizu
					duration = -1
					hidden = yes
				}
			}
			else_if = {
				limit = {
					primary_culture = antmvura
				}
				add_country_modifier = {
					name = hidden_shifter_amount_of_lodges_modifer_lv7_antmvura
					duration = -1
					hidden = yes
				}
			}
			else_if = {
				limit = {
					primary_culture = kombedak
				}
				add_country_modifier = {
					name = hidden_shifter_amount_of_lodges_modifer_lv7_kombedak
					duration = -1
					hidden = yes
				}
			}
			else_if = {
				limit = {
					primary_culture = cyazizeta_lizardfolk
				}
				add_country_modifier = {
					name = hidden_shifter_amount_of_lodges_modifer_lv7_cyazizeta_lizardfolk
					duration = -1
					hidden = yes
				}
			}
			else_if = {
				limit = {
					primary_culture = wakoodak	
				}
				add_country_modifier = {
					name = hidden_shifter_amount_of_lodges_modifer_lv7_wakoodak
					duration = -1
					hidden = yes
				}
			}
			else_if = {
				limit = {
					primary_culture = umsozidak
				}
				add_country_modifier = {
					name = hidden_shifter_amount_of_lodges_modifer_lv7_umsozidak
					duration = -1
					hidden = yes
				}
			}
			remove_country_modifier = hidden_shifter_amount_of_lodges_modifer_lv6
		}
		else_if = {
			limit = { 
				NOT = {
					OR = {
						has_country_modifier = hidden_shifter_amount_of_lodges_modifer_lv7_tanizu
						has_country_modifier = hidden_shifter_amount_of_lodges_modifer_lv7_wakoodak
						has_country_modifier = hidden_shifter_amount_of_lodges_modifer_lv7_antmvura
						has_country_modifier = hidden_shifter_amount_of_lodges_modifer_lv7_kombedak
						has_country_modifier = hidden_shifter_amount_of_lodges_modifer_lv7_cyazizeta_lizardfolk
						has_country_modifier = hidden_shifter_amount_of_lodges_modifer_lv7_umsozidak
					}
				}
			}
			add_country_modifier = {
				name = hidden_shifter_amount_of_lodges_modifer_lv1
				duration = -1
				hidden = yes
			}
		} 
	}
}

shifter_lodge_bonus_decrease = {
	if = {
		limit = {
			has_estate_privilege = estate_nobility_patrons_of_the_lodges
		}

		if = {
			limit = { 
				has_country_modifier = hidden_shifter_amount_of_lodges_modifer_lv1
			}
			remove_country_modifier = hidden_shifter_amount_of_lodges_modifer_lv1
		}
		else_if = {
			limit = { 
				has_country_modifier = hidden_shifter_amount_of_lodges_modifer_lv2
			}
			remove_country_modifier = hidden_shifter_amount_of_lodges_modifer_lv2
			add_country_modifier = {
				name = hidden_shifter_amount_of_lodges_modifer_lv1
				duration = -1
				hidden = yes
			}
		}
		else_if = {
			limit = { 
				has_country_modifier = hidden_shifter_amount_of_lodges_modifer_lv3
			}
			remove_country_modifier = hidden_shifter_amount_of_lodges_modifer_lv3
			add_country_modifier = {
				name = hidden_shifter_amount_of_lodges_modifer_lv2
				duration = -1
				hidden = yes
			}
		}
		else_if = {
			limit = { 
				has_country_modifier = hidden_shifter_amount_of_lodges_modifer_lv4
			}
			remove_country_modifier = hidden_shifter_amount_of_lodges_modifer_lv4
			add_country_modifier = {
				name = hidden_shifter_amount_of_lodges_modifer_lv3
				duration = -1
				hidden = yes
			}
		}
		else_if = {
			limit = { 
				has_country_modifier = hidden_shifter_amount_of_lodges_modifer_lv5
			}
			remove_country_modifier = hidden_shifter_amount_of_lodges_modifer_lv5
			add_country_modifier = {
				name = hidden_shifter_amount_of_lodges_modifer_lv4
				duration = -1
				hidden = yes
			}
		}
		else_if = { 
			limit = { 
				has_country_modifier = hidden_shifter_amount_of_lodges_modifer_lv6
			}
			remove_country_modifier = hidden_shifter_amount_of_lodges_modifer_lv6
			add_country_modifier = {
				name = hidden_shifter_amount_of_lodges_modifer_lv5
				duration = -1
				hidden = yes
			}
		}
		else_if = {
			limit = { 
				OR = {
					has_country_modifier = hidden_shifter_amount_of_lodges_modifer_lv7_tanizu
					has_country_modifier = hidden_shifter_amount_of_lodges_modifer_lv7_wakoodak
					has_country_modifier = hidden_shifter_amount_of_lodges_modifer_lv7_antmvura
					has_country_modifier = hidden_shifter_amount_of_lodges_modifer_lv7_kombedak
					has_country_modifier = hidden_shifter_amount_of_lodges_modifer_lv7_cyazizeta_lizardfolk
					has_country_modifier = hidden_shifter_amount_of_lodges_modifer_lv7_umsozidak
				}
			}
			remove_country_modifier = hidden_shifter_amount_of_lodges_modifer_lv7_tanizu
			remove_country_modifier = hidden_shifter_amount_of_lodges_modifer_lv7_wakoodak
			remove_country_modifier = hidden_shifter_amount_of_lodges_modifer_lv7_antmvura
			remove_country_modifier = hidden_shifter_amount_of_lodges_modifer_lv7_kombedak
			remove_country_modifier = hidden_shifter_amount_of_lodges_modifer_lv7_cyazizeta_lizardfolk
			remove_country_modifier = hidden_shifter_amount_of_lodges_modifer_lv7_umsozidak
			add_country_modifier = {
				name = hidden_shifter_amount_of_lodges_modifer_lv6
				duration = -1
				hidden = yes
			}
		}
	}
}

remove_zaradyrra_festival_buff = {
	remove_country_modifier = zaradyrra_embroidery_mistake
	remove_country_modifier = zaradyrra_embroidery_onslaught
	remove_country_modifier = zaradyrra_embroidery_bard
	remove_country_modifier = zaradyrra_embroidery_rising
	remove_country_modifier = zaradyrra_demonstration_mistake
	remove_country_modifier = zaradyrra_demonstration_onslaught
	remove_country_modifier = zaradyrra_demonstration_bard
	remove_country_modifier = zaradyrra_demonstration_rising
	remove_country_modifier = zaradyrra_dance_mistake
	remove_country_modifier = zaradyrra_dance_onslaught
	remove_country_modifier = zaradyrra_dance_bard
	remove_country_modifier = zaradyrra_dance_rising
	remove_country_modifier = zaradyrra_mandala_mistake
	remove_country_modifier = zaradyrra_mandala_bard
	remove_country_modifier = zaradyrra_mandala_rising
	remove_country_modifier = zaradyrra_ceremony_mistake
	remove_country_modifier = zaradyrra_ceremony_onslaught
	remove_country_modifier = zaradyrra_ceremony_bard
	remove_country_modifier = zaradyrra_ceremony_rising
	remove_country_modifier = zaradyrra_tools_mistake
	remove_country_modifier = zaradyrra_tools_onslaught
	remove_country_modifier = zaradyrra_tools_bard
	remove_country_modifier = zaradyrra_tools_rising
	remove_country_modifier = zaradyrra_instruments_mistake
	remove_country_modifier = zaradyrra_instruments_onslaught
	remove_country_modifier = zaradyrra_instruments_bard
	remove_country_modifier = zaradyrra_instruments_rising
	remove_country_modifier = zaradyrra_smithing_mistake
	remove_country_modifier = zaradyrra_smithing_onslaught
	remove_country_modifier = zaradyrra_smithing_bard
	remove_country_modifier = zaradyrra_smithing_rising
}

# This way you only need to worry about giving a value to 1 input parameter, either claw_strength or canvas_strength
ashhana_blood_curse_add_control_by_source = {
[[claw_strength]
	add_government_power = {
		mechanic_type = ashhana_blood_curse_mechanic
		power_type = ashhana_blood_curse_control
		value = $claw_strength$
	}
	ashhana_blood_curse_add_faction_strength = {
		claw_strength = $claw_strength$
	}
	]
[[canvas_strength]
	add_government_power = {
		mechanic_type = ashhana_blood_curse_mechanic
		power_type = ashhana_blood_curse_control
		value = $canvas_strength$
	}
	ashhana_blood_curse_add_faction_strength = {
		canvas_strength = $canvas_strength$
	}
	]
}

# This is a separate effect so we can use canvas_minus_claw to track the difference for the custom GUI
ashhana_blood_curse_add_faction_strength = {
[[claw_strength]
	change_variable = {
		which = claw_strength
		value = $claw_strength$
	}
	hidden_effect = {
		subtract_variable = {
			which = canvas_minus_claw
			value = $claw_strength$
		}
	}
	]
[[canvas_strength]
	change_variable = {
		which = canvas_strength
		value = $canvas_strength$
	}
	hidden_effect = {
		change_variable = {
			which = canvas_minus_claw
			value = $canvas_strength$
		}
	}
	]
}

ashhana_blood_curse_control_from_performance = {
	if = {
		limit = {
			has_government_attribute = festivals_of_blood_ability
		}
		ashhana_blood_curse_add_control_by_source = {
			claw_strength = 3.75
		}
	}
	else = {
		ashhana_blood_curse_add_control_by_source = {
			canvas_strength = 3.75
		}
	}
}
ashhana_blood_curse_monthly_control = {
	#Gain Canvas Strength and Control per month for each advisor employed
	#Thouh the Control is handled by the ashhana_control_<X>_advisor modifiers
	if = {
		limit = {
			employed_advisor = {
				category = ADM
			}
		}
		ashhana_blood_curse_add_faction_strength = {
			canvas_strength = 0.04
		}
	}
	if = {
		limit = {
			employed_advisor = {
				category = DIP
			}
		}
		ashhana_blood_curse_add_faction_strength = {
			canvas_strength = 0.04
		}
	}
	if = {
		limit = {
			employed_advisor = {
				category = MIL
			}
		}
		ashhana_blood_curse_add_faction_strength = {
			canvas_strength = 0.04
		}
	}
	if = { #Give the AI some help
		limit = {
			ai = yes
		}
		ashhana_blood_curse_add_control_by_source = {
			canvas_strength = 0.075
		}
	}
}
#Trigger other events at 15, 30, 45, 60, 75, and 90 Control. This will check monthly
#I use ashhana_control_threshold_hit to make sure we only trigger one of these per month, since
#we can't use else_if inside a scripted effect
ashhana_blood_curse_control_check_thresholds = {
	if = {
		limit = {
			has_government_power = {
				mechanic_type = ashhana_blood_curse_mechanic
				power_type = ashhana_blood_curse_control
				value = 15
			}
			#This event should only happen once per Ashhana nation
			NOT = {
				has_country_flag = ashhana_control_15
			}
		}
		set_country_flag = ashhana_control_15
		set_country_flag = ashhana_control_threshold_hit
		country_event = { id = zaradyrra.101 }
	}
	if = {
		limit = {
			has_government_power = {
				mechanic_type = ashhana_blood_curse_mechanic
				power_type = ashhana_blood_curse_control
				value = 30
			}
			#This event should only happen once per Ashhana nation
			NOT = {
				has_country_flag = ashhana_control_30
			}
			NOT = {
				has_country_flag = ashhana_control_threshold_hit
			}
		}
		set_country_flag = ashhana_control_30
		set_country_flag = ashhana_control_threshold_hit
		country_event = { id = zaradyrra.102 }
	}
	if = {
		limit = {
			has_government_power = {
				mechanic_type = ashhana_blood_curse_mechanic
				power_type = ashhana_blood_curse_control
				value = 45
			}
			#This event should only happen once per Ashhana nation
			NOT = {
				has_country_flag = ashhana_control_45
			}
			NOT = {
				has_country_flag = ashhana_control_threshold_hit
			}
		}
		set_country_flag = ashhana_control_45
		set_country_flag = ashhana_control_threshold_hit
		country_event = { id = zaradyrra.103 }
	}
	if = {
		limit = {
			has_government_power = {
				mechanic_type = ashhana_blood_curse_mechanic
				power_type = ashhana_blood_curse_control
				value = 60
			}
			#This event should only happen once per Ashhana nation
			NOT = {
				has_country_flag = ashhana_control_60
			}
			NOT = {
				has_country_flag = ashhana_control_threshold_hit
			}
		}
		set_country_flag = ashhana_control_60
		set_country_flag = ashhana_control_threshold_hit
		country_event = { id = zaradyrra.104 }
	}
	if = {
		limit = {
			has_government_power = {
				mechanic_type = ashhana_blood_curse_mechanic
				power_type = ashhana_blood_curse_control
				value = 75
			}
			#This event should only happen once per Ashhana nation
			NOT = {
				has_country_flag = ashhana_control_75
			}
			NOT = {
				has_country_flag = ashhana_control_threshold_hit
			}
		}
		set_country_flag = ashhana_control_75
		set_country_flag = ashhana_control_threshold_hit
		country_event = { id = zaradyrra.105 }
	}
	if = {
		limit = {
			has_government_power = {
				mechanic_type = ashhana_blood_curse_mechanic
				power_type = ashhana_blood_curse_control
				value = 90
			}
			#This event should only happen once per Ashhana nation
			NOT = {
				has_country_flag = ashhana_control_90
			}
			NOT = {
				has_country_flag = ashhana_control_threshold_hit
			}
		}
		set_country_flag = ashhana_control_90
		set_country_flag = ashhana_control_threshold_hit
		country_event = { id = zaradyrra.106 }
	}
	clr_country_flag = ashhana_control_threshold_hit
}

ashhana_agony_of_expression_disaster_revolt_spawn = {
	# This will need to be differnent depending on which side you support
	set_variable = {
		which = ashhana_revolt_target_dev
		which = $revolt_side$_strength
	}
	
	#total strength is claw + canvas
	set_variable = {
		which = ashhana_revolt_strength_denominator
		which = claw_strength
	}
	change_variable = {
		which = ashhana_revolt_strength_denominator
		which = canvas_strength
	}
	
	#to scale dev, divide the non-supported strength by the total, multiply by 0.8 and add 0.1
	#to end up with a number between 0.1 (for 0% support) and 0.9 (for 100% support)
	divide_variable = {
		which = ashhana_revolt_target_dev
		which = ashhana_revolt_strength_denominator
	}

	multiply_variable = {
		which = ashhana_revolt_target_dev
		value = 0.8
	}
	
	change_variable = {
		which = ashhana_revolt_target_dev
		value = 0.1
	}

	#Now multiply this scaling factor by the actual total dev
	export_to_variable = {
		which = ashhana_root_total_development
		value = trigger_value:total_own_and_non_tributary_subject_development
	}

	multiply_variable = {
		which = ashhana_revolt_target_dev
		which = ashhana_root_total_development
	}

	#Since we will probably overshoot the target dev by a little bit, let's mitigate that by subtracting a small factor from the target
	#This is fairly early game so I think 5 is fine
	subtract_variable = {
		which = ashhana_revolt_target_dev
		value = 5
	}

	set_variable = {
		which = loop_province_dev
		value = 0
	}

	#Here we will handle 1 edge case: if your capital is on an isolated island, choose any random
	#province
	random_owned_province = {
		limit = {
			is_capital = no #don't cede the capital
			OR = {
				is_in_capital_area = yes #connected to the capital by land to avoid choosing islands
				ROOT = {
					capital_scope = {
						is_island = yes
					}
				}
			}
		}
		add_core = $tag$

		#the variable needs to be in my country scope, hence ROOT
		ROOT = {
			export_to_variable  = {
				which = loop_province_dev
				value = trigger_value:development
				#PREV refers to the random province scope we were just in
				who = PREV
			}
			subtract_variable = {
				which = ashhana_revolt_target_dev
				which = loop_province_dev #reduce our target by the random province dev until we get as close to 0 as possible
			}
		}
	}

	while = {
		limit = {
			#break the loop if we can't find any provinces to cede. Otherwise, pick a random province next
			#to a core of the revolt to give to them, so their lands stay connected
			any_owned_province = {
				NOT = {
					is_core = $tag$
				}
				any_neighbor_province = {
					is_core = $tag$
				}
				is_capital = no #don't cede the capital
			}
			# This is getting reduced each time by the ceded province's dev so we stop when it's 0 or negative
			check_variable = {
				which = ashhana_revolt_target_dev
				value = 0
			}
		}
		#We'll keep it simple and just pick a province, adjust our target, and assume we'll be close enough when the loop breaks
		random_owned_province = {
			limit = {
				NOT = {
					is_core = $tag$
				}
				any_neighbor_province = {
					is_core = $tag$
				}
				is_capital = no #don't cede the capital
			}
			add_core = $tag$

			#the variable needs to be in my country scope, hence ROOT
			ROOT = {
				export_to_variable  = {
					which = loop_province_dev
					value = trigger_value:development
					#PREV refers to the random province scope we were just in
					who = PREV
				}
				subtract_variable = {
					which = ashhana_revolt_target_dev
					which = loop_province_dev #reduce our target by the random province dev until we get as close to 0 as possible
				}
			}
		}
	}
	release = $tag$

	$tag$ = {
		country_event = { id = anbennar_setup.3 }
		# Only one of these reforms will be valid so this should work
		if = {
			limit = {
				government = monarchy
			}
			add_government_reform = ashhana_throne_of_blood
		}
		if = {
			limit = {
				government = theocracy
			}
			add_government_reform = ashhana_realm_of_art
		}
		set_estate_privilege = estate_mages_organization_state
		add_yearly_manpower = 10 #give them a full pool of manpower
		add_years_of_income = 10 #and a decent amount of cash
		add_adm_power = 300
		add_dip_power = 300
		add_mil_power = 300
		add_army_tradition = 50
		add_country_modifier = { # Give them a +10 FL buff and some inf cost discount to help compete with the Ashhana Tribe reform
			name = ashhana_revolt_buff
			duration = -1
		}
		
		capital_scope = {
			build_to_forcelimit = {
				infantry = 0.9
				cavalry = 0.1
			}
		}
		declare_war_with_cb = {
			casus_belli = cb_ashhana_freedom_of_expression
			who = ROOT
		}
	}
}
form_jadd_empire_effect = {
	change_tag = F51
	hidden_effect = { restore_country_name = yes }
	set_government_rank_scripted_effect = { rank = 3 }
	add_prestige = 50
	if = {
		limit = { has_custom_ideas = no }
		country_event = { id = ideagroups.1 } #Swap Ideas
	}
	add_country_modifier = {
		name = "centralization_modifier"
		duration = 7300
	}
	hidden_effect = {
		every_owned_province = {
			limit = {
				is_part_of_hre = yes
			}
			set_in_empire = no
		}
		set_country_flag = formed_jadd_empire_flag
	}
}
bulwar_sarhal_monastery_add_hidden_mod = {
	hidden_effect = {
		[[1]
			$scope$ = {
				add_province_modifier = {
					name = bulwar_general_monastery_system_hidden_1_region
					duration = -1
					hidden = yes
				}
				set_province_flag = bulwar_general_monastery_system_hidden_1_region
			}
		]
		[[2]
			$scope$ = {
				add_province_modifier = {
					name = bulwar_general_monastery_system_hidden_2_region
					duration = -1
					hidden = yes
				}
				set_province_flag = bulwar_general_monastery_system_hidden_2_region
			}
		]
		[[3]
			$scope$ = {
				if = {
					limit = { has_port = yes }
					add_province_modifier = {
						name = bulwar_general_monastery_system_hidden_3_region_coast
						duration = -1
						hidden = yes
					}
				}
				else = {
					add_province_modifier = {
						name = bulwar_general_monastery_system_hidden_3_region_land
						duration = -1
						hidden = yes
					}
				}
				set_province_flag = bulwar_general_monastery_system_hidden_3_region
			}
		]
	}
}
bulwar_sarhal_monastery_remove_hidden_mod = {
	hidden_effect = {
		[[1]
			$scope$ = {
				remove_province_modifier = bulwar_general_monastery_system_hidden_1_region
				clr_province_flag = bulwar_general_monastery_system_hidden_1_region
			}
		]
		[[2]
			$scope$ = {
				remove_province_modifier = bulwar_general_monastery_system_hidden_2_region
				clr_province_flag = bulwar_general_monastery_system_hidden_2_region
			}
		]
		[[3]
			$scope$ = {
				clr_province_flag = bulwar_general_monastery_system_hidden_3_region
				if = {
					limit = { has_port = yes }
					remove_province_modifier = bulwar_general_monastery_system_hidden_3_region_coast
				}
				else = {
					remove_province_modifier = bulwar_general_monastery_system_hidden_3_region_land
				}
			}
		]
	}
}
bulwar_sarhal_temple_monastery_owner_change = {
	#Temples
	if = {
		limit = { has_province_flag = bulwar_general_temple_system_region_flag }
		add_province_modifier = {
			name = bulwar_general_temple_system_region
			duration = -1
			hidden = yes
		}
	}
	#Monasteries
	if = {
		limit = { has_province_flag = bulwar_general_monastery_system_hidden_1_region }
		add_province_modifier = {
			name = bulwar_general_monastery_system_hidden_1_region
			duration = -1
			hidden = yes
		}
	}
	else_if = {
		limit = { has_province_flag = bulwar_general_monastery_system_hidden_2_region }
		add_province_modifier = {
			name = bulwar_general_monastery_system_hidden_2_region
			duration = -1
			hidden = yes
		}
	}
	else_if = {
		limit = { has_province_flag = bulwar_general_monastery_system_hidden_3_region }
		if = {
			limit = { has_port = yes }
			add_province_modifier = {
				name = bulwar_general_monastery_system_hidden_3_region_coast
				duration = -1
				hidden = yes
			}
		}
		else = {
			add_province_modifier = {
				name = bulwar_general_monastery_system_hidden_3_region_land
				duration = -1
				hidden = yes
			}
		}
	}
}
bulwar_sarhal_monastery_clear = { #There is option to give away it to vassal before changing religion to keep modifier
	if = {
		limit = { 5505 = { has_province_modifier = bulwar_sarhal_temple_system_dakmender } }
		5505 = {
			remove_province_modifier = bulwar_sarhal_temple_system_dakmender
		}
		telekenid_region = {
			remove_province_modifier = bulwar_general_temple_system_region
			clr_province_flag = bulwar_general_temple_system_region_flag
		}
	}
	if = {
		limit = { 5585 = { has_province_modifier = bulwar_sarhal_temple_system_kuvunika } }
		5585 = {
			remove_province_modifier = bulwar_sarhal_temple_system_kuvunika
		}
		bamaliwuni_region = {
			remove_province_modifier = bulwar_general_temple_system_region
			clr_province_flag = bulwar_general_temple_system_region_flag
		}
	}
	if = {
		limit = { 5650 = { has_province_modifier = bulwar_sarhal_temple_system_shalazar } }
		5650 = {
			remove_province_modifier = bulwar_sarhal_temple_system_shalazar
		}
		odu_kherass_region = {
			remove_province_modifier = bulwar_general_temple_system_region
			clr_province_flag = bulwar_general_temple_system_region_flag
		}
	}
	if = {
		limit = { 483 = { has_province_modifier = bulwar_sarhal_temple_system_deshwimat } }
		483 = {
			remove_province_modifier = bulwar_sarhal_temple_system_deshwimat
		}
		gol_region = {
			remove_province_modifier = bulwar_general_temple_system_region
			clr_province_flag = bulwar_general_temple_system_region_flag
		}
	}
	if = {
		limit = { 5481 = { has_province_modifier = bulwar_sarhal_temple_system_niramit } }
		5481 = {
			remove_province_modifier = bulwar_sarhal_temple_system_niramit
		}
		khetapera_region = {
			remove_province_modifier = bulwar_general_temple_system_region
			clr_province_flag = bulwar_general_temple_system_region_flag
		}
	}
	if = {
		limit = { 5710 = { has_province_modifier = bulwar_sarhal_temple_system_kunolo } }
		5710 = {
			remove_province_modifier = bulwar_sarhal_temple_system_kunolo
		}
		dao_nako_region = {
			remove_province_modifier = bulwar_general_temple_system_region
			clr_province_flag = bulwar_general_temple_system_region_flag
		}
	}
	if = {
		limit = { 400 = { has_province_modifier = bulwar_sarhal_temple_system_khasa } }
		400 = {
			remove_province_modifier = bulwar_sarhal_temple_system_khasa
		}
		akasik_region = {
			remove_province_modifier = bulwar_general_temple_system_region
			clr_province_flag = bulwar_general_temple_system_region_flag
		}
	}
	if = {
		limit = { 475 = { has_province_modifier = bulwar_sarhal_temple_system_kheterat } }
		475 = {
			remove_province_modifier = bulwar_sarhal_temple_system_kheterat
		}
		kheterata_region = {
			remove_province_modifier = bulwar_general_temple_system_region
			clr_province_flag = bulwar_general_temple_system_region_flag
		}
	}
	if = {
		limit = { 5529 = { has_province_modifier = bulwar_sarhal_temple_system_yetmesira } }
		5529 = {
			remove_province_modifier = bulwar_sarhal_temple_system_yetmesira
		}
		yetefesefi_region = {
			remove_province_modifier = bulwar_general_temple_system_region
			clr_province_flag = bulwar_general_temple_system_region_flag
		}
	}
	if = {
		limit = { 5590 = { has_province_modifier = bulwar_sarhal_temple_system_mewojala } }
		5590 = {
			remove_province_modifier = bulwar_sarhal_temple_system_mewojala
		}
		denibari_region = {
			remove_province_modifier = bulwar_general_temple_system_region
			clr_province_flag = bulwar_general_temple_system_region_flag
		}
	}
	if = {
		limit = { 5813 = { has_province_modifier = bulwar_sarhal_temple_system_sigilan } }
		5813 = {
			remove_province_modifier = bulwar_sarhal_temple_system_sigilan
		}
		janama_region = {
			remove_province_modifier = bulwar_general_temple_system_region
			clr_province_flag = bulwar_general_temple_system_region_flag
		}
	}
	if = {
		limit = { 5434 = { has_province_modifier = bulwar_sarhal_temple_system_coburakaz } }
		5434 = {
			remove_province_modifier = bulwar_sarhal_temple_system_coburakaz
		}
		far_salahad_region = {
			remove_province_modifier = bulwar_general_temple_system_region
			clr_province_flag = bulwar_general_temple_system_region_flag
		}
	}
	if = {
		limit = { 5631 = { has_province_modifier = bulwar_sarhal_temple_system_cyamutaka } }
		5631 = {
			remove_province_modifier = bulwar_sarhal_temple_system_cyamutaka
		}
		ishyamtumu_region = {
			remove_province_modifier = bulwar_general_temple_system_region
			clr_province_flag = bulwar_general_temple_system_region_flag
		}
	}
	if = {
		limit = { 5728 = { has_province_modifier = bulwar_sarhal_temple_system_fojara } }
		5728 = {
			remove_province_modifier = bulwar_sarhal_temple_system_fojara
		}
		kubaci_region = {
			remove_province_modifier = bulwar_general_temple_system_region
			clr_province_flag = bulwar_general_temple_system_region_flag
		}
	}
	if = {
		limit = { 5442 = { has_province_modifier = bulwar_sarhal_temple_system_kvangraak } }
		5442 = {
			remove_province_modifier = bulwar_sarhal_temple_system_kvangraak
		}
		gazraak_region = {
			remove_province_modifier = bulwar_general_temple_system_region
			clr_province_flag = bulwar_general_temple_system_region_flag
		}
	}
	if = {
		limit = { has_global_flag = bulwar_monastery_exist.330 }
		clr_global_flag = bulwar_monastery_exist.330
		if = {
			limit = { 6659 = { has_province_modifier = bulwar_sarhal_monastery_system_3_area_jezarpizu } }
			bedaphire_area = {
				remove_province_modifier = bulwar_sarhal_monastery_system_3_area_jezarpizu
			}
			bulwar_sarhal_monastery_remove_hidden_mod = { scope = telekenid_region 3 = yes}
		}
		else = {
			bedaphire_area = {
				remove_province_modifier = bulwar_sarhal_monastery_system_2_area_jezarpizu
			}
			bulwar_sarhal_monastery_remove_hidden_mod = { scope = telekenid_region 2 = yes}
		}
	}
	if = {
		limit = { has_global_flag = bulwar_monastery_exist.331 }
		clr_global_flag = bulwar_monastery_exist.331
		if = {
			limit = { 5671 = { has_province_modifier = bulwar_sarhal_monastery_system_2_area_gyumneba } }
			umsozandin_area = {
				remove_province_modifier = bulwar_sarhal_monastery_system_2_area_gyumneba
			}
			bulwar_sarhal_monastery_remove_hidden_mod = { scope = bamaliwuni_region 2 = yes}
		}
		else = {
			umsozandin_area = {
				remove_province_modifier = bulwar_sarhal_monastery_system_3_area_gyumneba
			}
			bulwar_sarhal_monastery_remove_hidden_mod = { scope = bamaliwuni_region 3 = yes}
		}
	}
	if = {
		limit = { has_global_flag = bulwar_monastery_exist.332 }
		clr_global_flag = bulwar_monastery_exist.332
		sut_ra_thon_area = {
			remove_province_modifier = bulwar_sarhal_monastery_system_2_area_gylgyra
		}
		bulwar_sarhal_monastery_remove_hidden_mod = { scope = odu_kherass_region 2 = yes}
	}
	if = {
		limit = { has_global_flag = bulwar_monastery_exist.333 }
		clr_global_flag = bulwar_monastery_exist.333
		if = {
			limit = { 5466 = { has_province_modifier = bulwar_sarhal_monastery_system_3_area_mazu_makhara } }
			siniwix_area = {
				remove_province_modifier = bulwar_sarhal_monastery_system_3_area_mazu_makhara
			}
			bulwar_sarhal_monastery_remove_hidden_mod = { scope = gol_region 3 = yes}
		}
		else = {
			siniwix_area = {
				remove_province_modifier = bulwar_sarhal_monastery_system_1_area_mazu_makhara
			}
			bulwar_sarhal_monastery_remove_hidden_mod = { scope = gol_region 1 = yes}
		}
	}
	if = {
		limit = { has_global_flag = bulwar_monastery_exist.334 }
		clr_global_flag = bulwar_monastery_exist.334
		if = {
			limit = { 6125 = { has_province_modifier = bulwar_sarhal_monastery_system_1_area_zerkis } }
			zerkis_area = {
				remove_province_modifier = bulwar_sarhal_monastery_system_1_area_zerkis
			}
			bulwar_sarhal_monastery_remove_hidden_mod = { scope = khetapera_region 3 = yes}
		}
		else = {
			zerkis_area = {
				remove_province_modifier = bulwar_sarhal_monastery_system_2_area_zerkis
			}
			bulwar_sarhal_monastery_remove_hidden_mod = { scope = khetapera_region 2 = yes}
		}
	}
	if = {
		limit = { has_global_flag = bulwar_monastery_exist.335 }
		clr_global_flag = bulwar_monastery_exist.335
		if = {
			limit = { 5808 = { has_province_modifier = bulwar_sarhal_monastery_system_2_area_junansuar } }
			mojobaa_kulan_area = {
				remove_province_modifier = bulwar_sarhal_monastery_system_2_area_junansuar
			}
			bulwar_sarhal_monastery_remove_hidden_mod = { scope = dao_nako_region 2 = yes}
		}
		else = {
			mojobaa_kulan_area = {
				remove_province_modifier = bulwar_sarhal_monastery_system_3_area_junansuar
			}
			bulwar_sarhal_monastery_remove_hidden_mod = { scope = dao_nako_region 3 = yes}
		}
	}
	if = {
		limit = { has_global_flag = bulwar_monastery_exist.336 }
		clr_global_flag = bulwar_monastery_exist.336
		if = {
			limit = { 407 = { has_province_modifier = bulwar_sarhal_monastery_system_3_area_bhetu } }
			ekha_area = {
				remove_province_modifier = bulwar_sarhal_monastery_system_3_area_bhetu
			}
			bulwar_sarhal_monastery_remove_hidden_mod = { scope = akasik_region 3 = yes}
		}
		else = {
			ekha_area = {
				remove_province_modifier = bulwar_sarhal_monastery_system_2_area_bhetu
			}
			bulwar_sarhal_monastery_remove_hidden_mod = { scope = akasik_region 2 = yes}
		}
	}
	if = {
		limit = { has_global_flag = bulwar_monastery_exist.337 }
		clr_global_flag = bulwar_monastery_exist.337
		mothers_delta_area = {
			remove_province_modifier = bulwar_sarhal_monastery_system_1_area_anarat
		}
		bulwar_sarhal_monastery_remove_hidden_mod = { scope = kheterata_region 1 = yes}
	}
	if = {
		limit = { has_global_flag = bulwar_monastery_exist.338 }
		clr_global_flag = bulwar_monastery_exist.338
		if = {
			limit = { 5519 = { has_province_modifier = bulwar_sarhal_monastery_system_2_area_enikmesiki } }
			berfan_area = {
				remove_province_modifier = bulwar_sarhal_monastery_system_2_area_enikmesiki
			}
			bulwar_sarhal_monastery_remove_hidden_mod = { scope = yetefesefi_region 2 = yes}
		}
		else = {
			berfan_area = {
				remove_province_modifier = bulwar_sarhal_monastery_system_1_area_enikmesiki
			}
			bulwar_sarhal_monastery_remove_hidden_mod = { scope = yetefesefi_region 1 = yes}
		}
	}
	if = {
		limit = { has_global_flag = bulwar_monastery_exist.339 }
		clr_global_flag = bulwar_monastery_exist.339
		kidfan_area = {
			remove_province_modifier = bulwar_sarhal_monastery_system_3_area_yikikakeli
		}
		bulwar_sarhal_monastery_remove_hidden_mod = { scope = denibari_region 3 = yes}
	}
	if = {
		limit = { has_global_flag = bulwar_monastery_exist.340 }
		clr_global_flag = bulwar_monastery_exist.340
		if = {
			limit = { 5789 = { has_province_modifier = bulwar_sarhal_monastery_system_1_area_zirrbit } }
			xoruku_xugu_area = {
				remove_province_modifier = bulwar_sarhal_monastery_system_1_area_zirrbit
			}
			bulwar_sarhal_monastery_remove_hidden_mod = { scope = janama_region 1 = yes}
		}
		else = {
			xoruku_xugu_area = {
				remove_province_modifier = bulwar_sarhal_monastery_system_3_area_zirrbit
			}
			bulwar_sarhal_monastery_remove_hidden_mod = { scope = janama_region 3 = yes}
		}
	}
	if = {
		limit = { has_global_flag = bulwar_monastery_exist.341 }
		clr_global_flag = bulwar_monastery_exist.341
		aakeiritki_area = {
			remove_province_modifier = bulwar_sarhal_monastery_system_1_area_sprigi_twani
		}
		bulwar_sarhal_monastery_remove_hidden_mod = { scope = shadow_swamp_region 1 = yes}
	}
}

anb_sarhal_cultural_union = { #Might need an update if there's new cultures in the future
	[[mengi]
		custom_tooltip = anb_sarhal_cultural_union_mengi_tt
		hidden_effect = {
			anb_add_accepted_culture_or_dip_power = {
				culture = yeteferen
				free = yes
			}
			anb_add_accepted_culture_or_dip_power = {
				culture = metobesebi
				free = yes
			}
			anb_add_accepted_culture_or_dip_power = {
				culture = talilibeti
				free = yes
			}
			anb_add_accepted_culture_or_dip_power = {
				culture = ofehibi
				free = yes
			}
			anb_add_accepted_culture_or_dip_power = {
				culture = sitewosi
				free = yes
			}
		}
	]
	[[inyaswarosa]
		custom_tooltip = anb_sarhal_cultural_union_inyaswarosa_tt
		hidden_effect = {
			anb_add_accepted_culture_or_dip_power = {
				culture = tanizu
				free = yes
			}
			anb_add_accepted_culture_or_dip_power = {
				culture = kombedak
				free = yes
			}
			anb_add_accepted_culture_or_dip_power = {
				culture = antmvura
				free = yes
			}
			anb_add_accepted_culture_or_dip_power = {
				culture = umsozidak
				free = yes
			}
			anb_add_accepted_culture_or_dip_power = {
				culture = wakoodak
				free = yes
			}
		}
	]
	[[lizardfolk]
		custom_tooltip = anb_sarhal_cultural_union_lizardfolk_tt
		hidden_effect = {
			anb_add_accepted_culture_or_dip_power = {
				culture = cyazizeta_lizardfolk
				free = yes
			}
			anb_add_accepted_culture_or_dip_power = {
				culture = rhada_lizardfolk
				free = yes
			}
			anb_add_accepted_culture_or_dip_power = {
				culture = irikin_lizardfolk
				free = yes
			}
			anb_add_accepted_culture_or_dip_power = {
				culture = ahzdara_lizardfolk
				free = yes
			}
			anb_add_accepted_culture_or_dip_power = {
				culture = ashhana_lizardfolk
				free = yes
			}
			anb_add_accepted_culture_or_dip_power = {
				culture = mashkay_lizardfolk
				free = yes
			}
			anb_add_accepted_culture_or_dip_power = {
				culture = arraskay_lizardfolk
				free = yes
			}
			anb_add_accepted_culture_or_dip_power = {
				culture = draktaya_lizardfolk
				free = yes
			}
			anb_add_accepted_culture_or_dip_power = {
				culture = ichiadza_lizardfolk
				free = yes
			}
			anb_add_accepted_culture_or_dip_power = {
				culture = shagatyn_lizardfolk
				free = yes
			}
			anb_add_accepted_culture_or_dip_power = {
				culture = adzalanas_lizardfolk
				free = yes
			}
			anb_add_accepted_culture_or_dip_power = {
				culture = hishakaya_lizardfolk
				free = yes
			}
			anb_add_accepted_culture_or_dip_power = {
				culture = itayzemby_lizardfolk
				free = yes
			}
			anb_add_accepted_culture_or_dip_power = {
				culture = karshyray_lizardfolk
				free = yes
			}
			anb_add_accepted_culture_or_dip_power = {
				culture = shagashay_lizardfolk
				free = yes
			}
			anb_add_accepted_culture_or_dip_power = {
				culture = shyashkay_lizardfolk
				free = yes
			}
			anb_add_accepted_culture_or_dip_power = {
				culture = skarakara_lizardfolk
				free = yes
			}
		}
	]
	[[baashidi]
		custom_tooltip = anb_sarhal_cultural_union_baashidi_tt
		hidden_effect = {
			anb_add_accepted_culture_or_dip_power = {
				culture = ashamadi
				free = yes
			}
			anb_add_accepted_culture_or_dip_power = {
				culture = dhebiji
				free = yes
			}
			anb_add_accepted_culture_or_dip_power = {
				culture = suhratbi
				free = yes
			}
			anb_add_accepted_culture_or_dip_power = {
				culture = guryadagga
				free = yes
			}
		}
	]
	[[halfling]
		custom_tooltip = anb_sarhal_cultural_union_halfling_tt
		hidden_effect = {
			anb_add_accepted_culture_or_dip_power = {
				culture = mazava
				free = yes
			}
			anb_add_accepted_culture_or_dip_power = {
				culture = mboala
				free = yes
			}
			anb_add_accepted_culture_or_dip_power = {
				culture = fomarati
				free = yes
			}
			anb_add_accepted_culture_or_dip_power = {
				culture = zohebidi
				free = yes
			}
			anb_add_accepted_culture_or_dip_power = {
				culture = amezatany
				free = yes
			}
		}
	]
	[[irsukuba]
		custom_tooltip = anb_sarhal_cultural_union_irsukuba_tt
		hidden_effect = {
			anb_add_accepted_culture_or_dip_power = {
				culture = ikilshebe
				free = yes
			}
			anb_add_accepted_culture_or_dip_power = {
				culture = gumzemo
				free = yes
			}
			anb_add_accepted_culture_or_dip_power = {
				culture = kudemtu
				free = yes
			}
			anb_add_accepted_culture_or_dip_power = {
				culture = echenka
				free = yes
			}
		}
	]
	[[vurebindu]
		custom_tooltip = anb_sarhal_cultural_union_vurebindu_tt
		hidden_effect = {
			anb_add_accepted_culture_or_dip_power = {
				culture = zuvunwa
				free = yes
			}
			anb_add_accepted_culture_or_dip_power = {
				culture = kuivanhi
				free = yes
			}
		}
	]
	[[kheteratan]
		custom_tooltip = anb_sarhal_cultural_union_kheteratan_tt
		hidden_effect = {
			anb_add_accepted_culture_or_dip_power = {
				culture = horakheti
				free = yes
			}
			anb_add_accepted_culture_or_dip_power = {
				culture = hapremiti
				free = yes
			}
			anb_add_accepted_culture_or_dip_power = {
				culture = tijarikheti
				free = yes
			}
			anb_add_accepted_culture_or_dip_power = {
				culture = irsmahapan
				free = yes
			}
			anb_add_accepted_culture_or_dip_power = {
				culture = shasouran
				free = yes
			}
			anb_add_accepted_culture_or_dip_power = {
				culture = korosheshi
				free = yes
			}
		}
	]
	[[west_sarhaly]
		custom_tooltip = anb_sarhal_cultural_union_west_sarhaly_tt
		hidden_effect = {
			anb_add_accepted_culture_or_dip_power = {
				culture = mantimatu
				free = yes
			}
			anb_add_accepted_culture_or_dip_power = {
				culture = jiromji
				free = yes
			}
			anb_add_accepted_culture_or_dip_power = {
				culture = ndurubu
				free = yes
			}
			anb_add_accepted_culture_or_dip_power = {
				culture = tamajoba
				free = yes
			}
			anb_add_accepted_culture_or_dip_power = {
				culture = taafi
				free = yes
			}
			anb_add_accepted_culture_or_dip_power = {
				culture = binwarji
				free = yes
			}
		}
	]
	[[gnollish]
		custom_tooltip = anb_sarhal_cultural_union_gnollish_tt
		hidden_effect = {
			anb_add_accepted_culture_or_dip_power = {
				culture = windhowler_gnoll
				free = yes
			}
			anb_add_accepted_culture_or_dip_power = {
				culture = pyreclaw_gnoll
				free = yes
			}
			anb_add_accepted_culture_or_dip_power = {
				culture = fieldstalker_gnoll
				free = yes
			}
			anb_add_accepted_culture_or_dip_power = {
				culture = sandfang_gnoll
				free = yes
			}
			anb_add_accepted_culture_or_dip_power = {
				culture = seascourge_gnoll
				free = yes
			}
		}
	]
	[[bulwari]
		custom_tooltip = anb_sarhal_cultural_union_bulwari_tt
		hidden_effect = {
			anb_add_accepted_culture_or_dip_power = {
				culture = brasanni
				free = yes
			}
			anb_add_accepted_culture_or_dip_power = {
				culture = sadnatu
				free = yes
			}
			anb_add_accepted_culture_or_dip_power = {
				culture = zanite
				free = yes
			}
			anb_add_accepted_culture_or_dip_power = {
				culture = surani
				free = yes
			}
			anb_add_accepted_culture_or_dip_power = {
				culture = maqeti
				free = yes
			}
			anb_add_accepted_culture_or_dip_power = {
				culture = masnsih
				free = yes
			}
			anb_add_accepted_culture_or_dip_power = {
				culture = gelkar
				free = yes
			}
			anb_add_accepted_culture_or_dip_power = {
				culture = bahari
				free = yes
			}
			anb_add_accepted_culture_or_dip_power = {
				culture = kuzarami
				free = yes
			}
		}
	]
	[[elven]
		custom_tooltip = anb_sarhal_cultural_union_elven_tt
		hidden_effect = {
			anb_add_accepted_culture_or_dip_power = {
				culture = desert_elf
				free = yes
			}
			anb_add_accepted_culture_or_dip_power = {
				culture = sun_elf
				free = yes
			}
		}
	]
	[[harpy]
		custom_tooltip = anb_sarhal_cultural_union_harpy_tt
		hidden_effect = {
			anb_add_accepted_culture_or_dip_power = {
				culture = nzeri_harpy
				free = yes
			}
			anb_add_accepted_culture_or_dip_power = {
				culture = naleni_harpy
				free = yes
			}
			anb_add_accepted_culture_or_dip_power = {
				culture = firanyan_harpy
				free = yes
			}
			anb_add_accepted_culture_or_dip_power = {
				culture = siadunan_harpy
				free = yes
			}
			anb_add_accepted_culture_or_dip_power = {
				culture = stonewing_harpy
				free = yes
			}
		}
	]
	[[akasi]
		custom_tooltip = anb_sarhal_cultural_union_akasi_tt
		hidden_effect = {
			anb_add_accepted_culture_or_dip_power = {
				culture = desha
				free = yes
			}
			anb_add_accepted_culture_or_dip_power = {
				culture = khasani
				free = yes
			}
			anb_add_accepted_culture_or_dip_power = {
				culture = far_akasi
				free = yes
			}
		}
	]
}

form_adzalan_effect = {
	change_tag = L87 #Adzalan
	change_government = theocracy
	add_government_reform = ashhana_realm_of_art
	hidden_effect = { restore_country_name = yes }
	increase_government_rank_scripted_effect = { rank = 2 }
	if = {
		limit = { has_custom_ideas = no }
		country_event = { id = ideagroups.1 } #Swap Ideas
	}
	add_country_modifier = {
		name = "centralization_modifier"
		duration = 7300
	}
	hidden_effect = {
		set_country_flag = adzalan_formed
		clr_country_flag = ashhana_disaster_supporting_canvas
		remove_country_modifier = ashhana_control_adm_advisor
		remove_country_modifier = ashhana_control_dip_advisor
		remove_country_modifier = ashhana_control_mil_advisor
		if = {
			limit = { NOT = { has_global_flag = 333rdformed } }
			every_country = {
				limit = {
					religion = anzalkatsa
				}
				country_event = { id = AnzalkatsaSchoolFightEvents.8 }
			}
			anb_lizardfolk_clash_change_variable_plus = yes
		}
	}
}

form_bwa_tanizu_effect = {
	change_tag = L59
	hidden_effect = { restore_country_name = yes }
	set_government_rank_scripted_effect = { rank = 3 }
	#swap_non_generic_missions = yes
	
	ishyamtumu_region = {
		limit = {
			NOT = { owned_by = ROOT }
		}
		add_permanent_claim = L59
	}
	odu_kherass_region = {
		limit = {
			NOT = { owned_by = ROOT }
		}
		add_permanent_claim = L59
	}
	if = {
		limit = { has_custom_ideas = no }
		country_event = { id = ideagroups.1 } #Swap Ideas
	}
	add_prestige = 50
	add_country_modifier = {
		name = "centralization_modifier"
		duration = 7300
	}
}
triplets_add_development_effect = {
	if = {
		limit = {
			has_building = temple
			NOT = {
				has_province_flag = triplet_gained_development_cathedral
				has_province_flag = triplet_gained_development_temple
			}
		}
		set_province_flag = triplet_gained_development_temple
		add_base_tax = 1
	}
	else_if = {
		limit = {
			has_building = cathedral
			NOT = { has_province_flag = triplet_gained_development_cathedral }
		}
		set_province_flag = triplet_gained_development_cathedral
		if = {
			limit = {
				has_province_flag = triplet_gained_development_temple 			
			}
			add_base_tax = 1
		}
		else = {
			add_base_tax = 2
		}
	}	
}
apply_triplets_temple_bonus = {
	if = {
		limit = {
			owner = { has_estate_privilege = estate_church_development_of_temples }
		}
		if = {
			limit = {
				owner = { has_government_attribute = buff_development_of_temple }
				has_building = cathedral
			}
			add_province_modifier = {
				name = estate_church_development_of_temples_mod_buff
				duration = -1
			}
		}
		else = {
			add_province_modifier = {
				name = estate_church_development_of_temples_mod
				duration = -1
			}
		}
	}
	else = {
		if = {
			limit = { owner = { mission_completed = R38_accommodate_new_students } }
			add_province_modifier = {
				name = bhuvauri_estate_lowercastes_development_of_temples_mod
				duration = -1
			}
		}
		else = {
			add_province_modifier = {
				name = estate_lowercastes_development_of_temples_mod
				duration = -1
			}
		}
	}
}

clear_triplets_temple_bonus = {
	if = {
		limit = {
			has_province_modifier = estate_church_development_of_temples_mod
		}
		remove_province_modifier = estate_church_development_of_temples_mod
	}
	else_if = {
		limit = {
			has_province_modifier = estate_church_development_of_temples_mod_buff
		}
		remove_province_modifier = estate_church_development_of_temples_mod_buff
	}
	else_if = {
		limit = {
			has_province_modifier = estate_lowercastes_development_of_temples_mod
		}
		remove_province_modifier = estate_lowercastes_development_of_temples_mod
	}
	else_if = {
		limit = {
			has_province_modifier = bhuvauri_estate_lowercastes_development_of_temples_mod
		}
		remove_province_modifier = bhuvauri_estate_lowercastes_development_of_temples_mod
	}
}

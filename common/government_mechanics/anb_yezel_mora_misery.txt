# I decided to use 3 different gov mechanics rather than 1 because with different maximum amounts and different
# effects on the buttons, I think it ended up a little simpler this way.
yezel_mora_misery_mechanic_t1 = {
	alert_icon_gfx = GFX_alerticons_government_mechanics
	alert_icon_index = 34
	available = {
		has_reform = shadow_horde
		NOT = { has_country_flag = yezel_mora_misery_t2 }
		NOT = { has_country_flag = yezel_mora_misery_t3 }
	}
	powers = {
		yezel_mora_misery_power_t1 = {
			gui = yezel_mora_misery_bar
			min = 0
			max = 100
			default = 0
			reset_on_new_ruler = no
			is_good = yes
			scaled_modifier = {
				start_value = 0
				end_value = 100
				modifier = {
					shock_damage = 0.1
					siege_ability = 0.15
					administrative_efficiency = 0.05
				}
			}
		}
	}

	#These interactions are only here so the player gets the popup when they can be used. The actual effects are in custom buttons in countrygovernmentview.txt
	#The AI can use these buttons, though for now the weights are set to 0
	interactions = {
		riftwhisper_t1 = {
			gui = yezel_mora_misery_gov_button_1
			icon = GFX_yezel_mora_misery_riftwhisper
			cost_type = yezel_mora_misery_power_t1
			cost = 5
			trigger = {
				#Check the cooldown variable that the custom buttons use
				NOT = {
					has_country_modifier = yezel_mora_misery_riftwhisper_mod_t1
				}
			}
			effect = {
				add_country_modifier = {
					name = yezel_mora_misery_riftwhisper_mod_t1
					duration = 1825 #5 years
				}
			}
			cooldown_years = 5
			ai_chance = {
				factor = 0 #Maybe we can add AI factors in later
			}
		}
		smoketusk_t1 = {
			gui = yezel_mora_misery_gov_button_2
			icon = yezel_mora_misery_smoketusk
			cost_type = yezel_mora_misery_power_t1
			cost = 5
			trigger = {
				#Check the cooldown variable that the custom buttons use
				NOT = {
					has_country_modifier = yezel_mora_misery_smoketusk_cooldown
				}
			}
			effect = {
				add_rebel_progress = {
					value = -20
				}
			}
			cooldown_years = 5
			ai_chance = {
				factor = 0 #Maybe we can add AI factors in later
			}
		}
		gloomweaver_t1 = {
			gui = yezel_mora_misery_gov_button_3
			icon = yezel_mora_misery_gloomweaver
			cost_type = yezel_mora_misery_power_t1
			cost = 10
			trigger = {
				#Check the cooldown variable that the custom buttons use
				NOT = {
					has_country_modifier = yezel_mora_misery_gloomweaver_cooldown
				}
			}
			effect = {
				change_mana = { amount = 50 }
			}
			cooldown_years = 5
			ai_chance = {
				factor = 0 #Maybe we can add AI factors in later
			}
		}
	}
}

yezel_mora_misery_mechanic_t2 = {
	alert_icon_gfx = GFX_alerticons_government_mechanics
	alert_icon_index = 34
	available = {
		has_reform = shadow_horde
		has_country_flag = yezel_mora_misery_t2
	}
	powers = {
		yezel_mora_misery_power_t2 = {
			gui = yezel_mora_misery_bar
			min = 0
			max = 300
			default = 0
			reset_on_new_ruler = no
			is_good = yes
			scaled_modifier = {
				start_value = 0
				end_value = 300
				modifier = {
					shock_damage = 0.2
					siege_ability = 0.33
					administrative_efficiency = 0.1
				}
			}
		}
	}

	interactions = {
		riftwhisper_t2 = {
			gui = yezel_mora_misery_gov_button_1
			icon = GFX_yezel_mora_misery_riftwhisper
			cost_type = yezel_mora_misery_power_t2
			cost = 15
			trigger = {
				#Check the cooldown variable that the custom buttons use
				NOT = {
					has_country_modifier = yezel_mora_misery_riftwhisper_mod_t2
				}
			}
			effect = {
				add_country_modifier = {
					name = yezel_mora_misery_riftwhisper_mod_t2
					duration = 1825 #5 years
				}
			}
			cooldown_years = 5
			ai_chance = {
				factor = 0 #Maybe we can add AI factors in later
			}
		}
		smoketusk_t2 = {
			gui = yezel_mora_misery_gov_button_2
			icon = yezel_mora_misery_smoketusk
			cost_type = yezel_mora_misery_power_t2
			cost = 15
			trigger = {
				#Check the cooldown variable that the custom buttons use
				NOT = {
					has_country_modifier = yezel_mora_misery_smoketusk_cooldown
				}
			}
			effect = {
				add_rebel_progress = {
					value = -30
				}
				add_country_modifier = {
					name = yezel_mora_misery_smoketusk_mod_t2
					duration = 7300 #20 years
				}
			}
			cooldown_years = 5
			ai_chance = {
				factor = 0 #Maybe we can add AI factors in later
			}
		}
		gloomweaver_t2 = {
			gui = yezel_mora_misery_gov_button_3
			icon = yezel_mora_misery_gloomweaver
			cost_type = yezel_mora_misery_power_t2
			cost = 30
			trigger = {
				#Check the cooldown variable that the custom buttons use
				NOT = {
					has_country_modifier = yezel_mora_misery_gloomweaver_cooldown
				}
			}
			effect = {
				change_mana = { amount = 100 }
			}
			cooldown_years = 5
			ai_chance = {
				factor = 0 #Maybe we can add AI factors in later
			}
		}
	}
}

yezel_mora_misery_mechanic_t3 = {
	alert_icon_gfx = GFX_alerticons_government_mechanics
	alert_icon_index = 34
	available = {
		has_reform = shadow_horde
		has_country_flag = yezel_mora_misery_t3
	}
	powers = {
		yezel_mora_misery_power_t3 = {
			gui = yezel_mora_misery_bar
			min = 0
			max = 900
			default = 0
			reset_on_new_ruler = no
			is_good = yes
			scaled_modifier = {
				start_value = 0
				end_value = 900
				modifier = {
					shock_damage = 0.33
					siege_ability = 0.5
					administrative_efficiency = 0.15
				}
			}
			range_modifier = {
				start_value = 0
				end_value = 900
				modifier = { 
					overextension_impact_modifier = -0.25
				}
			}
		}
	}

	interactions = {
		riftwhisper_t3 = {
			gui = yezel_mora_misery_gov_button_1
			icon = GFX_yezel_mora_misery_riftwhisper
			cost_type = yezel_mora_misery_power_t3
			cost = 45
			trigger = {
				#Check the cooldown variable that the custom buttons use
				NOT = {
					has_country_modifier = yezel_mora_misery_riftwhisper_mod_t3
				}
			}
			effect = {
				add_country_modifier = {
					name = yezel_mora_misery_riftwhisper_mod_t3
					duration = 1825 #5 years
				}
			}
			cooldown_years = 5
			ai_chance = {
				factor = 0 #Maybe we can add AI factors in later
			}
		}
		smoketusk_t3 = {
			gui = yezel_mora_misery_gov_button_2
			icon = yezel_mora_misery_smoketusk
			cost_type = yezel_mora_misery_power_t3
			cost = 45
			trigger = {
				#Check the cooldown variable that the custom buttons use
				NOT = {
					has_country_modifier = yezel_mora_misery_smoketusk_cooldown
				}
			}
			effect = {
				add_rebel_progress = {
					value = -40
				}
				# Remove all rebel occupations
				# Note that this will not trigger on_siege_[won/lost]_province - so anything that checks for you sieging land will not trigger
				every_owned_province = {
					limit = {
						controller = {
							tag = REB
						}
					}
					change_controller = ROOT
				}
				add_country_modifier = {
					name = yezel_mora_misery_smoketusk_mod_t3
					duration = 7300 #20 years
				}
			}
			cooldown_years = 5
			ai_chance = {
				factor = 0 #Maybe we can add AI factors in later
			}
		}
		gloomweaver_t3 = {
			gui = yezel_mora_misery_gov_button_3
			icon = yezel_mora_misery_gloomweaver
			cost_type = yezel_mora_misery_power_t3
			cost = 90
			trigger = {
				#Check the cooldown variable that the custom buttons use
				NOT = {
					has_country_modifier = yezel_mora_misery_gloomweaver_cooldown
				}
			}
			effect = {
				set_country_flag = all_spell_free_next_cast
			}
			cooldown_years = 5
			ai_chance = {
				factor = 0 #Maybe we can add AI factors in later
			}
		}
	}
}
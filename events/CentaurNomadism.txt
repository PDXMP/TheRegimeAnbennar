
namespace = centaur_nomad

country_event = { #Refresh capital move cost when cooldown ends
	id = centaur_nomad.1
	title = none
	desc = none
	picture = none

	hidden = yes
	is_triggered_only = yes

	trigger = {
		ai = no
		has_government_attribute = centaur_nomadism_attribute
	}

	option = {
		name = none
		update_nomadism_capital_move_cost = yes
	}
}

#give stuff to new capital provinces
country_event = {
	id = centaur_nomad.100
	title = none
	desc = none
	picture = none
	hidden = yes
	is_triggered_only = yes

	immediate = {
		set_variable = {
   			which = NZOC_horde_unity
    		value = 0
		}
		set_variable = {
   			which = NZOC_reform_progress
    		value = 0
		}
		set_variable = {
   			which = NZOC_manpower
    		value = 0
		}
		set_variable = {
   			which = nzoc_provinces_effected_positive
    		value = 0
		}
		set_variable = {
   			which = nzoc_provinces_effected_negative
    		value = 0
		}
	}

	trigger = {
		has_government_attribute = centaur_nomadism_attribute
		NOT = { has_country_flag = nomad_setup }
	}

	option = {
		hidden_effect = {
			add_nomadic_capital_moved_modifier = { scope = capital_scope }
			set_country_flag = nomad_setup
			set_country_flag = has_centaur_nomadism_attribute
			apply_owned_NZOC_country = yes
			if = {
				limit = { ai = no }
				country_event = { id = centaur_nomad.1 days = 1096 } #3 years
				update_nomadism_capital_move_cost = yes
			}
		}
	}
}

#Itinerant Capital - AI event because I don't trust the AI to handle this and I want them to survive until 1820
country_event = {
	id = centaur_nomad.103
	title = none
	desc = none
	picture = none
	hidden = yes
	is_triggered_only = yes

	trigger = {
		has_government_attribute = centaur_nomadism_attribute
		NOT = { has_country_modifier = nomadic_capital_just_moved }
		any_owned_province = {
			continent = ROOT
			controlled_by = ROOT
			is_state = yes
			has_base_nomadic_zone_of_control_modifier = no
			is_capital = no
			is_city = yes
		}
		ai = yes
		is_at_war = no	#You cannot move your capital during war
		NOT = { #Blocks moving if subject of Maghargma, messes with the MT
			AND = { 
				I90 = { ai = no }
				is_subject_of = I90 
			}
		}
	}

	immediate = {
		random_owned_province = {
			limit = {
				continent = ROOT
				controlled_by = ROOT
				is_state = yes 
				has_base_nomadic_zone_of_control_modifier = no
				is_capital = no
				is_city = yes
			}
			save_event_target_as = cent_new_capital
		}
		random_owned_province = {
			limit = {
				continent = ROOT
				controlled_by = ROOT
				is_state = yes 
				has_base_nomadic_zone_of_control_modifier = no
				is_capital = no
				is_city = yes
				OR = {
					local_autonomy = 20
					development = 10
				}
			}
			save_event_target_as = cent_new_capital
		}
		random_owned_province = {
			limit = {
				continent = ROOT
				controlled_by = ROOT
				is_state = yes 
				has_base_nomadic_zone_of_control_modifier = no
				is_capital = no
				is_city = yes
				OR = {
					local_autonomy = 40
					development = 20
				}
			}
			save_event_target_as = cent_new_capital
		}
		random_owned_province = {
			limit = {
				continent = ROOT
				controlled_by = ROOT
				is_state = yes 
				has_base_nomadic_zone_of_control_modifier = no
				is_capital = no
				is_city = yes
				OR = {
					local_autonomy = 60
					development = 30
				}
			}
			save_event_target_as = cent_new_capital
		}
		random_owned_province = {
			limit = {
				continent = ROOT
				controlled_by = ROOT
				is_state = yes 
				has_base_nomadic_zone_of_control_modifier = no
				is_capital = no
				is_city = yes
				OR = {
					local_autonomy = 80
					development = 40
				}
			}
			save_event_target_as = cent_new_capital
		}
		random_owned_province = {
			limit = {
				continent = ROOT
				controlled_by = ROOT
				is_state = yes 
				has_base_nomadic_zone_of_control_modifier = no
				is_capital = no
				is_city = yes
				OR = {
					local_autonomy = 20
					development = 10
				}
				religion = ROOT
			}
			save_event_target_as = cent_new_capital
		}
		random_owned_province = {
			limit = {
				continent = ROOT
				controlled_by = ROOT
				is_state = yes 
				has_base_nomadic_zone_of_control_modifier = no
				is_capital = no
				is_city = yes
				OR = {
					local_autonomy = 40
					development = 20
				}
				religion = ROOT
			}
			save_event_target_as = cent_new_capital
		}
		random_owned_province = {
			limit = {
				continent = ROOT
				controlled_by = ROOT
				is_state = yes 
				has_base_nomadic_zone_of_control_modifier = no
				is_capital = no
				is_city = yes
				OR = {
					local_autonomy = 60
					development = 30
				}
				religion = ROOT
			}
			save_event_target_as = cent_new_capital
		}
		random_owned_province = {
			limit = {
				continent = ROOT
				controlled_by = ROOT
				is_state = yes 
				has_base_nomadic_zone_of_control_modifier = no
				is_capital = no
				is_city = yes
				OR = {
					local_autonomy = 80
					development = 40
				}
				religion = ROOT
			}
			save_event_target_as = cent_new_capital
		}
	}

	option = {
		capital_scope = { add_local_autonomy = 10 }
		set_capital = event_target:cent_new_capital
		ai_chance = {
			factor = 1
		}
	}
}

#Notification Event when moving capital
country_event = {
	id = centaur_nomad.200
	title = centaur_nomad.200.t
	desc = centaur_nomad.200.d
	picture = CENTAUR_CAMPFIRE_eventPicture
	is_triggered_only = yes

	option = {
		name = centaur_nomad.200.a
		centaur_consume_pre_modifiers_country = yes
		apply_pre_modifiers_NZOC_country = yes
		apply_reform_modifiers_NZOC_country = yes
		custom_tooltip = NZOC_horde_unity_gain_tt
		custom_tooltip = NZOC_reform_progress_gain_tt
		if = { #Golden Tremor
			limit = { has_country_flag = I57_nzoc_effects_flag }
			custom_tooltip = NZOC_manpower_gain_tt
		}
		custom_tooltip = NZOC_positive_province_count_tt
		custom_tooltip = NZOC_negative_province_count_tt
		
		if = { #Great Storm Things
			limit = { is_or_was_tag = { tag = I80 } }
			if = {
				limit = { has_country_flag = I80_capital_mage_tower }
				capital_scope = {
					add_building_construction = {
						building = mage_tower
						speed = 1
						cost = 0.2
					}
				}
				if = {
					limit = { capital_scope = { has_manufactory_trigger = yes } }
					add_treasury = -100
				}
				clr_country_flag = I80_capital_mage_tower
			}
			if = {
				limit = { has_country_flag = I80_mage_movement } 
				increase_magic_experience = { unmodified_amount = 25 }
			}
			if = {
				limit = { has_country_flag = I80_tirughuun_capital capital = 5138 }
				clr_country_flag = I80_tirughuun_capital
				increase_magic_experience = { unmodified_amount = 50 }
			}
		}
	}

	after = {
		set_variable = {
    		which = NZOC_horde_unity
    		value = 0
		}
		set_variable = {
    		which = NZOC_reform_progress
    		value = 0
		}
		set_variable = {
    		which = nzoc_provinces_effected_positive
    		value = 0
		}
		set_variable = {
    		which = nzoc_provinces_effected_negative
    		value = 0
		}
	}
}
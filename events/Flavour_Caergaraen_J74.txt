namespace = caergaraen

country_event = {
	id = caergaraen.1 #The Sword Has Returned
	title = caergaraen.1.t
	desc = caergaraen.1.d
	picture = SWORD_OF_OSMAN_eventPicture

	is_triggered_only = yes

	trigger = { 
		is_or_was_tag = { tag = J74 } #Caergaraen
		NOT = { has_country_modifier = J74_saerasyar_sword_base_mod }
	}

	option = {
		name = caergaraen.1.a
		custom_tooltip = J74_gain_saerasyar_tt
		custom_tooltip = desc_J74_saerasyar_sword_base_mod
		if = {
			limit = { NOT = { has_country_flag = J74_to_bear_the_sword_enable_flag } }
			custom_tooltip = J74_to_bear_the_sword_enable_tt
			set_country_flag = J74_to_bear_the_sword_enable_flag
		}
		hidden_effect = {
			add_country_modifier = {
				name = J74_saerasyar_sword_base_mod
				duration = -1
			}
			set_country_flag = disabled_expelling_flag
			set_country_flag = disabled_purging_flag
			if = {
				limit = { has_country_flag = J74_upgrade_saerasyar_opinion_flag }
				add_country_modifier = {
					name = J74_saerasyar_sword_opinion_mod
					duration = -1
				}
			}
			if = {
				limit = { has_country_flag = J74_upgrade_saerasyar_mother_flag }
				add_country_modifier = {
					name = J74_saerasyar_sword_mother_mod
					duration = -1
				}
			}
			if = {
				limit = { has_country_flag = J74_upgrade_saerasyar_daughter_flag }
				add_country_modifier = {
					name = J74_saerasyar_sword_daughter_mod
					duration = -1
				}
			}
			if = {
				limit = { has_country_flag = J74_upgrade_saerasyar_shock_flag }
				add_country_modifier = {
					name = J74_saerasyar_sword_shock_mod
					duration = -1
				}
			}
		}
	}
}

country_event = {
	id = caergaraen.2 #Judging The Guilty
	title = caergaraen.2.t
	desc = caergaraen.2.d
	picture = BONFIRE_OF_THE_VANITIES_eventPicture

	is_triggered_only = yes

	immediate = {
		hidden_effect = {
			kill_ruler = yes
			add_stability = -1
			remove_country_modifier = J74_saerasyar_sword_base_mod
			remove_country_modifier = J74_saerasyar_sword_opinion_mod
			remove_country_modifier = J74_saerasyar_sword_mother_mod
			remove_country_modifier = J74_saerasyar_sword_daughter_mod
			remove_country_modifier = J74_saerasyar_sword_shock_mod
			clr_country_flag = disabled_expelling_flag
			clr_country_flag = disabled_purging_flag
			set_country_flag = J74_disable_saerasyar_flag
		}
	}

	option = {
		name = caergaraen.2.a
		tooltip = {
			custom_tooltip = J75_remove_saerasyar_tt
			kill_ruler = yes
			add_stability = -1
		}
	}
}

country_event = {
	id = caergaraen.3 #Mother And Daughter
	title = caergaraen.3.t
	desc = caergaraen.3.d
	picture = QUEEN_AT_COUNCIL_TABLE_eventPicture

	is_triggered_only = yes

	option = {
		name = caergaraen.3.a
		J74_upgrade_saerasyar = { upgrade = mother }
		clematar_area = { add_permanent_claim = ROOT }
		sarihaddu_area = { add_permanent_claim = ROOT }
	}

	option = {
		name = caergaraen.3.b
		J74_upgrade_saerasyar = { upgrade = daughter }
		clematar_area = { add_permanent_claim = ROOT }
		sarihaddu_area = { add_permanent_claim = ROOT }
	}
}

country_event = {
	id = caergaraen.4 #Fall of Rakkabuttai
	title = caergaraen.4.t
	desc = caergaraen.4.d
	picture = easterngfx_COUNTRY_COLLAPSE_eventPicture

	is_triggered_only = yes

	option = {
		name = caergaraen.4.a
		add_army_tradition = 5
		2568 = { #Rakkabuttai
			add_devastation = 20
			change_trade_goods = iron
		}
		oremvand_area = { add_permanent_claim = ROOT }
		rakkabuttai_area = { add_permanent_claim = ROOT }
		zaernmaera_area = { add_permanent_claim = ROOT }
	}

	option = {
		name = caergaraen.4.b
		add_army_tradition = 20
		2568 = { #Rakkabuttai
			add_devastation = 50
			change_trade_goods = iron
		}
		oremvand_area = { add_permanent_claim = ROOT }
		rakkabuttai_area = { add_permanent_claim = ROOT }
		zaernmaera_area = { add_permanent_claim = ROOT }
		custom_tooltip = J74_sword_warning_tt
		hidden_effect = {
			random = {
				chance = 50
				country_event = {
					id = caergaraen.2 #Judging The Guilty
				}
			}
		}
	}
}

country_event = {
	id = caergaraen.5 #Fate of Oremvand
	title = caergaraen.5.t
	desc = caergaraen.5.d
	picture = maghrebi_SHIP_SAILING_eventPicture

	is_triggered_only = yes

	option = {
		name = caergaraen.5.a
		add_treasury = 100
		2588 = { #Haebysziund
			change_trade_goods = silk
			early_carrack = ROOT
			galley = ROOT
			galley = ROOT
			galley = ROOT
			galley = ROOT
			galley = ROOT
		}
	}
}

country_event = {
	id = caergaraen.6 #A Call Together
	title = caergaraen.6.t
	desc = caergaraen.6.d
	picture = DIPLOMACY_SIGNING_eventPicture

	is_triggered_only = yes

	option = {
		name = caergaraen.6.a
		custom_tooltip = J74_vassalize_tribes_tt
		hidden_effect = {
			H23 = { country_event = { id = caergaraen.7 days = 30 } } #Kaeorg
			H28 = { country_event = { id = caergaraen.7 days = 23 } } #Durasyar
			H29 = { country_event = { id = caergaraen.7 days = 37 } } #Tsidarok
		}
	}
}

country_event = {
	id = caergaraen.7 #
	title = caergaraen.7.t
	desc = caergaraen.7.d
	picture = DIPLOMAT_INTERROGATION_eventPicture

	is_triggered_only = yes

	option = { #Accept
		name = caergaraen.7.a
		trigger = {
			OR = {
				ai = no
				trust = {
					who = FROM
					value = 60
				}
			}
		}
		ai_chance = { factor = 1000 }

		tooltip = { FROM = { vassalize = ROOT } }
		hidden_effect = {
			FROM = { country_event = { id = caergaraen.8 } }
		}
	}

	option = { #Deny
		name = caergaraen.7.b
		ai_chance = { factor = 1 }

		tooltip = {
			FROM = {
				add_casus_belli = {
					type = cb_vassalize_mission
					target = ROOT
					months = 240
				}
			}
		}
		hidden_effect = {
			FROM = { country_event = { id = caergaraen.9 } }
		}
	}
}

country_event = {
	id = caergaraen.8 #
	title = caergaraen.8.t
	desc = caergaraen.8.d
	picture = MILITARISTICALLY_TALENTED_RULER_eventPicture

	is_triggered_only = yes

	option = {
		name = caergaraen.8.a
		vassalize = FROM
	}
}

country_event = {
	id = caergaraen.9 #
	title = caergaraen.9.t
	desc = caergaraen.9.d
	picture = BAD_WITH_MONARCH_eventPicture

	is_triggered_only = yes

	option = { 
		name = caergaraen.9.a
		add_casus_belli = {
			type = cb_vassalize_mission
			target = FROM
			months = 240
		}
	}
}

country_event = {
	id = caergaraen.10 #Hidden event to refund church power since they're paid after the effects
	title = none
	desc = none
	picture = none

	is_triggered_only = yes
	hidden = yes

	option = {
		name = none
		add_church_power = 50
	}
}

country_event = {
	id = caergaraen.11 #Hidden event check sword problems
	title = none
	desc = none
	picture = none

	is_triggered_only = yes
	hidden = yes

	trigger = {
		has_country_modifier = J74_saerasyar_sword_base_mod
	}

	option = {
		name = none
		if = {
			limit = {
				OR = {
					war_exhaustion = 15
					NOT = { stability = -2 }
					AND = {
						has_country_flag = J74_upgrade_saerasyar_daughter_flag
						any_known_country = { 
							has_opinion_modifier = { who = ROOT modifier = aggressive_expansion }
							NOT = { has_opinion_modifier = { who = ROOT modifier = aggressive_expansion value = -74 } }
						}
					}
					AND = {
						has_country_flag = J74_upgrade_saerasyar_mother_flag
						NOT = { had_recent_war = 15 }
					}
				}
			}
			country_event = {
				id = caergaraen.2 #Judging The Guilty
			}
		}
	}
}

namespace = flavour_nispac

#A Shadow Over Nianano
country_event = {
	id = flavour_nispac.1
	title = flavour_nispac.1.t
	desc = flavour_nispac.1.d
	picture = COLONIZATION_eventPicture
	
	is_triggered_only = yes
	fire_only_once = yes
	trigger = { tag = N78 }

	option = {
		name = flavour_nispac.1.a

		add_legitimacy = -20
		add_prestige = -10
		add_country_modifier = {
			name = N78_the_walls_speak_of_war
			duration = -1
		}
		3670 = { #Nianano
			add_province_modifier = {
				name = N78_discontent_populace
				duration = -1
			}
		}
		hidden_effect = { country_event = { id = flavour_nispac.2 days = 180 } }
	}
}

#Tyrant Call
country_event = {
	id = flavour_nispac.2
	title = flavour_nispac.2.t
	desc = flavour_nispac.2.d
	picture = COLONIZATION_eventPicture
	
	is_triggered_only = yes
	trigger = { }


	option = {
		name = flavour_nispac.2.a

		add_legitimacy = -20
		add_prestige = -10
		largest_decrease_of_ogre_tolerance_effect = yes
		3672 = { #Dauvaike
			add_province_modifier = {
				name = N78_discontent_populace
				duration = -1
			}
		}
		3671 = { #Taonano
			add_province_modifier = {
				name = N78_discontent_populace
				duration = -1
			}
		}
		3669 = { #Imbatano
			add_province_modifier = {
				name = N78_discontent_populace
				duration = -1
			}	
		}
		hidden_effect = { country_event = { id = flavour_nispac.3 days = 180 } }
	}
}

#End of the False Cycle
country_event = {
	id = flavour_nispac.3
	title = flavour_nispac.3.t
	desc = flavour_nispac.3.d
	picture = COLONIZATION_eventPicture
	
	is_triggered_only = yes
	trigger = { }
	major = yes
	major_trigger = {
		capital_scope = { region = great_plateau_region }
	}

	option = { #Play Cilapaktu
		name = flavour_nispac.3.a
		trigger = { ai = no }
		
		hidden_effect = {
			3669 = { #Nianano
				cede_province = N89 #Cilapaktu
				add_core = N89 #Cilapaktu
				remove_core = N78 #Nispac
			}
			N89 = { 
				anb_add_accepted_culture_or_dip_power = {
					culture = kamgoro
					free = yes
				}
				add_republican_tradition = 100
			}
		}
		custom_tooltip = N78_nispac_is_over.tt
		switch_tag = N89
		N89 = { #Cilapaktu
			define_ruler = {
				name = "Cool Ogre Dude"
				adm = 3
				dip = 6
				mil = 1
				age = 25
			}
			add_ruler_personality = inspiring_leader_personality
			add_prestige = 20
			add_historical_friend_mutual = { tag = N81 }
		}
		hidden_effect = { 
			N78 = {
				every_owned_province = {
					remove_province_modifier = N78_discontent_populace
				}
				change_tag = N79 
			}
			vassalize = N79
			N79 = { #Cafana
				define_ruler = {
					name = "Cool Human Dude"
					adm = 5
					dip = 2
					mil = 4
					age = 26
				}
				add_ruler_personality = tactical_genius_personality
				clear_racial_military = yes
				change_unit_type = tech_utubodi
				update_unit_sprites_for_racial_mil = yes
				add_country_modifier = {
					name = "human_military"
					duration = -1
					hidden = yes
				}
				add_prestige = 20
				add_historical_friend_mutual = { tag = N89 }
				anb_add_accepted_culture_or_dip_power = {
					culture = skyfall_ogre
					free = yes
				}
				add_opinion = {
					who = N89
					modifier = N89_N79_love_modifier
				}
				reverse_add_opinion = {
					who = N89
					modifier = N89_N79_love_modifier
				}
				add_government_reform = N79_will_of_the_people_reform
			}
			country_event = {
				id = flavour_nispac.4
				days = 3650
			}
			every_known_country = {
				limit = {
					capital_scope = { region = great_plateau_region }
				}
				if = {
					limit = { culture = skyfall_ogre }
					add_opinion = {
						who = N79
						modifier = N89_N79_skyfall_love_modifier
					}
					add_opinion = {
						who = N89
						modifier = N89_N79_skyfall_love_modifier
					}
				}
				else = {
					add_opinion = {
						who = N79
						modifier = N89_N79_utubodi_love_modifier
					}
					add_opinion = {
						who = N89
						modifier = N89_N79_utubodi_love_modifier
					}
				}
			}
			N89 = { setup_vision_insyaa = yes }
		}
		N79 = {
			add_ruler_modifier = {
				name = N89_loyalty_to_the_reborn
				duration = -1
			}
		}
		custom_tooltip = N89_N79_utubodi_love.tt
		custom_tooltip = N78_nispac_return_foreshadowing.tt
	}
	option = { #Play Cafana
		name = flavour_nispac.3.b
		ai_chance = { factor = 100 }

		hidden_effect = {
			3669 = { #Nianano
				cede_province = N89 #Cilapaktu
				add_core = N89 #Cilapaktu
				remove_core = N78 #Nispac
			}
		}
		custom_tooltip = N78_nispac_is_over.tt
		change_tag = N79 
		define_ruler = {
			name = "Cool Human Dude"
			adm = 5
			dip = 2
			mil = 4
			age = 26
		}
		add_ruler_personality = tactical_genius_personality
		add_prestige = 20
		add_historical_friend_mutual = { tag = N89 }
		anb_add_accepted_culture_or_dip_power = {
			culture = skyfall_ogre
			free = yes
		}
		add_ruler_modifier = {
			name = N89_loyalty_to_the_reborn
			duration = -1
		}
		add_government_reform = N79_will_of_the_people_reform
		hidden_effect = { 
			every_owned_province = {
				remove_province_modifier = N78_discontent_populace
			}
			clear_racial_military = yes
			change_unit_type = tech_utubodi
			update_unit_sprites_for_racial_mil = yes
			add_country_modifier = {
				name = "human_military"
				duration = -1
				hidden = yes
			}
			N89 = { #Cilapaktu
				vassalize = N79
				define_ruler = {
					name = "Cool Ogre Dude"
					adm = 3
					dip = 6
					mil = 1
					age = 25
				}
				add_ruler_personality = inspiring_leader_personality
				add_prestige = 20
				setup_vision_insyaa = yes
				anb_add_accepted_culture_or_dip_power = {
					culture = kamgoro
					free = yes
				}
				add_republican_tradition = 100
				add_historical_friend_mutual = { tag = N81 }
				add_opinion = {
					who = N79
					modifier = N89_N79_love_modifier
				}
				reverse_add_opinion = {
					who = N79
					modifier = N89_N79_love_modifier
				}
			}
			country_event = {
				id = flavour_nispac.4
				days = 3650
			}
			every_known_country = {
				limit = {
					capital_scope = { region = great_plateau_region }
				}
				if = {
					limit = { culture = skyfall_ogre }
					add_opinion = {
						who = N79
						modifier = N89_N79_skyfall_love_modifier
					}
					add_opinion = {
						who = N89
						modifier = N89_N79_skyfall_love_modifier
					}
				}
				else = {
					add_opinion = {
						who = N79
						modifier = N89_N79_utubodi_love_modifier
					}
					add_opinion = {
						who = N89
						modifier = N89_N79_utubodi_love_modifier
					}
				}
			}
		}
		tooltip = {
			add_government_reform = N89_consent_of_the_people_reform
		}
		custom_tooltip = N89_N79_utubodi_love.tt
		custom_tooltip = N78_nispac_return_foreshadowing.tt
	}
}

#The Last Cry
country_event = {
	id = flavour_nispac.4
	title = flavour_nispac.4.t
	desc = flavour_nispac.4.d
	picture = COLONIZATION_eventPicture
	
	is_triggered_only = yes
	trigger = {
		N79 = { #Cafana
			exists = yes 
			is_subject_of = N89 #Cilapaktu
		}
	}

	option = { #Stay as
		name = flavour_nispac.4.a
		ai_chance = { factor = 100 }

		N79 = { #Cafana
			if = {
				limit = {
					NOT = { num_of_cities = 3 }
				}
				capital_scope = {
					spawn_rebels = {
						size = 1
						type = noble_rebels
					}
				}
			}
			else = {
				3671 = { cede_province = N78 add_core = N78 } #Taonano - Nispac
				hidden_effect = {
					every_owned_province = { add_core = N78 } #Nispac
					every_owned_province = {
						limit = { NOT = { is_capital_of = ROOT } }
						random = {
							chance = 20
							cede_province = N78 #Nispac
							add_core = N78
						}
					}
					N89 = { #Cilapktu
						every_owned_province = { add_core = N78 } #Nispac
					}
					N78 = { #Nispac
						change_government = theocracy
						add_government_reform = leading_clergy_reform
						define_general = {
							shock = 2
							fire = 3
							manuever = 1
							siege = 2
						}
					}
					3671 = { #Taonano
						infantry = N78 #Nispac
						infantry = N78 #Nispac
						infantry = N78 #Nispac
						infantry = N78 #Nispac
						infantry = N78 #Nispac
						infantry = N78 #Nispac
					}
				}
				N78 = {
					declare_war_with_cb = {
						who = N89
						casus_belli = cb_core
						war_goal_province = 3669
					}
				}
			}
		}
	}
	option = { #Play as Cafana
		name = flavour_nispac.4.b
		ai_chance = { factor = 0 }

		N79 = { #Cafana
			if = {
				limit = {
					NOT = { num_of_cities = 3 }
				}
				hidden_effect = {
					every_owned_province = { add_core = N78 } #Nispac
					3671 = {
						cede_province = N78 #Nispac
					}
				}
				change_tag = N78 #Nispac
				hidden_effect = {
					remove_country_modifier = N89_loyalty_to_the_reborn
					every_known_country = {
						remove_opinion = {
							who = N78
							modifier = N89_N79_skyfall_love_modifier
						}
						remove_opinion = {
							who = N89
							modifier = N89_N79_utubodi_love_modifier
						}
					}
					remove_opinion = {
						who = N89
						modifier = N89_N79_love_modifier
					}
					reverse_remove_opinion = {
						who = N89_N79_love_modifier
						modifier = N89_N79_love_modifier
					}
					N89 = { switch_tag = N78 }
				}
				N78 = {
					declare_war_with_cb = {
						who = N89
						casus_belli = cb_core
						war_goal_province = 3669 #Invetano
					}
				}
			}
			else = {
				hidden_effect = { 3671 = { cede_province = N78 add_core = N78 } } #Taonano - Nispac
				ROOT = { switch_tag = N78 } #Nispac
				hidden_effect = {
					every_owned_province = { add_core = N78 } #Nispac
					N89 = { #Cilapktu
						every_owned_province = { add_core = N78 } #Nispac
					}
					every_owned_province = {
						limit = { NOT = { is_capital_of = ROOT } }
						random = {
							chance = 50
							cede_province = N78 #Nispac
						}
					}
					N78 = { #Nispac
						change_government = theocracy
						add_government_reform = leading_clergy_reform
						define_general = {
							shock = 2
							fire = 3
							manuever = 1
							siege = 2
						}
					}
					3671 = { #Taonano
						infantry = N78 #Nispac
						infantry = N78 #Nispac
						infantry = N78 #Nispac
						infantry = N78 #Nispac
						infantry = N78 #Nispac
						infantry = N78 #Nispac
					}
				}
				N78 = {
					declare_war_with_cb = {
						who = N89
						casus_belli = cb_core
						war_goal_province = 3669 #Imbetano
					}
				}
			}
		}
	}
}

country_event = {
	id = flavour_nispac.5
	title = flavour_nispac.5.t
	desc = flavour_nispac.5.d
	picture = COLONIZATION_eventPicture

	is_triggered_only = yes
	trigger = { }
	hidden = yes

	option = {
		name = flavour_nispac.5.a

		random_subject_country = {
			limit = {
				has_reform = N79_will_of_the_people_reform
			}
			save_event_target_as = CILA_WILL_OF_THE_PEOPLE_VASSAL
		}
		every_owned_province = {
			limit = {
				NOT = { 
					has_terrain = city_terrain
					province_id = 3669 #Imbetano
				}
			}
			cede_province = event_target:CILA_WILL_OF_THE_PEOPLE_VASSAL
		}
	}
}
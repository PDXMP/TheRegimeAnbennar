namespace = flavour_deranne

country_event = { #The Western Twilight
	id = flavour_deranne.1
	title = flavour_deranne.1.t
	desc = flavour_deranne.1.d
	picture = LILAC_WARS_eventPicture
	
	is_triggered_only = yes
	fire_only_once = yes
	
	trigger = {
		ai = no
		NOT = { is_year = 1445 }
		tag = A02
	}

	option = {
		name = flavour_deranne.1.a

		75 = {
			add_permanent_claim = ROOT
		}
		92 = {
			add_permanent_claim = ROOT 
		}
		set_estate_privilege = estate_nobles_deranne_rogue_vassal
		set_country_flag = deranne_rogue_vassal_flag
	}
}

country_event = { #Reverie of Retribution
	id = flavour_deranne.2
	title = flavour_deranne.2.t
	desc = flavour_deranne.2.d
	picture = {
		trigger = {
			NOT = { has_dlc = "Lions of the North" }
		}
		picture = LAND_MILITARY_eventPicture
	}
	picture = {
		trigger = {
			has_dlc = "Lions of the North"
		}
		picture = KNIGHTS_eventPicture
	}
	
	is_triggered_only = yes
	fire_only_once = yes
	
	option = {
		name = flavour_deranne.2.a

		remove_country_modifier = deranne_the_final_swing
		upper_bloodwine_area = {
			limit = { 
				owned_by = A02 
				NOT = { province_id = 67 }
			}
			add_devastation = 50
		}
		67 = { 
			add_devastation = 80
			add_base_tax = -3
			add_base_production = -3
			add_base_manpower = -3
		}
		add_treasury = 600
		country_event = {
			id = flavour_deranne.3
			days = 365
		}
	}
}

country_event = { #A Crown Among Ruins
	id = flavour_deranne.3
	title = flavour_deranne.3.t
	desc = flavour_deranne.3.d
	picture = DIPLOMACY_eventPicture
	
	is_triggered_only = yes
	fire_only_once = yes
	
	option = {
		name = flavour_deranne.3.a

		lencenor_region = {
			add_permanent_claim = ROOT
		}
		add_country_modifier = {
			name = deranne_a_new_spring
			duration = 14600
		}
		remove_estate_privilege = estate_nobles_deranne_rogue_vassal
		clr_country_flag = deranne_rogue_vassal_flag
		country_event = {
			id = flavour_deranne.4
			days = 730
		}
	}
}

country_event = { #A Question of Legitimacy
	id = flavour_deranne.4
	title = flavour_deranne.4.t
	desc = flavour_deranne.4.d
	picture = DIPLOMACY_eventPicture
	
	is_triggered_only = yes
	fire_only_once = yes
	
	option = {
		name = flavour_deranne.4.a

		add_legitimacy = -20
		custom_tooltip = deranne_question_of_legitimacy.tt
		hidden_effect = {
			if = {
				limit = { ai = no }
				set_estate_privilege = estate_nobles_deranne_lorentish_resistance
				set_country_flag = deranne_lorentish_resistance_flag_1
			}
		}
	}
}

country_event = { #An Offer of Prosperity (Redglades)
	id = flavour_deranne.5
	title = flavour_deranne.5.t
	desc = flavour_deranne.5.d
	picture = DIPLOMACY_eventPicture
	
	is_triggered_only = yes
	fire_only_once = yes
	
	option = { #Sure
		name = flavour_deranne.5.a
		ai_chance = { factor = 1 }
		A02 = {
			create_march = A03
		}
	}

	option = { #How silly
		name = flavour_deranne.5.b
		ai_chance = { factor = 0 }
		A02 = {
			add_casus_belli = {
				type = cb_vassalize_mission
				target = A03
				months = 240
			}
		}
	}
	
}

country_event = { #Dealing with the Sorncosti
	id = flavour_deranne.6
	title = flavour_deranne.6.t
	desc = flavour_deranne.6.d
	picture = DIPLOMACY_eventPicture
	
	is_triggered_only = yes
	fire_only_once = yes
	
	option = {
		name = flavour_deranne.6.a

		anb_add_accepted_culture_or_dip_power = { culture = sorncosti free = yes } 
		custom_tooltip = deranne_dealing_with_sorncost.tt
		hidden_effect = {
			every_owned_province = {
				limit = {
					culture = sorncosti 
					trade_goods = wine
				}
				add_province_modifier = {
					name = deranne_sorncosti_wines
					duration = 3650
				}
				add_devastation = -50
			}
		}
	}

	option = {
		name = flavour_deranne.6.b

		85 = {
			add_base_tax = -2
			add_base_production = -2
			add_base_manpower = -2
			add_devastation = 75
		}
		88 = {
			add_base_tax = -2
			add_base_production = -2
			add_base_manpower = -2
			add_devastation = 75
		}
		112 = {
			add_base_tax = 1
			add_base_production = 1
			add_base_manpower = 1
		}
		add_treasury = 350
		every_owned_province = {
			limit = { culture = sorncosti }
			add_province_modifier = {
				name = deranne_sorncost_unrest
				duration = 3650
			}
		}
	}
}

country_event = { #To Kneel
	id = flavour_deranne.7
	title = flavour_deranne.7.t
	desc = flavour_deranne.7.d
	picture = DIPLOMACY_eventPicture
	
	is_triggered_only = yes
	fire_only_once = yes
	
	option = { #Keep a tight leash
		name = flavour_deranne.7.a
		ai_chance = { factor = 1 }

		custom_tooltip = deranne_greatest_nuisance.tt_1
		add_estate_loyalty = {
			estate = estate_nobles
			loyalty = -15
		}
		add_estate_influence_modifier = {
			estate = estate_nobles
			influence = -15
			duration = 5475
		}
		custom_tooltip = deranne_greatest_nuisance.tt_2
		hidden_effect = {
			if = {
				limit = { ai = no }
				remove_estate_privilege	= estate_nobles_deranne_lorentish_resistance
				set_estate_privilege = estate_nobles_deranne_lorentish_resistance_2
				set_country_flag = deranne_lorentish_resistance_flag_2
				clr_country_flag = deranne_lorentish_resistance_flag_1
			}
			every_owned_province = {
				limit = { culture = high_lorentish }
				add_local_autonomy = -10
				remove_province_modifier = deranne_lorentish_resistance
			}
		}
		add_stability_or_adm_power = yes
	}

	option = { #Reign Them In
		name = flavour_deranne.7.b
		ai_chance = { factor = 0 }

		add_estate_loyalty = {
			estate = estate_nobles
			loyalty = -30
		}
		add_estate_influence_modifier = {
			estate = estate_nobles
			influence = -30
			duration = 5475
		}
		remove_estate_privilege	= estate_nobles_deranne_lorentish_resistance
		clr_country_flag = deranne_lorentish_resistance_flag_1
		every_owned_province = {
			limit = { culture = high_lorentish }
			add_local_autonomy = -20
			remove_province_modifier = deranne_lorentish_resistance
		}
		add_stability = -1
		random_owned_province = {
			limit = { culture = high_lorentish }
			spawn_rebels = {
				type = noble_rebels
				size = 3
			}
		}
		random_owned_province = {
			limit = { culture = high_lorentish }
			spawn_rebels = {
				type = noble_rebels
				size = 3
			}
		}
		random_owned_province = {
			limit = { culture = high_lorentish }
			spawn_rebels = {
				type = noble_rebels
				size = 3
			}
		}
		random_owned_province = {
			limit = { culture = high_lorentish }
			spawn_rebels = {
				type = noble_rebels
				size = 3
			}
		}
	}
}

country_event = { #Coronation
	id = flavour_deranne.8
	title = flavour_deranne.8.t
	desc = flavour_deranne.8.d
	picture = DIPLOMACY_eventPicture
	
	is_triggered_only = yes
	fire_only_once = yes
	
	option = { 
		name = flavour_deranne.8.a

		increase_government_rank_scripted_effect = { rank = 2 }
		add_permanent_power_projection = {
            type = 10_permanent_power_projection
            amount = 10
        }
		add_prestige = 30
		add_estate_loyalty = {
			estate = all
			loyalty = 10
		}
	}
}

country_event = { #In Her Footsteps
	id = flavour_deranne.9
	title = flavour_deranne.9.t
	desc = flavour_deranne.9.d
	picture = DIPLOMACY_eventPicture
	
	is_triggered_only = yes
	fire_only_once = yes
	
	option = { #Continue on as Deranne
		name = flavour_deranne.9.a

		custom_tooltip = deranne_tale_enabled.tt
		lencenor_region = {
			limit = { owned_by = A02 }
			add_province_modifier = {
				name = deranne_triumph_of_the_seaflower
				duration = 3650
			}
		}
		add_ruler_modifier = {
			name = deranne_spirit_of_derhilde
			duration = -1
		}
		set_country_flag = deranne_own_path
		custom_tooltip = deranne_disable_lorent_event.tt
		swap_non_generic_missions = yes
	}
}

country_event = { #Gateway to the West
	id = flavour_deranne.10
	title = flavour_deranne.10.t
	desc = flavour_deranne.10.d
	picture = DIPLOMACY_eventPicture
	
	is_triggered_only = yes
	fire_only_once = yes
	
	option = { 
		name = flavour_deranne.10.a

		112 = { #Westport
			add_province_modifier = {
				name = deranne_gateway_west
				duration = -1
			}
			add_base_tax = 1
			add_base_production = 1
			add_base_manpower = 1
		}
	}
}

country_event = { #A Thundering Entrance
	id = flavour_deranne.11
	title = flavour_deranne.11.t
	desc = flavour_deranne.11.d
	picture = DIPLOMACY_eventPicture
	
	is_triggered_only = yes
	fire_only_once = yes
	
	option = { 
		name = flavour_deranne.11.a

		1035 = { #Port Isobel
			owner = {
				add_opinion = {
					who = A02
					modifier = A02_generous_trading 
				}
			}
		}
		add_country_modifier = {
			name = deranne_arrival_in_trollsbay
			duration = 3650
		}
		trollsbay_region = {
			add_permanent_claim = ROOT
		}
	}
}

country_event = { #Establlishment of the DTC
	id = flavour_deranne.12
	title = flavour_deranne.12.t
	desc = flavour_deranne.12.d
	picture = DIPLOMACY_eventPicture
	
	is_triggered_only = yes
	fire_only_once = yes
	
	option = { 
		name = flavour_deranne.12.a

		custom_tooltip = deranne_dtc_established.tt
		set_country_flag = A02_dtc_established
		add_country_modifier = {
			name = deranne_great_antipathy
			duration = -1
		}
		custom_tooltip = deranne_tale_enabled.tt
	}
}

country_event = { #The Land of Ancient Empires
	id = flavour_deranne.13
	title = flavour_deranne.13.t
	desc = flavour_deranne.13.d
	picture = DIPLOMACY_eventPicture
	
	is_triggered_only = yes
	fire_only_once = yes
	
	option = { 
		name = flavour_deranne.13.a
		
		dao_nako_region = {
			add_permanent_claim = ROOT
		}
		bavabetsaro_area = {
			add_permanent_claim = ROOT
		}
		tanfandoro_area = {
			add_permanent_claim = ROOT
		}
		nafalofimapo_area = {
			add_permanent_claim = ROOT
		}
		5710 = { #Kunolo
			add_permanent_province_modifier = {
				name = deranne_dtc_establishment 
				duration = -1
			}
		}
		5763 = { #New Hooksfield
			add_permanent_province_modifier = {
				name = deranne_dtc_establishment 
				duration = -1
			}
		}
	}
}

country_event = { #The Sisterhood
	id = flavour_deranne.14
	title = flavour_deranne.14.t
	desc = flavour_deranne.14.d
	picture = DIPLOMACY_eventPicture
	
	is_triggered_only = yes
	fire_only_once = yes
	
	option = { 
		name = flavour_deranne.14.a

		custom_tooltip = deranne_sisterhood.tt
		hidden_effect = {
			every_owned_province = {
				limit = { 
					region = fahvanosy_region
					NOT = {
						area = sil_berkhens_land_area
						area = far_uelos_isles_area
					}
				}
				add_province_modifier = {
					name = deranne_influence_sisterhood
					duration = -1
				}
			}
			country_event = {
				id = flavour_deranne.15
				days = 1825
			}
		}
	}
}

country_event = { #The Priestess's Ultimatum
	id = flavour_deranne.15
	title = flavour_deranne.15.t
	desc = flavour_deranne.15.d
	picture = DIPLOMACY_eventPicture
	
	is_triggered_only = yes
	fire_only_once = yes
	
	option = { #Accept Her Demands
		name = flavour_deranne.15.a
		
		set_country_flag = deranne_agreed_priestess_flag
		custom_tooltip = deranne_agreed_priestess_ultimatum.tt
		hidden_effect = {
			fahvanosy_region = {
				remove_province_modifier = deranne_influence_sisterhood
			}
		}
		small_increase_of_halfling_tolerance_effect = yes
		add_estate_loyalty = {
			estate = estate_burghers
			loyalty = -20
		}
	}
	
	option = { #Compromise
		name = flavour_deranne.15.b

		hidden_effect = {
			fahvanosy_region = {
				remove_province_modifier = deranne_influence_sisterhood
			}
			set_estate_privilege = estate_burghers_deranne_compromise_with_priestess
		}
		custom_tooltip = deranne_compromise_priestess.tt
		set_country_flag = deranne_compromise_flag
		add_estate_loyalty = {
			estate = estate_burghers
			loyalty = -10
		}
	}

	option = { #NOTHING STANDS IN THE WAY OF PROFIT
		name = flavour_deranne.15.c

		custom_tooltip = deranne_deny_priestess.tt
		hidden_effect = {
			every_owned_province = {
				limit = { region = fahvanosy_region }
				remove_province_modifier = deranne_influence_sisterhood
				add_province_modifier = {
					name = deranne_war_fahvanosy
					duration = 5475
				}
			}
		}
		random_owned_province = {
			limit = { region = fahvanosy_region }
			spawn_rebels = {
				type = nationalist_rebels
				size = 4
			}
		}
		random_owned_province = {
			limit = { region = fahvanosy_region }
			spawn_rebels = {
				type = nationalist_rebels
				size = 4
			}
		}
		random_owned_province = {
			limit = { region = fahvanosy_region }
			spawn_rebels = {
				type = nationalist_rebels
				size = 4
			}
		}
		random_owned_province = {
			limit = { region = fahvanosy_region }
			spawn_rebels = {
				type = nationalist_rebels
				size = 4
			}
		}
		random_owned_province = {
			limit = { region = fahvanosy_region }
			spawn_rebels = {
				type = nationalist_rebels
				size = 4
			}
		}
		random_owned_province = {
			limit = { region = fahvanosy_region }
			spawn_rebels = {
				type = nationalist_rebels
				size = 4
			}
		}
		random_owned_province = {
			limit = { region = fahvanosy_region }
			spawn_rebels = {
				type = nationalist_rebels
				size = 4
			}
		}
		random_owned_province = {
			limit = { region = fahvanosy_region }
			spawn_rebels = {
				type = nationalist_rebels
				size = 4
			}
		}
		random_owned_province = {
			limit = { region = fahvanosy_region }
			spawn_rebels = {
				type = nationalist_rebels
				size = 4
			}
		}
		random_owned_province = {
			limit = { region = fahvanosy_region }
			spawn_rebels = {
				type = nationalist_rebels
				size = 4
			}
		}
		large_decrease_of_halfling_tolerance_effect = yes
		add_estate_loyalty = {
			estate = estate_burghers
			loyalty = 5
		}
	}
}

country_event = { #Final Behemoth Invention
	id = flavour_deranne.17
	title = flavour_deranne.17.t
	desc = flavour_deranne.17.d
	picture = DIPLOMACY_eventPicture
	
	is_triggered_only = yes
	fire_only_once = yes
	
	option = { 
		name = flavour_deranne.17.a

		set_country_flag = deranne_greatest_behemoth_enabled_flag
		custom_tooltip = deranne_final_invention.tt
	}
}

country_event = { #The Greatest Tale
	id = flavour_deranne.18
	title = flavour_deranne.18.t
	desc = flavour_deranne.18.d
	picture = DIPLOMACY_eventPicture
	
	is_triggered_only = yes
	fire_only_once = yes
	
	option = { 
		name = flavour_deranne.18.a

		custom_tooltip = deranne_upgraded_tales.tt
		set_country_flag = deranne_tale_upgrade
		remove_country_modifier = deranne_great_antipathy
		add_country_modifier = {
			name = deranne_captain_of_seas
			duration = -1
		}
		custom_tooltip = rosande_golden_age.tt
		if = {
			limit = { has_had_golden_age = yes } 
			reset_golden_age = yes 
		}
		else_if = {
			limit = { in_golden_age = yes } 
			extend_golden_age = 600
		}
	}
}

country_event = { #Deranne Tales
	id = flavour_deranne.19
	title = flavour_deranne.19.t
	desc = flavour_deranne.19.desc
	picture = DIPLOMACY_eventPicture
	
	is_triggered_only = yes
	
	option = { #Go Back
		name = flavour_deranne.19.a
		highlight = yes
	}

	option = { # Derhilde's Tale
		name = flavour_deranne.19.b

		custom_tooltip = deranne_derhilde_tale.tt
		if = {
			limit = { has_country_flag = deranne_tale_upgrade }
			add_country_modifier = {
				name = deranne_derhilde_tale_modifier_upgrade
				duration = 1825
			}
			hidden_effect = {
				add_country_modifier = {
					name = deranne_tales_cooldown_modifier
					hidden = yes
					duration = 1825
				}
			}
		}
		else = {
			add_country_modifier = {
				name = deranne_derhilde_tale_modifier
				duration = 1825
			}
			hidden_effect = {
				add_country_modifier = {
					name = deranne_tales_cooldown_modifier
					hidden = yes
					duration = 3650
				}
			}
		}
	}

	option = { # Lilac Wars Tale
		name = flavour_deranne.19.c

		custom_tooltip = deranne_lilac_war_tale.tt
		if = {
			limit = { has_country_flag = deranne_tale_upgrade }
			add_country_modifier = {
				name = deranne_lilac_wars_tale_modifier_upgrade
				duration = 1825
			}
			hidden_effect = {
				add_country_modifier = {
					name = deranne_tales_cooldown_modifier
					hidden = yes
					duration = 1825
				}
			}
		}
		else = {
			add_country_modifier = {
				name = deranne_lilac_wars_tale_modifier 
				duration = 1825
			}
			hidden_effect = {
				add_country_modifier = {
					name = deranne_tales_cooldown_modifier
					hidden = yes
					duration = 3650
				}
			}
		}
	}

	option = { # DTC Tale
		name = flavour_deranne.19.d

		trigger = {
			has_country_flag = A02_dtc_established
		}

		custom_tooltip = deranne_dtc_tale.tt
		if = {
			limit = { has_country_flag = deranne_tale_upgrade }
			add_country_modifier = {
				name = deranne_dtc_tale_modifier_upgrade
				duration = 1825
			}
			hidden_effect = {
				add_country_modifier = {
					name = deranne_tales_cooldown_modifier
					hidden = yes
					duration = 1825
				}
			}
		}
		else = {
			add_country_modifier = {
				name = deranne_dtc_tale_modifier
				duration = 1825
			}
			hidden_effect = {
				add_country_modifier = {
					name = deranne_tales_cooldown_modifier
					hidden = yes
					duration = 3650
				}
			}
		}
	}

	option = { # Withered Roses Tale
		name = flavour_deranne.19.e

		trigger = {
			mission_completed = deranne_derhildes_will
		}

		custom_tooltip = deranne_withered_roses_tale.tt
		if = {
			limit = { has_country_flag = deranne_tale_upgrade }
			add_country_modifier = {
				name = deranne_withered_roses_tale_modifier_upgrade
				duration = 1825
			}
			hidden_effect = {
				add_country_modifier = {
					name = deranne_tales_cooldown_modifier
					hidden = yes
					duration = 1825
				}
			}
		}
		else = {
			add_country_modifier = {
				name = deranne_withered_roses_tale_modifier
				duration = 1825
			}
			hidden_effect = {
				add_country_modifier = {
					name = deranne_tales_cooldown_modifier
					hidden = yes
					duration = 3650
				}
			}
			
		}
	}

	option = { # Rosepeace Tale
		name = flavour_deranne.19.g

		trigger = {
			mission_completed = deranne_seaflower_blossom
		}

		custom_tooltip = deranne_rosepeace_tale.tt
		if = {
			limit = { has_country_flag = deranne_tale_upgrade }
			add_country_modifier = {
				name = deranne_rosepeace_tale_modifier_upgrade 
				duration = 1825
			}
			hidden_effect = {
				add_country_modifier = {
					name = deranne_tales_cooldown_modifier
					hidden = yes
					duration = 1825
				}
			}
		}
		else = {
			add_country_modifier = {
				name = deranne_rosepeace_tale_modifier
				duration = 1825
			}
			hidden_effect = {
				add_country_modifier = {
					name = deranne_tales_cooldown_modifier
					hidden = yes
					duration = 3650
				}
			}
		}
	}

	option = { # Westport Tale
		name = flavour_deranne.19.h

		trigger = {
			mission_completed = deranne_center_of_three_worlds
		}

		custom_tooltip = deranne_westport_tale.tt
		if = {
			limit = { has_country_flag = deranne_tale_upgrade }
			add_country_modifier = {
				name = deranne_westport_tale_modifier_upgrade
				duration = 1825
			}
			hidden_effect = {
				add_country_modifier = {
					name = deranne_tales_cooldown_modifier
					hidden = yes
					duration = 1825
				}
			}
		}
		else = {
			add_country_modifier = {
				name = deranne_westport_tale_modifier
				duration = 1825
			}
			hidden_effect = {
				add_country_modifier = {
					name = deranne_tales_cooldown_modifier
					hidden = yes
					duration = 3650
				}
			}
		}
	}
}

country_event = { #Dominance in Aelantir
	id = flavour_deranne.20
	title = flavour_deranne.20.t
	desc = flavour_deranne.20.desc
	picture = DIPLOMACY_eventPicture
	
	is_triggered_only = yes
	fire_only_once = yes
	
	option = { 
		name = flavour_deranne.20.a
		highlight = yes
		custom_tooltip = deranne_dominance_privileges.tt
		set_estate_privilege = deranne_estate_burghers_dtc_dominance_aelantir
	}
}

country_event = { #Dominance in Sarhal
	id = flavour_deranne.21
	title = flavour_deranne.21.t
	desc = flavour_deranne.21.desc
	picture = DIPLOMACY_eventPicture
	
	is_triggered_only = yes
	fire_only_once = yes
	
	option = { 
		name = flavour_deranne.20.a
		highlight = yes
		custom_tooltip = deranne_dominance_privileges.tt
		set_estate_privilege = deranne_estate_burghers_dtc_dominance_sarhal
	}
}


country_event = { #Investing in the Ynnic dams
	id = flavour_deranne.23
	title = flavour_deranne.23.t
	desc = flavour_deranne.23.desc
	picture = DIPLOMACY_eventPicture
	
	is_triggered_only = yes

	option = {
		name = flavour_deranne.23.a
		clr_country_flag = deranne_dtc_menu_open
	}

	option = { # Adbrabohvi
		name = flavour_deranne.23.b
		trigger = {
			hidden_trigger = {
				NOT = {
					deranne_ynnic_dam_upgrade_check = {
						province_id = 1133
						dam_name = ynnic_dam_adbrabohvi
					}
				}
			}
		}
		custom_tooltip = deranne_dam_trigger.tt
		custom_tooltip = deranne_dam.tt
		tooltip = {
			if = {
				limit = {
					1133 = {
						has_great_project = {
							type = ynnic_dam_adbrabohvi
							tier = 2
						}
					}
				}
				add_treasury = -5000
			}
			else_if = {
				limit = {
					1133 = {
						has_great_project = {
							type = ynnic_dam_adbrabohvi
							tier = 1
						}
					}
				}
				add_treasury = -2500
			}
			else = {
				add_treasury = -1000
			}
		}
		hidden_effect = {
			country_event = {
				id = flavour_deranne.29
			}
		}
	}

	option = { # Adbrabohvi
		name = flavour_deranne.23.c
		highlight = yes
		trigger = {
			hidden_trigger = {
				deranne_ynnic_dam_upgrade_check = {
					province_id = 1133
					dam_name = ynnic_dam_adbrabohvi
				}
			}
		}
		custom_tooltip = deranne_dam_trigger.tt
		custom_tooltip = deranne_dam.tt
		if = {
			limit = {
				1133 = {
					has_great_project = {
						type = ynnic_dam_adbrabohvi
						tier = 2
					}
				}
			}
			add_treasury = -5000
		}
		else_if = {
			limit = {
				1133 = {
					has_great_project = {
						type = ynnic_dam_adbrabohvi
						tier = 1
					}
				}
			}
			add_treasury = -2500
		}
		else = {
			add_treasury = -1000
		}

		hidden_effect = {
			1133 = {
				set_province_flag = deranne_dam_construction_flag 
			}
		}
		country_event = {
			id = flavour_deranne.24
			days = 1825
		}
		clr_country_flag = deranne_dtc_menu_open
	}
	option = { # Vels Bacar
		name = flavour_deranne.23.d
		trigger = {
			hidden_trigger = {
				NOT = {
					deranne_ynnic_dam_upgrade_check = {
						province_id = 1138
						dam_name = ynnic_dam_vels_bacar
					}
				}
			}
		}
		tooltip = {
			if = {
				limit = {
					1138 = {
						has_great_project = {
							type = ynnic_dam_vels_bacar
							tier = 2
						}
					}
				}
				add_treasury = -5000
			}
			else_if = {
				limit = {
					1138 = {
						has_great_project = {
							type = ynnic_dam_vels_bacar
							tier = 1
						}
					}
				}
				add_treasury = -2500
			}
			else = {
				add_treasury = -1000
			}
		}
		custom_tooltip = deranne_dam_trigger.tt_2
		custom_tooltip = deranne_dam.tt
		hidden_effect = {
			country_event = {
				id = flavour_deranne.29
			}
		}
	}

	option = { # Vels Bacar
		name = flavour_deranne.23.e
		highlight = yes
		trigger = {
			hidden_trigger = {
				deranne_ynnic_dam_upgrade_check = {
					province_id = 1138
					dam_name = ynnic_dam_vels_bacar
				}
			}
		}
		custom_tooltip = deranne_dam_trigger.tt_2
		custom_tooltip = deranne_dam.tt
		
		if = {
			limit = {
				1138 = {
					has_great_project = {
						type = ynnic_dam_vels_bacar
						tier = 2
					}
				}
			}
			add_treasury = -5000
		}
		else_if = {
			limit = {
				1138 = {
					has_great_project = {
						type = ynnic_dam_vels_bacar
						tier = 1
					}
				}
			}
			add_treasury = -2500
		}
		else = {
			add_treasury = -1000
		}

		hidden_effect = {
			1138 = {
				set_province_flag = deranne_dam_construction_flag 
			}
		}
		country_event = {
			id = flavour_deranne.25
			days = 1825
		}
		clr_country_flag = deranne_dtc_menu_open
	}
	option = { # Bosancovac
		name = flavour_deranne.23.f
		trigger = {
			hidden_trigger = {
				NOT = {
					deranne_ynnic_dam_upgrade_check = {
						province_id = 1165
						dam_name = ynnic_dam_bosancovac
					}
				}
			}
		}
		tooltip = {
			if = {
				limit = {
					1165 = {
						has_great_project = {
							type = ynnic_dam_bosancovac
							tier = 2
						}
					}
				}
				add_treasury = -5000
			}
			else_if = {
				limit = {
					1165 = {
						has_great_project = {
							type = ynnic_dam_bosancovac
							tier = 1
						}
					}
				}
				add_treasury = -2500
			}
			else = {
				add_treasury = -1000
			}
		}
		custom_tooltip = deranne_dam_trigger.tt_3
		custom_tooltip = deranne_dam.tt
		hidden_effect = {
			country_event = {
				id = flavour_deranne.29
			}
		}
	}

	option = { # Bosancovac
		name = flavour_deranne.23.g
		highlight = yes
		trigger = {
			hidden_trigger = {
				deranne_ynnic_dam_upgrade_check = {
					province_id = 1165
					dam_name = ynnic_dam_bosancovac
				}
			}
		}
		custom_tooltip = deranne_dam_trigger.tt_3
		custom_tooltip = deranne_dam.tt
		if = {
			limit = {
				1165 = {
					has_great_project = {
						type = ynnic_dam_bosancovac
						tier = 2
					}
				}
			}
			add_treasury = -5000
		}
		else_if = {
			limit = {
				1165 = {
					has_great_project = {
						type = ynnic_dam_bosancovac
						tier = 1
					}
				}
			}
			add_treasury = -2500
		}
		else = {
			add_treasury = -1000
		}

		hidden_effect = {
			1165 = {
				set_province_flag = deranne_dam_construction_flag 
			}
		}
		country_event = {
			id = flavour_deranne.26
			days = 1825
		}
		clr_country_flag = deranne_dtc_menu_open
	}
	option = { # Mocbarja
		name = flavour_deranne.23.h
		trigger = {
			hidden_trigger = {
				NOT = {
					deranne_ynnic_dam_upgrade_check = {
						province_id = 1186
						dam_name = ynnic_dam_mocbarja
					}
				}
			}
		}
		tooltip = {
			if = {
				limit = {
					1186 = {
						has_great_project = {
							type = ynnic_dam_mocbarja
							tier = 2
						}
					}
				}
				add_treasury = -5000
			}
			else_if = {
				limit = {
					1186 = {
						has_great_project = {
							type = ynnic_dam_mocbarja
							tier = 1
						}
					}
				}
				add_treasury = -2500
			}
			else = {
				add_treasury = -1000
			}
		}
		custom_tooltip = deranne_dam_trigger.tt_4
		custom_tooltip = deranne_dam.tt
		hidden_effect = {
			country_event = {
				id = flavour_deranne.29
			}
		}
	}

	option = { # Mocbarja
		name = flavour_deranne.23.i
		highlight = yes
		trigger = {
			hidden_trigger = {
				deranne_ynnic_dam_upgrade_check = {
					province_id = 1186
					dam_name = ynnic_dam_mocbarja
				}
			}
		}
		custom_tooltip = deranne_dam_trigger.tt_4
		custom_tooltip = deranne_dam.tt
		if = {
			limit = {
				1186 = {
					has_great_project = {
						type = ynnic_dam_mocbarja
						tier = 2
					}
				}
			}
			add_treasury = -5000
		}
		else_if = {
			limit = {
				1186 = {
					has_great_project = {
						type = ynnic_dam_mocbarja
						tier = 1
					}
				}
			}
			add_treasury = -2500
		}
		else = {
			add_treasury = -1000
		}

		hidden_effect = {
			1186 = {
				set_province_flag = deranne_dam_construction_flag 
			}
		}
		country_event = {
			id = flavour_deranne.27
			days = 1825
		}
		clr_country_flag = deranne_dtc_menu_open
	}
}

country_event = { #Dam Upgrade - Adbrabohvi
	id = flavour_deranne.24
	title = flavour_deranne.24.t
	desc = flavour_deranne.24.d
	picture = DIPLOMACY_eventPicture
	
	is_triggered_only = yes
	
	option = {
		name = flavour_deranne.24.a

		deranne_upgrade_dam_scripted_effect = {
			province_id = 1133
			dam_name = ynnic_dam_adbrabohvi
		}
		1133 = {
			add_trade_modifier = {
				who = ROOT
				duration = -1
				power = 25
				key = DERANNE_YNN_TRADE_SHARE
			}
		}
	}
}

country_event = { #Dam Upgrade - Vels bacar
	id = flavour_deranne.25
	title = flavour_deranne.25.t
	desc = flavour_deranne.25.d
	picture = DIPLOMACY_eventPicture
	
	is_triggered_only = yes
	
	option = {
		name = flavour_deranne.25.a
		
		deranne_upgrade_dam_scripted_effect = {
			province_id = 1138
			dam_name = ynnic_dam_vels_bacar
		}
		1133 = {
			add_trade_modifier = {
				who = ROOT
				duration = -1
				power = 25
				key = DERANNE_YNN_TRADE_SHARE
			}
		}
	}
}

country_event = { #Dam Upgrade - Bosancovac
	id = flavour_deranne.26
	title = flavour_deranne.26.t
	desc = flavour_deranne.26.d
	picture = DIPLOMACY_eventPicture
	
	is_triggered_only = yes
	
	option = {
		name = flavour_deranne.26.a

		deranne_upgrade_dam_scripted_effect = {
			province_id = 1165
			dam_name = ynnic_dam_bosancovac
		}
		1165 = {
			add_trade_modifier = {
				who = ROOT
				duration = -1
				power = 25
				key = DERANNE_YNN_TRADE_SHARE
			}
		}
	}
}

country_event = { #Dam Upgrade - Mocbarja
	id = flavour_deranne.27
	title = flavour_deranne.27.t
	desc = flavour_deranne.27.d
	picture = DIPLOMACY_eventPicture
	
	is_triggered_only = yes
	
	option = {
		name = flavour_deranne.27.a

		deranne_upgrade_dam_scripted_effect = {
			province_id = 1186
			dam_name = ynnic_dam_mocbarja
		}
		1165 = {
			add_trade_modifier = {
				who = ROOT
				duration = -1
				power = 25
				key = DERANNE_YNN_TRADE_SHARE
			}
		}
	}
}
		
country_event = { # Dam Repairs
	id = flavour_deranne.28
	title = flavour_deranne.28.t
	desc = flavour_deranne.28.d
	picture = DIPLOMACY_eventPicture
	
	is_triggered_only = yes
	hidden = yes

	trigger = {
		mission_completed = deranne_up_the_great_waterfall
	}
	
	option = {
		name = flavour_deranne.28.a

		if = {
			limit = {
				1133 = {
					OR = {
						AND = {
							has_province_flag = deranne_dam_tier_3_flag
							NOT = {
								has_great_project = {
									type = ynnic_dam_adbrabohvi
									tier = 3
								}
							}
						}
						AND = {
							has_province_flag = deranne_dam_tier_2_flag
							NOT = {
								has_great_project = {
									type = ynnic_dam_adbrabohvi
									tier = 2
								}
							}
						}
						AND = {
							has_province_flag = deranne_dam_tier_1_flag
							NOT = {
								has_great_project = {
									type = ynnic_dam_adbrabohvi
									tier = 1
								}
							}
						}
					}
				}
			}
			1133 = {
				add_great_project_tier = {
					type = ynnic_dam_adbrabohvi
					tier = 1
				}
			}
		}
		else_if = {
			limit = {
				1138 = {
					OR = {
						AND = {
							has_province_flag = deranne_dam_tier_3_flag
							NOT = {
								has_great_project = {
									type = ynnic_dam_vels_bacar
									tier = 3
								}
							}
						}
						AND = {
							has_province_flag = deranne_dam_tier_2_flag
							NOT = {
								has_great_project = {
									type = ynnic_dam_vels_bacar
									tier = 2
								}
							}
						}
						AND = {
							has_province_flag = deranne_dam_tier_1_flag
							NOT = {
								has_great_project = {
									type = ynnic_dam_vels_bacar
									tier = 1
								}
							}
						}
					}
				}
			}
			1138 = {
				add_great_project_tier = {
					type = ynnic_dam_vels_bacar
					tier = 1
				}
			}
		}
		else_if = {
			limit = {
				1165 = {
					OR = {
						AND = {
							has_province_flag = deranne_dam_tier_3_flag
							NOT = {
								has_great_project = {
									type = ynnic_dam_bosancovac
									tier = 3
								}
							}
						}
						AND = {
							has_province_flag = deranne_dam_tier_2_flag
							NOT = {
								has_great_project = {
									type = ynnic_dam_bosancovac
									tier = 2
								}
							}
						}
						AND = {
							has_province_flag = deranne_dam_tier_1_flag
							NOT = {
								has_great_project = {
									type = ynnic_dam_bosancovac
									tier = 1
								}
							}
						}
					}
				}
			}
			1165 = {
				add_great_project_tier = {
					type = ynnic_dam_bosancovac
					tier = 1
				}
			}
		}
		else_if = {
			limit = {
				1186 = {
					OR = {
						AND = {
							has_province_flag = deranne_dam_tier_3_flag
							NOT = {
								has_great_project = {
									type = ynnic_dam_mocbarja
									tier = 3
								}
							}
						}
						AND = {
							has_province_flag = deranne_dam_tier_2_flag
							NOT = {
								has_great_project = {
									type = ynnic_dam_mocbarja
									tier = 2
								}
							}
						}
						AND = {
							has_province_flag = deranne_dam_tier_1_flag
							NOT = {
								has_great_project = {
									type = ynnic_dam_mocbarja
									tier = 1
								}
							}
						}
					}
				}
			}
			1186 = {
				add_great_project_tier = {
					type = ynnic_dam_mocbarja
					tier = 1
				}
			}
		}
	}
}

country_event = { #Refire event
	id = flavour_deranne.29
	title = flavour_deranne.29.t
	desc = flavour_deranne.29.d
	picture = LILAC_WARS_eventPicture
	
	is_triggered_only = yes
	hidden = yes

	option = {
		name = flavour_deranne.29.a
		country_event = {
			id = flavour_deranne.23
		}
	}
}

country_event = { #Ruined Friendship
	id = flavour_deranne.31
	title = flavour_deranne.31.t
	desc = flavour_deranne.31.d
	picture = LILAC_WARS_eventPicture
	
	is_triggered_only = yes
	fire_only_once = yes

	option = {
		name = flavour_deranne.31.a
		1519 = { #Trollsbay
			remove_trade_modifier = {
				who = ROOT
				key = STRONG_MERCHANTS
			}
		}
		set_country_flag = deranne_trollsbay_ruined_friendship
	}
}

country_event = { #Last Huzzah of the Seaflower?? (Mercenary Shit)
	id = flavour_deranne.32
	title = flavour_deranne.32.t
	desc = flavour_deranne.32.d
	picture = DIPLOMACY_eventPicture
	
	is_triggered_only = yes
	fire_only_once = yes
	
	option = { 
		name = flavour_deranne.32.a

		custom_tooltip = deranne_disable_seaflowerknights.tt
		set_country_flag = deranne_disable_seaflowerknights
		add_country_modifier = {
			name = deranne_seaflower_admiralty
			duration = -1
		}
	}
}

province_event = { #Westport - Isobel Island institution friendship
	id = flavour_deranne.33
	title = flavour_deranne.33.t
	desc = flavour_deranne.33.d
	
	picture = PAINTER_ARTIST_eventPicture
	
	is_triggered_only = yes
	
	trigger = {
		OR = {
			AND = {
				OR = {
					112 = { printing_press = 100 }
					1036 = { printing_press = 100 }
				}
				NOT = { printing_press = 100 }
			}
			AND = {
				OR = {
					112 = { global_trade = 100 }
					1036 = { global_trade = 100 }
				}
				NOT = { global_trade = 100 }
			}
			AND = {
				OR = {
					112 = { manufactories = 100 }
					1036 = { manufactories = 100 }
				}
				NOT = { manufactories = 100 }
			}
			AND = {
				OR = {
					112 = { enlightenment = 100 }
					1036 = { enlightenment = 100 }
				}
				NOT = { enlightenment = 100 }
			}
			AND = {
				OR = {
					112 = { industrialization = 100 }
					1036 = { industrialization = 100 }
				}
				NOT = { industrialization = 100 }
			}
		}
	}

	immediate = {
		hidden_effect = {
			if = {
				limit = {
					OR = {
						112 = { printing_press = 100 }
						1036 = { printing_press = 100 }
					}
					NOT = {
						AND = {
							112 = { printing_press = 100 }
							1036 = { printing_press = 100 }
						}
					}
				}
				add_institution_embracement = {
					which = printing_press
					value = 100
				}
			}
			if = {
				limit = {
					OR = {
						112 = { global_trade = 100 }
						1036 = { global_trade = 100 }
					}
					NOT = {
						AND = {
							112 = { global_trade = 100 }
							1036 = { global_trade = 100 }
						}
					}
				}
				add_institution_embracement = {
					which = global_trade
					value = 100
				}
			}
			if = {
				limit = {
					OR = {
						112 = { manufactories = 100 }
						1036 = { manufactories = 100 }
					}
					NOT = {
						AND = {
							112 = { manufactories = 100 }
							1036 = { manufactories = 100 }
						}
					}
				}
				add_institution_embracement = {
					which = manufactories
					value = 100
				}
			}
			if = {
				limit = {
					OR = {
						112 = { enlightenment = 100 }
						1036 = { enlightenment = 100 }
					}
					NOT = {
						AND = {
							112 = { enlightenment = 100 }
							1036 = { enlightenment = 100 }
						}
					}
				}
				add_institution_embracement = {
					which = enlightenment
					value = 100
				}
			}
			if = {
				limit = {
					OR = {
						112 = { industrialization = 100 }
						1036 = { industrialization = 100 }
					}
					NOT = {
						AND = {
							112 = { industrialization = 100 }
							1036 = { industrialization = 100 }
						}
					}
				}
				add_institution_embracement = {
					which = industrialization
					value = 100
				}
			}
		}
	}

	option = {
		name = institution_events.100.a
		ai_chance = {
			factor = 1
		}
		custom_tooltip = deranne_westport_isobel_institution.tt
	}
}

country_event = { #Venail Colony Cleanup
	id = flavour_deranne.34
	title = flavour_deranne.34.t
	desc = flavour_deranne.34.d
	picture = DIPLOMACY_eventPicture
	
	is_triggered_only = yes
	fire_only_once = yes
	hidden = yes
	
	option = { 
		name = flavour_deranne.32.a

		every_known_country = {
			limit = { has_country_flag = deranne_integrate_venail_colony_flag }
			every_owned_province = {
				cede_province = ROOT
			}
		}
	}
}

# Gor Vazumbrog Mission Tree
# Design and most coding by Warsaw. Finished by Tritone
# Region review: Werdna & Auirus
# Content review: Everest
# Balance review: Archangel & Tators
# Localization by Werdna881
##################
######Part 1######
##################
gor_vazumbrog_1_1 = {
	slot = 1
	generic = no
	ai = yes
	has_country_shield = yes
	potential = { tag = I14 }

	gor_vazumbrog_bogig_vazumbrog = {
		icon = mission_magnificent_castle
		position = 1

		provinces_to_highlight = {
			province_id = 2884 #Dwarovrod[24]
		}

		trigger = {
			2884 = { #Dwarovrod[24]
				owned_by = ROOT
				is_core = ROOT
				province_has_current_tech_fort_trigger = yes
			}
			if = {
				limit = { has_dlc = "Domination" }
				has_estate_privilege = estate_nobles_development_of_castles
			}
			else = {
				capital_scope = { province_has_current_tech_fort_trigger = yes }
			}
			mil_power = 100
		}

		effect = {
			add_mil_power = -100

			custom_tooltip = " "
			custom_tooltip = GV_TT_BOGIG_VAZUMBROG_CITADEL
			hidden_effect = {
				gor_vazumbrog_build_citadel = { province = 2884 citadel = bogig_vazumbrog } #Dwarovrod[24]
				2884 = {
					change_province_name = "Bogig Vazumbrog"
					rename_capital = "Bogig Vazumbrog"
				}
			}

			custom_tooltip = " "
			if = {
				limit = { 2884 = { has_supply_depot = ROOT } } #Dwarovrod[24]
				custom_tooltip = GV_TT_BOGIG_VAZUMBROG_BONUS_YES
				hidden_effect = {
					2884 = {
						add_permanent_province_modifier = {
							name = gor_vazumbrog_enlarged_barracks
							duration = -1
						}
					}
				}
			}
			else = {
				custom_tooltip = GV_TT_BOGIG_VAZUMBROG_BONUS_NO
			}
		}
	}

	gor_vazumbrog_logging_camp = {
		icon = mission_mnd_maj_prepare_eastern_campaigns
		required_missions = { gor_vazumbrog_forward_citadel }
		position = 3

		provinces_to_highlight = {
			OR = {
				AND = {
					province_group = deepwoods_shadow_grove
					NOT = { owned_by = ROOT }
				}
				AND = {
					province_id = 7024
					NOT = {
						AND = {
							province_has_current_tech_fort_trigger = yes
							has_building = ramparts
							has_supply_depot = ROOT
						}
					}
				}
			}
		}

		trigger = {
			deepwoods_shadow_grove = {
				type = all
				owned_by = ROOT
			}
			7024 = { #Ghulapriah
				province_has_current_tech_fort_trigger = yes
				has_building = ramparts
				has_supply_depot = ROOT
			}
		}

		effect = {
			custom_tooltip = GV_TT_DEEPWOODS_CITADEL
			hidden_effect = {
				gor_vazumbrog_build_citadel = { province = 7024 citadel = forest } #Ghulapriah
				7024 = {
					change_province_name = "Veigrthrun"
					rename_capital = "Veigrthrun"
				}
			}

			custom_tooltip = " "
			add_country_modifier = {
				name = gor_vazumbrog_building_material_influx
				duration = 5475
			}

			custom_tooltip = GV_TT_SHOCK_GENERAL
			hidden_effect = {
				create_general_with_current_tradition = {
					add_shock = 2
				}
			}

			custom_tooltip = " "
			custom_tooltip = GV_TT_UNLOCK_DEEPWOODS_HUNT
			set_country_flag = deepwoods_hunt_unlocked

			custom_tooltip = " "
			gor_vazumbrog_give_cb_for_hold = { #Verkal Skomdihr
				tag = I13
				province_id = 4100
			}
		}
	}
}

gor_vazumbrog_1_2 = {
	slot = 2
	generic = no
	ai = yes
	has_country_shield = yes
	potential = { tag = I14 }

	gor_vazumbrog_forward_citadel = {
		icon = byz_city_of_worlds_desire
		required_missions = { gor_vazumbrog_bogig_vazumbrog gor_vazumbrog_in_krummuls_steps }
		position = 2

		provinces_to_highlight = {
			OR = {
				AND = {
					OR = {
						province_id = 4102 #Azmak Quarry
						province_id = 4237 #Traveler's Refuge
						province_id = 2878 #Dwarovrod[17]
					}
					NOT = { owned_by = ROOT }
				}
				AND = {
					province_id = 2878 #Dwarovrod[17]
					NOT = {
						AND = {
							province_has_current_tech_fort_trigger = yes
							is_core = ROOT
							has_supply_depot = ROOT
						}
					}
				}
			}
		}

		trigger = {
			4102 = { owned_by = ROOT } #Azmak Quarry
			4237 = { owned_by = ROOT } #Traveler's Refuge
			2878 = { #Dwarovrod[17]
				owned_by = ROOT
				is_core = ROOT
				province_has_current_tech_fort_trigger = yes
				has_supply_depot = ROOT
			}
		}

		effect = {
			country_event_with_insight = {
				id = flavour_gor_vazumbrog.4
				insight_tooltip = gor_vazumbrog_forward_citadel_ct
			}

			custom_tooltip = " "
			if = {
				limit = { current_age = age_of_discovery }
				custom_tooltip = GV_TT_FIGHTING_BACK_MODIFIER_AGE_LIMITED
				hidden_effect = {
					add_country_modifier = {
						name = gor_vazumbrog_fighting_back
						duration = -1
					}
				}
			}
		}
	}

	gor_vazumbrog_secure_the_rails = {
		icon = mission_rail
		required_missions = { gor_vazumbrog_forward_citadel }
		position = 3

		provinces_to_highlight = {
			province_id = 2931
		}

		trigger = {
			custom_trigger_tooltip = {
				tooltip = GV_TT_FUNGRUM_DEALT_WITH
				2878 = { has_province_flag = citadel_province }
			}
			num_of_regiments_at_full_drill = 10
			2931 = { #Er-Natvir
				country_or_non_sovereign_subject_holds = ROOT
			}
		}

		effect = {
			add_country_modifier = {
				name = gor_vazumbrog_railyard_logistics
				duration = 9125
			}

			custom_tooltip = GV_TT_MANEUVER_GENERAL
			hidden_effect = {
				create_general_with_current_tradition = {
					add_manuever = 2
					culture = dagrite_dwarf
				}
			}

			custom_tooltip = " "
			gor_vazumbrog_give_cb_for_hold = { #Amldihr
				tag = I01
				province_id = 4119
			}
		}
	}

	gor_vazumbrog_legacy_of_aul_dwarov = {
		icon = mission_west_serpentspine_map
		required_missions = { gor_vazumbrog_secure_the_rails gor_vazumbrog_serpentspine_reclamation_force }
		position = 5

		provinces_to_highlight = {
			province_id = 4119
		}

		trigger = {
			4119 = { #Amldihr
				country_or_non_sovereign_subject_holds = ROOT
			}
			army_professionalism = 0.3
			estate_loyalty = {
				estate = estate_nobles
				loyalty = 60
			}
		}

		effect = {
			add_country_modifier = {
				name = gor_vazumbrog_legacy_of_rule
				duration = -1
			}
			custom_tooltip = GV_TT_UNLOCK_HOLY_ORDER_MIL

			custom_tooltip = " "
			custom_tooltip = GV_TT_CB_FOR_WEST_DWAROVAR
			hidden_effect = {
				gor_vazumbrog_give_cb_for_hold = { #Mithradhum
					tag = I05
					province_id = 4236
				}

				custom_tooltip = " "
				gor_vazumbrog_give_cb_for_hold = { #Orlazam-az-Dihr
					tag = I04
					province_id = 4147
				}

				custom_tooltip = " "
				gor_vazumbrog_give_cb_for_hold = { #Haraz Orldhum
					tag = I08
					province_id = 2868
				}
			}
		}
	}
}

gor_vazumbrog_1_3 = {
	slot = 3
	generic = no
	ai = yes
	has_country_shield = yes
	potential = { tag = I14 }

	gor_vazumbrog_in_krummuls_steps = {
		icon = mission_dwarf_close_up
		position = 1

		provinces_to_highlight = {
			OR = {
				area = dwarovrod_21_24_area
				area = vazumbrog_area
				area = dwarovrod_27_29_area
				area = hehos_legacy_area
				area = misty_cave_trail_area
				province_id = 2889 #Dwarovrod[30]
				province_id = 2890 #Dwarovrod[31]
				province_id = 2880 #Dwarovrod[19]
				province_id = 2881 #Dwarovrod[20]
				province_id = 2963 #Hul=Jorkad
			}
			owner = { culture_group = orcish }
		}

		trigger = {
			custom_trigger_tooltip = {
				tooltip = GV_TT_NO_ORCS_AROUND_VAZUMBROG
				NOT = {
					dwarovrod_21_24_area = { owner = { culture_group = orcish } }
					vazumbrog_area = { owner = { culture_group = orcish } }
					dwarovrod_27_29_area = { owner = { culture_group = orcish } }
					hehos_legacy_area = { owner = { culture_group = orcish } }
					misty_cave_trail_area = { owner = { culture_group = orcish } }
					2889 = { owner = { culture_group = orcish } }
					2890 = { owner = { culture_group = orcish } }
					2880 = { owner = { culture_group = orcish } }
					2881 = { owner = { culture_group = orcish } }
					2963 = { owner = { culture_group = orcish } }
				}
			}
		}

		effect = {
			country_event_with_insight = {
				id = flavour_gor_vazumbrog.1
				insight_tooltip = gor_vazumbrog_in_krummuls_steps_ct
			}
		}
	}

	gor_vazumbrog_hunters_gear = {
		icon = mission_cute_fella
		required_missions = { gor_vazumbrog_pest_control }
		position = 3

		provinces_to_highlight = {
			OR = {
				AND = {
					province_id = 2963 #Hul Jorkad
					ROOT = { NOT = { has_country_flag = ironweave_skitterers_hunt_completed } }
				}
				AND = {
					owned_by = ROOT
					OR = {
						trade_goods = iron
						trade_goods = mithril
					}
					ROOT = {
						NOT = {
							trade_goods_produced_amount = {
								trade_goods = iron
								amount = 8
							}
							trade_goods_produced_amount = {
								trade_goods = mithril
								amount = 2
							}
						}
					}
				}
			}
		}

		trigger = {
			custom_trigger_tooltip = {
				tooltip = GV_TT_IRONWEAVE_SKITTERERS_HUNT_COMPLETED
				has_country_flag = ironweave_skitterers_hunt_completed
			}
			OR = {
				trade_goods_produced_amount = {
					trade_goods = iron
					amount = 8
				}
				trade_goods_produced_amount = {
					trade_goods = mithril
					amount = 2
				}
			}
			OR = {
				innovativeness = 10
				mil_power = 100
			}
		}

		effect = {
			if = {
				limit = { NOT = { innovativeness = 10 } }
				add_mil_power = -100
			}
			custom_tooltip = GV_TT_UNLOCK_HOLY_ORDER_DIP
			custom_tooltip = " "
			custom_tooltip = GV_TT_DISABLE_POOR_UNIFORMS
			hidden_effect = {
				set_country_flag = no_more_poor_uniforms
			}
			custom_tooltip = " "
			custom_tooltip = GV_TT_UNLOCK_DISTANT_HUNT
		}
	}

	gor_vazumbrog_serpentspine_reclamation_force = {
		icon = per_sino_persians_relations
		required_missions = { gor_vazumbrog_hunters_gear }
		position = 4

		trigger = {
			custom_trigger_tooltip = {
				tooltip = GV_TT_REQUIRE_10_DIP_ORDER_PROVINCES
				check_variable = {
					which = gorVazumbrogDipOrderProvinces
					value = 10
				}
			}
			custom_trigger_tooltip = {
				tooltip = GV_TT_REQUIRE_3_COMPLETED_HUNTS
				check_variable = {
					which = gorVazumbrogHuntsCompleted
					value = 3
				}
			}

			has_estate_privilege = estate_adventurers_cavern_exploration_initiative
		}

		effect = {
			country_event_with_insight = {
				id = flavour_gor_vazumbrog.9
				insight_tooltip = gor_vazumbrog_serpentspine_reclamation_force_ct
			}
		}
	}

	gor_vazumbrog_our_legacy = {
		icon = mission_dwarf
		required_missions = { gor_vazumbrog_serpentspine_reclamation_force gor_vazumbrog_forgotten_art }
		position = 5

		trigger = {
			custom_trigger_tooltip = {
				tooltip = GV_TT_REQUIRE_6_COMPLETED_HUNTS
				check_variable = {
					which = gorVazumbrogHuntsCompleted
					value = 6
				}
			}
			if = {
				limit = {
					middle_dwarovar_region = {
						has_province_modifier = expedition_target 
					}
				}				
				custom_trigger_tooltip = {
					tooltip = GV_TT_REQUIRE_8_COMPLETED_EXPEDITIONS
					check_variable = {
						which = expeditions_completed_var
						value = 8
					}
				}
			}
			has_commanding_three_star = yes
		}

		effect = {
			country_event_with_insight = {
				id = flavour_gor_vazumbrog.10
				insight_tooltip = gor_vazumbrog_our_legacy_ct
			}
		}
	}

	gor_vazumbrog_the_future_is_bright = {
		icon = mission_forest_shrine
		required_missions = { gor_vazumbrog_legacy_of_aul_dwarov gor_vazumbrog_our_legacy gor_vazumbrog_legacy_of_segbandal gor_vazumbrog_hands_of_stone }
		position = 6

		trigger = {
			is_at_war = no
			stability = 2
			NOT = { average_autonomy = 25 }
			NOT = { num_of_rebel_armies = 1 }
		}

		effect = {
			add_power_projection = {
				type = mission_rewards_power_projection
				amount = 25
			}

			custom_tooltip = gor_vazumbrog_the_future_is_bright_fake_ct
			custom_tooltip = EVENT_INSIGHT_INTRO
			custom_tooltip = gor_vazumbrog_the_future_is_bright_ct

			hidden_effect = {
				country_event = { id = flavour_gor_vazumbrog.20 }
			}
		}
	}
}

gor_vazumbrog_1_4 = {
	slot = 4
	generic = no
	ai = yes
	has_country_shield = yes
	potential = { tag = I14 }

	gor_vazumbrog_pest_control = {
		icon = mission_thinking_king
		required_missions = { gor_vazumbrog_in_krummuls_steps gor_vazumbrog_refugees_no_more }
		position = 2

		provinces_to_highlight = {
			OR = {
				AND = {
					province_id = 4217 #Gor Vazumbrog
					ROOT = { NOT = { has_country_flag = drakons_hunt_completed } }
				}
				AND = {
					area = misty_cave_trail_area
					NOT = { owned_by = ROOT }
				}
				AND = {
					province_id = 4228 #Longtunnel
					OR = {
						NOT = { has_manpower_building_trigger = yes }
						NOT = { has_forcelimit_building_trigger = yes }
					}
				}
			}
		}

		trigger = {
			custom_trigger_tooltip = {
				tooltip = GV_TT_DRAKON_HUNT_COMPLETED
				has_country_flag = drakons_hunt_completed
			}
			misty_cave_trail_area = {
				type = all
				owned_by = ROOT
			}
			4228 = { #Longtunnel
				has_manpower_building_trigger = yes
				has_forcelimit_building_trigger = yes
			}
		}

		effect = {
			4228 = { #Longtunnel
				add_permanent_province_modifier = {
					name = gor_vazumbrog_drakon_hunting_grounds
					duration = -1
				}
			}

			custom_tooltip = GV_TT_SHOCK_MANEUVER_GENERAL
			hidden_effect = {
				create_general_with_current_tradition = {
					add_shock = 1
					add_manuever = 1
				}
			}
		}
	}

	gor_vazumbrog_shoulders_of_giants = {
		icon = mission_rb_control_electors
		required_missions = { gor_vazumbrog_pest_control }
		position = 3

		provinces_to_highlight = {
			OR = {
				AND = {
					area = hehos_legacy_area
					NOT = { owned_by = ROOT }
				}
				AND = {
					province_id = 4217 #Gor Vazumbrog
					has_province_modifier = expedition_target
				}
				AND = {
					province_id = 4214 #Hehogrim's Mausoleum
					has_province_modifier = expedition_target
				}
			}
		}

		trigger = {
			hehos_legacy_area = {
				type = all
				owned_by = ROOT
			}
			4217 = { #Gor Vazumbrog
				NOT = { has_province_modifier = expedition_target }
			}
			4214 = { #Hehogrim's Mausoleum
				NOT = { has_province_modifier = expedition_target }
			}
			custom_trigger_tooltip = {
				tooltip = no_expedition_happening_tooltip
				NOT = { has_country_flag = expedition_happening }
			}
		}

		effect = {
			if = {
				limit = {
					4217 = {
						NOT = { has_province_modifier = expedition_target }
						has_dwarovar_dungeon = no
					}
				}
				4217 = { #Gor Vazumbrog
					set_province_flag = gor_vazumbrog_krummuls_grave_expedition
					spawn_expedition = yes
					generate_expedition = { base_floor = 2 base_danger = 5 }
				}
			}
			else = {
				custom_tooltip = gor_vazumbrog_spawn_expedition_tt
				hidden_effect = {
					random_owned_province = {
						limit = {
							region = middle_dwarovar_region
							NOT = { has_province_modifier = expedition_target }
							has_dwarovar_dungeon = no
						}
						set_province_flag = gor_vazumbrog_krummuls_grave_expedition
						spawn_expedition = yes
						generate_expedition = { base_floor = 2 base_danger = 5 }
					}
				}
			}
			if = {
				limit = {
					4214 = {
						NOT = { has_province_modifier = expedition_target }
						has_dwarovar_dungeon = no
					}
				}
				4214 = { #Hehogrim's Mausoleum
					set_province_flag = gor_vazumbrog_hehos_grave_expedition
					spawn_expedition = yes
					generate_expedition = { base_floor = 3 base_danger = 3 }
				}
			}
			else = {
				custom_tooltip = gor_vazumbrog_spawn_hehos_grave_expedition_tt
				hidden_effect = {
					random_owned_province = {
						limit = {
							region = middle_dwarovar_region
							NOT = { has_province_modifier = expedition_target }
							has_dwarovar_dungeon = no
						}
						set_province_flag = gor_vazumbrog_hehos_grave_expedition
						spawn_expedition = yes
						generate_expedition = { base_floor = 3 base_danger = 3 }
					}
				}
			}
			custom_tooltip = GV_TT_KING_ON_PILGRIMAGE
			add_country_modifier = {
				name = gor_vazumbrog_king_on_pilgrimage
				duration = -1
			}
		}
	}

	gor_vazumbrog_forgotten_art = {
		icon = mission_machine
		required_missions = { gor_vazumbrog_shoulders_of_giants }
		position = 4

		provinces_to_highlight = {
			is_capital = yes
			owner = {
				culture_group = dwarven
				NOT = { has_reform = dwarovar_adventurer_reform }
				NOT = { has_90_opinion_improved_relation = { target = ROOT } }
			}
			NOT = { province_id = 4217 } #Gor Vazumbrog, don't point at us
		}

		trigger = {
			NOT = { has_country_modifier = gor_vazumbrog_king_on_pilgrimage }
			calc_true_if = {
				amount = 3
				all_known_country = {
					culture_group = dwarven
					NOT = { has_reform = dwarovar_adventurer_reform }
					has_90_opinion_improved_relation = { target = ROOT }
				}
			}
			OR = {
				innovativeness = 20
				adm_power = 100
			}
		}

		effect = {
			if = {
				limit = { NOT = { innovativeness = 20 } }
				add_adm_power = -100
			}
			country_event_with_insight = {
				id = flavour_gor_vazumbrog.11
				insight_tooltip = gor_vazumbrog_forgotten_art_ct
			}
		}
	}

	gor_vazumbrog_legacy_of_segbandal = {
		icon = strengthen_the_vroedschappen
		required_missions = { gor_vazumbrog_forgotten_art }
		position = 5

		provinces_to_highlight = {
			province_id = 4124
		}

		trigger = {
			owns_core_province = 4124 #Seghdihr
			OR = {
				accepted_culture = citrine_dwarf
				NOT = { any_owned_province = { culture = citrine_dwarf } }
			}
			trading_policy_in_node = {
				node = 4124 #Seghdihr/Middle Dwarovar
				policy = improve_inland_routes
			}
		}

		effect = {
			custom_tooltip = GV_TT_RESTORE_VAZUMBROG_SEGHDIHR_RAIL
			hidden_effect = {
				every_owned_province = {
					limit = {
						OR = {
							area = dwarovrod_27_29_area
							area = dwarovrod_30_32_area
							province_id = 4028 # Dwarovrod[26]
							province_id = 4027 # Dwarovrod[33]
							province_id = 4082 # Seghrod
						}
					}
					if = {
						limit = { has_province_modifier = dwarovar_rail }
						remove_province_modifier = dwarovar_rail
						add_permanent_province_modifier = { name = restored_rail duration = -1 }
					}
					else = {
						add_base_production = 2
					}
				}
			}
			custom_tooltip = " "

			if = {
				limit = {
					4124 = {
						num_of_buildings_in_province = 6
					}
				}
				custom_tooltip = GV_TT_SEGHDIHR_BUILDINGS_BONUS_YES
				hidden_effect = {
					4124 = {
						add_center_of_trade_level = 1
						add_or_upgrade_trade_building = yes
					}
				}
			}
			else = {
				custom_tooltip = GV_TT_SEGHDIHR_BUILDINGS_BONUS_NO
			}
		}
	}
}

gor_vazumbrog_1_5 = {
	slot = 5
	generic = no
	ai = yes
	has_country_shield = yes
	potential = { tag = I14 }

	gor_vazumbrog_refugees_no_more = {
		icon = mission_ghost_town
		position = 1

		provinces_to_highlight = {
			OR = {
				AND = {
					province_id = 4217 #Gor Vazumbrog
					NOT = { hold_condition = { Repaired = yes } }
				}
				province_id = 4124 #Seghdihr
			}
		}

		trigger = {
			4217 = { #Gor Vazumbrog
				hold_condition = { Repaired = yes }
			}
			OR = {
				H78 = { #Seghdihr
					has_spy_network_from = { who = ROOT value = 30 }
				}
				owns_or_subject_of = 4124 #Seghdihr hold
				H78 = { #Seghdihr
					has_opinion = { who = ROOT value = 150 }
					has_25_opinion_sent_gift = { target = ROOT }
				}
			}
		}

		effect = {
			country_event_with_insight = {
				id = flavour_gor_vazumbrog.2
				insight_tooltip = gor_vazumbrog_refugees_no_more_ct
			}
		}
	}

	gor_vazumbrog_into_the_wound = {
		icon = mission_burning_separation
		required_missions = { gor_vazumbrog_refugees_no_more gor_vazumbrog_pest_control }
		position = 3

		provinces_to_highlight = {
			province_id = 4217 #Gor Vazumbrog
		}

		trigger = {
			4217 = { development = 40 } #Gor Vazumbrog
            4217 = {
				num_of_units_in_province = {
					who = ROOT
					amount = 10
				}
			}
			has_leader_with = {
				total_pips = 10
				general = yes
				#is_monarch_leader = no
			}
		}

		effect = {
			hidden_effect = {
	            4217 = {
	                kill_units = {
						who = ROOT
						amount = 10
					}
	            }
			}

			country_event_with_insight = {
				id = flavour_gor_vazumbrog.203
				insight_tooltip = gor_vazumbrog_into_the_wound_ct
			}
			custom_tooltip = " "

			if = {
				limit = {
					trade_goods_produced_amount = {
						trade_goods = mithril
						amount = 3
					}
				}
				custom_tooltip = GV_TT_INTO_THE_WOUND_BONUS_YES
				hidden_effect = {
					set_country_flag = gor_vazumbrog_mithril_equipped_expedition
				}
			}
			else = {
				custom_tooltip = GV_TT_INTO_THE_WOUND_BONUS_NO
			}
		}
	}

	gor_vazumbrog_hands_of_stone = {
		icon = mission_erectors
		required_missions = { gor_vazumbrog_into_the_wound gor_vazumbrog_forgotten_art }
		position = 5

		provinces_to_highlight = {
			province_id = 4217 #Gor Vazumbrog
		}

		trigger = {
			4217 = {
				has_dwarven_hold_2 = yes
			}

			custom_trigger_tooltip = {
				tooltip = GV_TT_HOLD_HAS_MAGE_ESTATE_WARDS
				OR = {
					at_least_magic_project_level = { project = magical_fortress level = 1 } 
					4217 = {
						province_has_magical_ward = yes
					}
				}
			}

            estate_loyalty = {
                estate = estate_adventurers
                loyalty = 60
            }

			OR = {
				has_estate_privilege = estate_mages_invest_into_work_golem_facilites
				custom_trigger_tooltip = {
					tooltip = GV_TT_ALREADY_HAS_WORK_GOLEMS
					check_variable = {
						which = gorVazumbrogWorkGolemFacilities
						value = 1
					}
				}
			}
		}

		effect = {
			custom_tooltip = GV_TT_EARLY_VAULT_DELVES_UNLOCKED
			hidden_effect = {
				set_country_flag = aPUI_gor_vazumbrog_vault_enabled_flag
				set_variable = {
					which = gorVazumbrogVaultDelvesAvailable
					value = 3
				}
				set_variable = {
					which = gorVazumbrogVaultRelicsFound
					value = 0
				}
				set_variable = {
					which = gorVazumbrogVaultDelvesCompleted
					value = 0
				}
			}
		}
	}
}

##################
######Part 2######
##################

gor_vazumbrog_2_1 = {
	slot = 1
	generic = no
	ai = yes
	has_country_shield = yes
	potential = {
		tag = I14
		has_country_flag = gor_vazumbrog_mt_part_2
	}

	gor_vazumbrog_perfecting_our_defences = {
		icon = fortify_the_passes
		required_missions = { gor_vazumbrog_the_future_is_bright }
		position = 7

		provinces_to_highlight = {
			owned_by = ROOT
			continent = serpentspine
			any_neighbor_province = {
				NOT = { continent = serpentspine }
			}
			NOT = { province_has_current_tech_fort_trigger = yes }
		}

		trigger = {
			num_of_owned_provinces_with = {
				value = 6
				province_has_current_tech_fort_trigger = yes
				has_terrain = dwarven_road
			}
			num_of_owned_provinces_with = {
				value = 4
				province_has_current_tech_fort_trigger = yes
				continent = serpentspine
				any_neighbor_province = {
					NOT = { continent = serpentspine }
				}
			}
		}

		effect = {
			country_event = {
				id = flavour_gor_vazumbrog.31
			}

			custom_tooltip = " "
			if = {
				limit = {
					OR = {
						full_idea_group = defensive_ideas
						full_idea_group = offensive_ideas
					}
				}
				custom_tooltip = GV_TT_PERFECTING_OUR_DEFENCES_BONUS_YES
			}
			else = {
				custom_tooltip = GV_TT_PERFECTING_OUR_DEFENCES_BONUS_NO
			}
		}
	}

	gor_vazumbrog_sister_hold = {
		icon = mission_mountain_castle
		required_missions = { gor_vazumbrog_perfecting_our_defences }
		position = 9

		provinces_to_highlight = {
			OR = {
				AND = {
					province_id = 4242
					NOT = {
						AND = {
							country_or_non_sovereign_subject_holds = ROOT
							province_has_current_tech_fort_trigger = yes
							has_building = ramparts
							has_supply_depot = ROOT
						}
					}
				}
				AND = {
					province_id = 4218
					NOT = {
						AND = {
							country_or_non_sovereign_subject_holds = ROOT
							province_has_current_tech_fort_trigger = yes
							NOT = { has_province_modifier = ruined_hold }
							NOT = { has_province_modifier = infested_hold }
						}
					}
				}
				AND = {
					OR = {
						province_id = 2914
						province_id = 4124
						province_id = 2884
					}
					NOT = {
						AND = {
							country_or_non_sovereign_subject_holds = ROOT
							province_has_current_tech_fort_trigger = yes
						}
					}
				}
				AND = {
					area = ozumbrog_area
					NOT = { country_or_non_sovereign_subject_holds = ROOT }
				}
			}
		}

		trigger = {
			4242 = { #Dwarovrod[45]/Bogig Ozumbrog
				country_or_non_sovereign_subject_holds = ROOT # subject allowed without ramparts in case you got a bit ovdal kanzad PU
				province_has_current_tech_fort_trigger = yes
				has_supply_depot = ROOT
				if = {
					limit = { owned_by = ROOT }
					has_building = ramparts
				}
			}

			4218 = { #Gor Ozumbrog
				province_has_current_tech_fort_trigger = yes
				hold_condition = { Repaired = yes }
				area_for_scope_province = {
					type = all
					country_or_non_sovereign_subject_holds = ROOT
				}
			}

			2914 = { #Verkal Gulan
				country_or_non_sovereign_subject_holds = ROOT
				province_has_current_tech_fort_trigger = yes
			}

			4124 = { #Seghdihr
				country_or_non_sovereign_subject_holds = ROOT
				province_has_current_tech_fort_trigger = yes
			}

			2884 = { #Dwarovrod[24]/Bogig Vazumbrog
				country_or_non_sovereign_subject_holds = ROOT
				province_has_current_tech_fort_trigger = yes
			}
		}

		effect = {
			4218 = {
				area = {
					limit = { NOT = { owned_by = ROOT }	}
					cede_province = ROOT
				}
			}
			if = {
				limit = { NOT = { owns = 4242 } }
				4242 = { cede_province = ROOT }
			}
			custom_tooltip = GV_TT_BOGIG_OZUMBROG_CITADEL
			hidden_effect = {
				gor_vazumbrog_build_citadel = { province = 4242 citadel = outer } #Dwarovrod[45]
				4242 = {
					change_province_name = "Bogig Ozumbrog"
					rename_capital = "Bogig Ozumbrog"
				}
			}

			custom_tooltip = " "
			add_country_modifier = {
				name = gor_vazumbrog_sealed_and_secured
				duration = 9125
			}
		}
	}

	gor_vazumbrog_defence_in_depth = {
		icon = byz_reinforce_constantinople
		required_missions = { gor_vazumbrog_sister_hold }
		position = 10

		provinces_to_highlight = {
			OR = {
				AND = {
					OR = {
						area = azka_sur_area
						province_id = 645
						province_id = 646
						province_id = 558
						province_id = 2915
					}
					NOT = { owned_by = ROOT }
				}
				AND = {
					province_id = 2915
					NOT = {
						AND = {
							province_has_current_tech_fort_trigger = yes
							has_great_project = { type = heros_gate tier = 2 }
						}
					}
				}
				AND = {
					province_id = 647
					NOT = {
						AND = {
							province_has_current_tech_fort_trigger = yes
							has_building = ramparts
							has_supply_depot = ROOT
						}
					}
				}
			}
		}

		trigger = {
			azka_sur_area = {
				type = all
				owned_by = ROOT
			}
			645 = { owned_by = ROOT } #Nabilsu
			646 = { owned_by = ROOT } #Xharnax
			558 = { owned_by = ROOT } #Zanagu

			2915 = { #Hero's Vale
				owned_by = ROOT
				province_has_current_tech_fort_trigger = yes
				has_great_project = { type = heros_gate tier = 2 }
			}
			647 = { #Sarsad
				owned_by = ROOT
				province_has_current_tech_fort_trigger = yes
				has_building = ramparts
				has_supply_depot = ROOT
			}
		}

		effect = {
			custom_tooltip = GV_TT_DESERT_CITADEL
			hidden_effect = {
				gor_vazumbrog_build_citadel = { province = 647 citadel = desert } #Sarsad
				647 = {
					change_province_name = "Ânumkar"
					rename_capital = "Ânumkar"
				}
			}

			647 = { change_trade_goods = coffee }

			custom_tooltip = " "
			custom_tooltip = GV_TT_UNLOCK_BULWAR_HUNT
			set_country_flag = bulwar_hunt_unlocked

			custom_tooltip = " "
			gor_vazumbrog_give_cb_for_hold = { #Grozumdihr
				tag = I18
				province_id = 4265
			}
		}
	}
}

gor_vazumbrog_2_2 = {
	slot = 2
	generic = no
	ai = yes
	has_country_shield = yes
	potential = {
		tag = I14
		has_country_flag = gor_vazumbrog_mt_part_2
	}

	gor_vazumbrog_history_lessons = {
		icon = mission_science
		required_missions = { gor_vazumbrog_the_future_is_bright }
		position = 7

		provinces_to_highlight = {
			OR = {
				province_id = 2863 #Khugdihr
				AND = {
					province_id = 8 #Anbenncost
					owner = { NOT = { has_90_opinion_improved_relation = { target = ROOT } } }
				}
				AND = {
					province_id = 912 #Silverforge
					owner = { NOT = { has_90_opinion_improved_relation = { target = ROOT } } }
				}
			}

		}

		trigger = {
			custom_trigger_tooltip = {
				tooltip = GV_TT_TITANIUM_GOLEMS_FATE_KNOWN
				has_country_flag = vault_golem_fate
			}

			custom_trigger_tooltip = {
				tooltip = GV_TT_MERC_EXPEDITION_KHUGDIHR
				OR = {
					2863 = { infantry_in_province = ROOT } #Khugdihr
					2863 = { #Khugdihr
						owner = {
							has_spy_network_from = { who = ROOT value = 50 }
						}
					}
				}
			}

			8 = { #Anbenncost
				owner = { has_90_opinion_improved_relation = { target = ROOT } }
			}
			912 = { #Silverforge
				owner = { has_90_opinion_improved_relation = { target = ROOT } }
			}
		}

		effect = {
			country_event = {
				id = flavour_gor_vazumbrog.30
			}
		}
	}

	gor_vazumbrog_golems_in_the_army = {
		icon = mission_divine_legion
		required_missions = { gor_vazumbrog_history_lessons gor_vazumbrog_how_to_hurt_a_dragon }
		position = 8

		provinces_to_highlight = {
			owned_by = ROOT
			has_building = mage_tower
			NOT = { has_supply_depot = ROOT }
		}

		trigger = {
			custom_trigger_tooltip = {
				tooltip = GV_TT_HAS_WORK_GOLEMS_2
				check_variable = {
					which = gorVazumbrogWorkGolemFacilities
					value = 2
				}
			}

            estate_loyalty = {
                estate = estate_mages
                loyalty = 60
            }

			num_of_owned_provinces_with = {
				value = 3
				has_building = mage_tower
			 	has_supply_depot = ROOT
			}
		}

		effect = {
			custom_tooltip = GV_TT_ARMY_GOLEM_CAPACITY_INCREASE
			hidden_effect = {
				change_variable = { gorVazumbrogArmyGolemCapacity = 2 }
			}
			custom_tooltip = " "
			custom_tooltip = GV_TT_ARMY_GOLEM_FACILITIES_INCREASE
			custom_tooltip = GV_TT_ARMY_GOLEMANCY_GUIDANCE
			hidden_effect = {
				change_variable = {
					which = gorVazumbrogArmyGolemFacilities
					value = 1
				}
			}
			update_army_golem_modifier = yes
		}
	}

	gor_vazumbrog_relay_network = {
		icon = mission_missive
		required_missions = { gor_vazumbrog_sister_hold gor_vazumbrog_bonded_by_firepower }
		position = 10

		provinces_to_highlight = {
			OR = {
				AND = {
					OR = {
						province_id = 2878 #Dwarovrod[17]/Mushroom Citadel
						province_id = 2879 #Dwarovrod[18]
						province_id = 2880 #Dwarovrod[19]
						province_id = 2881 #Dwarovrod[20]
						area = dwarovrod_21_24_area
						AND = {
							region = middle_dwarovar_region
							has_terrain = dwarven_road
						}
						province_id = 4242 #Dwarovrod[45]/Bogig Ozumbrog
					}
					OR = {
						NOT = { owned_by = ROOT }
						NOT = { has_courthouse_building_trigger = yes }
					}
				}
				AND = {
					OR = {
						province_id = 2878 #Dwarovrod[17]/Mushroom Citadel
						province_id = 2884 #Dwarovrod[24]/Bogig Vazumbrog
						province_id = 4027 #Dwarovrod[33]
						province_id = 4242 #Dwarovrod[45]/Bogig Ozumbrog
					}
					NOT = { num_of_times_expanded_infrastructure = 1 }
				}
			}
		}

		trigger = {
			custom_trigger_tooltip = {
				tooltip = GV_TT_RELAY_TUNNEL_COURTHOUSE_REQUIREMENT
				2878 = { #Dwarovrod[17]/Mushroom Citadel
					owned_by = ROOT
					has_courthouse_building_trigger = yes
				}
				2879 = { #Dwarovrod[18]
					owned_by = ROOT
					has_courthouse_building_trigger = yes
				}
				2880 = { #Dwarovrod[19]
					owned_by = ROOT
					has_courthouse_building_trigger = yes
				}
				2881 = { #Dwarovrod[20]
					owned_by = ROOT
					has_courthouse_building_trigger = yes
				}
				dwarovrod_21_24_area = {
					type = all
					owned_by = ROOT
					has_courthouse_building_trigger = yes
				}
				middle_dwarovar_region = {
					type = all
					OR = {
						AND = {
							owned_by = ROOT
							has_courthouse_building_trigger = yes
						}
						NOT = { has_terrain = dwarven_road }
					}
				}
				4242 = { #Dwarovrod[45]/Bogig Ozumbrog
					owned_by = ROOT
					has_courthouse_building_trigger = yes
				}
			}

			if = {
				limit = { has_dlc = "Leviathan" }
				2878 = { num_of_times_expanded_infrastructure = 1 } #Dwarovrod[17]/Mushroom Citadel
				2884 = { num_of_times_expanded_infrastructure = 1 } #Dwarovrod[24]/Bogig Vazumbrog
				4027 = { num_of_times_expanded_infrastructure = 1 } #Dwarovrod[33]
				4242 = { num_of_times_expanded_infrastructure = 1 } #Dwarovrod[45]/Bogig Ozumbrog
			}
			else = {
				adm_power = 200
			}
		}

		effect = {
			add_country_modifier = {
				name = gor_vazumbrog_logistics_corps
				duration = -1
			}
			if = {
				limit = { NOT = { has_dlc = "Leviathan" } }
				add_adm_power = -200
			}
		}
	}

	gor_vazumbrog_atlas_maior = {
		icon = develop_naples
		required_missions = { gor_vazumbrog_relay_network }
		position = 11

		provinces_to_highlight = {
			region = middle_dwarovar_region
			OR = {
				NOT = { owned_by = ROOT }
				has_province_modifier = expedition_target
			}
		}

		trigger = {
			middle_dwarovar_region = {
				type = all
				owned_by = ROOT
			}
			NOT = {
				middle_dwarovar_region = {
					#type = any
					has_province_modifier = expedition_target
				}
			}
			custom_trigger_tooltip = {
				tooltip = GV_TT_REQUIRE_12_COMPLETED_HUNTS
				check_variable = {
					which = gorVazumbrogHuntsCompleted
					value = 12
				}
			}
		}

		effect = {
			add_splendor = 200

			custom_tooltip = " "
			custom_tooltip = GV_TT_WONDROUS_EXPEDITIONS
			hidden_effect = {
				random_owned_province = {
					limit = {
						region = middle_dwarovar_region
						has_terrain = dwarven_road
						NOT = { has_province_modifier = expedition_target }
						has_dwarovar_dungeon = no
					}
					set_province_flag = gor_vazumbrog_forgotten_railyard_expediton
					spawn_expedition = yes
					generate_expedition = { base_floor = 5 base_danger = 6 }
				}
				random_owned_province = {
					limit = {
						region = middle_dwarovar_region
						has_terrain = cavern
						NOT = { has_province_modifier = expedition_target }
						has_dwarovar_dungeon = no
					}
					set_province_flag = gor_vazumbrog_golem_workshop_expedition
					spawn_expedition = yes
					generate_expedition = { base_floor = 6 base_danger = 5 }
				}
				if = {
					limit = { #expedition changes trade good to serpentbloom, so best spawn it there
						any_owned_province = {
							region = middle_dwarovar_region
							has_terrain = cavern
							NOT = { has_province_modifier = expedition_target }
							has_dwarovar_dungeon = no
							trade_goods = serpentbloom
						}
					}
					random_owned_province = {
						limit = {
							region = middle_dwarovar_region
							has_terrain = cavern
							NOT = { has_province_modifier = expedition_target }
							has_dwarovar_dungeon = no
							trade_goods = serpentbloom
						}
						set_province_flag = gor_vazumbrog_halanna_breath_vent_expedition
						spawn_expedition = yes
						generate_expedition = { base_floor = 6 base_danger = 6 }
					}
				}
				else = {
					random_owned_province = {
						limit = {
							region = middle_dwarovar_region
							has_terrain = cavern
							NOT = { has_province_modifier = expedition_target }
							has_dwarovar_dungeon = no
						}
						set_province_flag = gor_vazumbrog_halanna_breath_vent_expedition
						spawn_expedition = yes
						generate_expedition = { base_floor = 6 base_danger = 6 }
					}
				}
			}
		}
	}
}

gor_vazumbrog_2_3 = {
	slot = 3
	generic = no
	ai = yes
	has_country_shield = yes
	potential = {
		tag = I14
		has_country_flag = gor_vazumbrog_mt_part_2
	}

	gor_vazumbrog_how_to_hurt_a_dragon = {
		icon = mission_cannons_firing
		required_missions = { gor_vazumbrog_the_future_is_bright }
		position = 7

		provinces_to_highlight = {
			OR = {
				AND = {
					province_id = 2884 #Dwarovrod[24]/Bogig Vazumbrog
					NOT = { num_of_units_in_province = { amount = 30 who = ROOT type = artillery } }
				}
				AND = {
					owned_by = ROOT
					trade_goods = copper
					ROOT = {
						NOT = {
							trade_goods_produced_amount = {
								trade_goods = copper
								amount = 12
							}
						}
					}
				}				
				AND = {
					province_id = 4247 # Ovdal Kanzad
					NOT = {
						OR = {
							owned_by = ROOT
							owned_by_subject_of = ROOT
							owner = { has_90_opinion_improved_relation = { target = ROOT } }
							owner = { has_spy_network_from = { who = ROOT value = 30 } }
						}
					}
				}
			}
		}

		trigger = {
			trade_goods_produced_amount = {
				trade_goods = copper
				amount = 12
			}

			num_of_owned_provinces_with = {
				value = 15
				has_manpower_building_trigger = yes
			}

			2884 = { #Dwarovrod[24]/Bogig Vazumbrog
				num_of_units_in_province = { amount = 30 who = ROOT type = artillery }
			}

			OR = {
				owns_or_subject_of = 4247 # Ovdal Kanzad
				4247 = { owner = { has_90_opinion_improved_relation = { target = ROOT } } }
				4247 = { owner = { has_spy_network_from = { who = ROOT value = 30 } } }
			}
		}

		effect = {
			2884 = { #Dwarovrod[24]/Bogig Vazumbrog
				kill_units = {
				    who = owner
				    type = artillery
				    amount = 30
				}
			}

			set_country_flag = gor_vazumbrog_cannoneer_corps_unlocked
			set_estate_privilege = estate_nobility_cannoneer_corps

			gor_vazumbrog_give_cb_for_hold = { #Ovdal Kanzad
				tag = H79
				province_id = 4247
			}
		}
	}

	gor_vazumbrog_dauntless_drills = {
		icon = qng_ten_grand_campaigns
		required_missions = { gor_vazumbrog_how_to_hurt_a_dragon }
		position = 8

		trigger = {
			army_professionalism = 0.4
			has_estate_privilege = estate_nobles_officer_corp
			has_estate_privilege = estate_adventurers_heroes_in_the_army

			custom_trigger_tooltip = {
				tooltip = GV_TT_REQUIRE_20_DIP_ORDER_PROVINCES
				check_variable = {
					which = gorVazumbrogDipOrderProvinces
					value = 20
				}
			}

			custom_trigger_tooltip = {
				tooltip = GV_TT_REQUIRE_20_MIL_ORDER_PROVINCES
				check_variable = {
					which = gorVazumbrogMilOrderProvinces
					value = 20
				}
			}
		}

		effect = {
			custom_tooltip = GV_TT_PRIVILEGES_IMPROVED_NOBLES_ADVENTURERS

			custom_tooltip = " "
			add_country_modifier = {
				name = gor_vazumbrog_valour_and_discipline
				duration = 7300
			}
		}
	}

	gor_vazumbrog_bonded_by_firepower = {
		icon = mission_runeforged_cannons
		required_missions = { gor_vazumbrog_golems_in_the_army gor_vazumbrog_dauntless_drills }
		position = 9

		trigger = {
			if = {
				limit = { NOT = { mil_tech = 19 } } #state firearm modifier removed by vanilla
				has_country_modifier = gunpowder_core
			}
			num_of_rajput = 5
			has_estate_privilege = estate_artificers_artificer_generals
			has_estate_privilege = estate_mages_battlemage_academies
			OR = {
				advisor = army_reformer
				has_mil_advisor_4 = yes
			}
			OR = {
				advisor = court_mage
				has_adm_advisor_4 = yes
			}
		}

		effect = {
			country_event = {
				id = flavour_gor_vazumbrog.33
			}
		}
	}

	gor_vazumbrog_forging_the_armour = {
		icon = mission_smith
		required_missions = { gor_vazumbrog_bonded_by_firepower }
		position = 11

		provinces_to_highlight = {
			OR = {
				AND = {
					province_id = 4269 #Earthseed
					ROOT = { NOT = { has_country_flag = basilisk_hunt_completed } }
				}
				AND = {
					province_id = 2978 #Claxac's Abyss
					ROOT = { NOT = { has_country_flag = pale_leviathan_hunt_completed } }
				}
				AND = {
					province_id = 4214 #Hehogrim's Mausoleum
					NOT = {						
						AND = {
							base_production = 10
							num_of_times_expanded_infrastructure = 1
							has_production_building_trigger = yes
							has_tax_building_trigger = yes
						}
					}
				}
			}
		}

		trigger = {
			custom_trigger_tooltip = {
				tooltip = GV_TT_BASILISK_SCALES_REQUIREMENT
				has_country_flag = basilisk_hunt_completed
			}
			custom_trigger_tooltip = {
				tooltip = GV_TT_LEVIATHAN_HIDE_REQUIREMENT
				has_country_flag = pale_leviathan_hunt_completed
			}
			OR = {
				estate_influence = {
					estate = estate_mages
					influence = 40
				}
				AND = {
					ruler_is_powerful_mage = yes
					is_ruler_enchantment_level_2_minimum = yes
				}
			}
			4214 = { #Hehogrim's Mausoleum
				base_production = 10
				num_of_times_expanded_infrastructure = 1
				has_production_building_trigger = yes
				has_tax_building_trigger = yes
			}
		}

		effect = {
			add_ruler_modifier = { name = gor_vazumbrog_dragonguard duration = -1 }
		}
	}

	gor_vazumbrog_picking_up_the_sword = {
		icon = gory_to_the_black_army
		required_missions = { gor_vazumbrog_atlas_maior gor_vazumbrog_forging_the_armour gor_vazumbrog_protective_runes }
		position = 12

		trigger = {
			is_at_war = no
			stability = 2
			NOT = { average_autonomy = 25 }
			NOT = { num_of_rebel_armies = 1 }
			OR = {
				has_had_golden_age = yes
				in_golden_age = yes
			}
		}

		effect = {
			country_event = {
				id = flavour_gor_vazumbrog.40
			}
			custom_tooltip = " "
			argrod_junction_area = { add_permanent_claim = ROOT	}
			nansalen_area = { add_permanent_claim = ROOT }
			dwarovrod_51_53_area = { add_permanent_claim = ROOT }
			custom_tooltip = gor_vazumbrog_picking_up_the_sword_reward_tt
		}
	}
}

gor_vazumbrog_2_4 = {
	slot = 4
	generic = no
	ai = yes
	has_country_shield = yes
	potential = {
		tag = I14
		has_country_flag = gor_vazumbrog_mt_part_2
	}

	gor_vazumbrog_no_stone_unturned = {
		icon = mission_underground_cave
		required_missions = { gor_vazumbrog_the_future_is_bright }
		position = 7

		provinces_to_highlight = {
			OR = {
				AND = {
					region = middle_dwarovar_region
					is_empty = no
					NOT = { country_or_subject_holds = ROOT }
				}
				AND = {
					ROOT = { NOT = { has_country_flag = oversized_drakon_hunt_completed } }
					province_id = 4080 #Deep One's Cave
				}
				AND = {
					ROOT = { NOT = { has_country_flag = mycoloth_hunt_completed } }
					province_id = 4223 #Ulagom Canyon
				}
				AND = {
					ROOT = { NOT = { has_country_flag = phosphorescent_gas_hunt_completed } }
					province_id = 4110 #Steaming Fissure
				}
			}
		}

		trigger = {
			custom_trigger_tooltip = {
				tooltip = GV_TT_ALL_DRAGON_HUNTS_COMPLETE
				has_country_flag = oversized_drakon_hunt_completed
				has_country_flag = mycoloth_hunt_completed
				has_country_flag = phosphorescent_gas_hunt_completed
			}
			middle_dwarovar_region = {
				type = all
				OR = {
					country_or_subject_holds = ROOT
					is_empty = yes
				}
			}
		}

		effect = {
			custom_tooltip = GV_TT_NEW_VEINS
			custom_tooltip = gor_vazumbrog_reward_livestock_to_copper
			custom_tooltip = gor_vazumbrog_reward_wool_to_gems
			custom_tooltip = gor_vazumbrog_reward_fungi_to_salt
			custom_tooltip = gor_vazumbrog_reward_serpentbloom_to_mithril
			hidden_effect = {
				random_owned_province = {
					limit = {
						region = middle_dwarovar_region
						NOT = { province_group = hold_province }
						trade_goods = livestock
						NOT = { has_province_modifier = dwarovar_rothe_herds } #don't want to touch already buffed provinces
					}
					change_trade_goods = copper
				}
				random_owned_province = {
					limit = {
						region = middle_dwarovar_region
						NOT = { province_group = hold_province }
						trade_goods = wool
					}
					change_trade_goods = gems
				}
				random_owned_province = {
					limit = {
						region = middle_dwarovar_region
						NOT = { province_group = hold_province }
						trade_goods = fungi
						NOT = { #don't want to touch already buffed provinces
							has_province_modifier = dwarovar_mushroom_settlement
							has_province_modifier = gor_vazumbrog_fast_growing_fungi
						}
					}
					change_trade_goods = salt
				}
				random_owned_province = {
					limit = {
						region = middle_dwarovar_region
						NOT = { province_group = hold_province }
						trade_goods = serpentbloom
					}
					change_trade_goods = mithril
				}
			}
		}
	}

	gor_vazumbrog_black_gold = {
		icon = mission_oni
		required_missions = { gor_vazumbrog_no_stone_unturned }
		position = 8

		provinces_to_highlight = {
			has_province_modifier = black_damestear
		}

		trigger = {
			custom_trigger_tooltip = {
				tooltip = GV_TT_ANVIL_RESEARCHED
				has_country_flag = vault_anvil_of_unmaking_basic_research
			}
			custom_trigger_tooltip = {
				tooltip = GV_TT_DAMESTEAR_WORSHOP_PROVINCE_PREPARED
				any_owned_province = {
					has_terrain = dwarven_road
					NOT = { has_province_flag = citadel_province }
					has_production_building_trigger = yes
					has_building = mage_tower
					has_supply_depot = ROOT
				}
			}
			custom_trigger_tooltip = {
				tooltip = GV_TT_MERC_EXPEDITION_ONI_HILLS
				OR = {
					any_province = {
						has_province_modifier = black_damestear
						infantry_in_province = ROOT
					}
					any_province = {
						has_province_modifier = black_damestear
						owner = {
							has_spy_network_from = { who = ROOT value = 50 }
						}
					}
				}
			}
		}

		effect = {
			country_event = {
				id = flavour_gor_vazumbrog.32
			}
		}
	}

	gor_vazumbrog_fire_with_fire = {
		icon = mission_arise
		required_missions = { gor_vazumbrog_bonded_by_firepower gor_vazumbrog_into_the_vaults }
		position = 10

		provinces_to_highlight = {
			OR = {
				AND = {
					has_global_flag = aakhet_hostless
					province_id = 466
				}
				AND = {
					is_capital = yes
					owner = { has_country_flag = current_aakhet_host }
				}
			}
		}

		trigger = {
			custom_trigger_tooltip = {
				tooltip = GV_TT_HAS_ANCIENT_WEAPON_CRATE
				has_country_flag = vault_ancient_weapon_crate
			}

			if = {
				limit = { has_global_flag = aakhet_hostless }
				custom_trigger_tooltip = {
					tooltip = GV_TT_MERC_EXPEDITION_AAKHET
					OR = {
						466 = { infantry_in_province = ROOT }
						466 = {
							owner = {
								OR = {
									has_spy_network_from = { who = ROOT value = 50 }
									overlord = { has_spy_network_from = { who = ROOT value = 50 } }

								}
							}
						}
					}
				}
			}
			else = {
				custom_trigger_tooltip = {
					tooltip = GV_TT_MERC_EXPEDITION_AAKHET
					any_known_country = {
						has_country_flag = current_aakhet_host
						OR = {
							capital_scope = {
								infantry_in_province = ROOT
							}
							has_spy_network_from = { who = ROOT value = 50 }
							overlord = { has_spy_network_from = { who = ROOT value = 50 } }
						}
					}
				}
			}
		}

		effect = {
			country_event = { id = flavour_gor_vazumbrog.34 }
		}
	}

	gor_vazumbrog_protective_runes = {
		icon = mission_conquer_orissa_dlh
		required_missions = { gor_vazumbrog_fire_with_fire }
		position = 11

		provinces_to_highlight = {
			OR = {
				AND = {
					trade_goods = silk
					continent = serpentspine
					ROOT = {
						NOT = {
							trade_goods_produced_amount = {
								trade_goods = silk
								amount = 10
							}
						}
					}
				}
				AND = {
					owned_by = ROOT
					OR = {
						trade_goods = cloth
						trade_goods = silk
						trade_goods = wool
					}
					NOT = { has_building = textile }
					ROOT = {
						NOT = {
							num_of_owned_provinces_with = {
								has_building = textile
								value = 5
							}
						}
					}
				}
			}
		}

		trigger = {
			custom_trigger_tooltip = {
				tooltip = GV_TT_POISON_PROTECTION_LEARNED
				has_country_flag = gor_vazumbrog_poison_protection_learned
			}
			num_of_rajput = 10

			estate_influence = {
				estate = estate_artificers
				influence = 40
			}

			trade_goods_produced_amount = {
				trade_goods = silk
				amount = 10
			}

			num_of_owned_provinces_with = {
				has_building = textile 
				value = 5
			}
		}

		effect = {
			custom_tooltip = GV_TT_ARMY_GOLEM_CAPACITY_INCREASE
			hidden_effect = {
				change_variable = { gorVazumbrogArmyGolemCapacity = 2 }
			}
			custom_tooltip = GV_TT_ARMY_GOLEM_FACILITIES_INCREASE
			hidden_effect = {
				change_variable = {
					which = gorVazumbrogArmyGolemFacilities
					value = 1
				}
				update_army_golem_modifier = yes
			}
		}
	}
}

gor_vazumbrog_2_5 = {
	slot = 5
	generic = no
	ai = yes
	has_country_shield = yes
	potential = {
		tag = I14
		has_country_flag = gor_vazumbrog_mt_part_2
	}

	gor_vazumbrog_charity = {
		icon = mission_iroquois_food_surplus
		required_missions = { gor_vazumbrog_the_future_is_bright gor_vazumbrog_hands_of_stone }
		position = 7

		provinces_to_highlight = {
			region = middle_dwarovar_region
			owned_by = ROOT
			devastation = 0.01
		}

		trigger = {
			NOT = {
				any_owned_province = {
					region = middle_dwarovar_region
					devastation = 0.01
				}
			}
		}

		effect = {
			4217 = { #Gor Vazumbrog
				add_base_tax = 2
				add_base_production = 2
				add_base_manpower = 2
			}

			custom_tooltip = " "
			define_advisor = {
               type = artist
               skill = 3
               cost_multiplier = 0.25
            }

			custom_tooltip = " "
            add_stability_or_adm_power = yes
		}
	}

	gor_vazumbrog_into_the_vaults = {
		icon = mission_warrior_gold
		required_missions = { gor_vazumbrog_black_gold gor_vazumbrog_charity }
		position = 9

		provinces_to_highlight = {
			OR = {
				AND = { 
					has_province_modifier = gor_vazumbrog_black_damestear_workshop
					NOT = { base_production = 10 }
				}
				AND = { 
					province_id = 4217
					NOT = {
						AND = {
							development = 50
							num_of_times_expanded_infrastructure = 3
						}
					}
				}
			}
		}

		trigger = {
			if = {
				limit = { has_dlc = "Leviathan" }
				4217 = { #Gor Vazumbrog
					development = 50
					num_of_times_expanded_infrastructure = 3
				}
			}
			else = {
				4217 = { #Gor Vazumbrog
					development = 50
				}
				adm_power = 100
			}

			custom_trigger_tooltip = {
				tooltip = GV_TT_NO_AVAILABLE_VAULT_DELVES
				check_variable = {
					which = gorVazumbrogVaultDelvesCompleted
					value = 9
				}
			}			

			any_owned_province = {
				has_province_modifier = gor_vazumbrog_black_damestear_workshop
				base_production = 10
			}
		}

		effect = {
			custom_tooltip = GV_TT_ALL_VAULT_DELVES_UNLOCKED
			hidden_effect = {				
				change_variable = {
					which = gorVazumbrogVaultDelvesAvailable
					value = 10
				}
			}

			if = {
				limit = { NOT = { has_dlc = "Leviathan" } }
				add_adm_power = -100
			}
		}
	}

	gor_vazumbrog_new_vaults = {
		icon = mission_mechanical_mining
		required_missions = { gor_vazumbrog_fire_with_fire gor_vazumbrog_into_the_vaults }
		position = 11

		provinces_to_highlight = {
			province_id = 4217 #Gor Vazumbrog
		}

		trigger = {
			4217 = { #Gor Vazumbrog
				has_dwarven_hold_3 = yes
				num_of_buildings_in_province = 8
			}

			check_variable = { gorVazumbrogVaultRelicsFound = 6 }

			custom_trigger_tooltip = {
				tooltip = GV_TT_REQUIRE_20_ADM_ORDER_PROVINCES
				check_variable = {
					which = gorVazumbrogAdmOrderProvinces
					value = 20
				}
			}

			has_estate_privilege = estate_artificers_grand_exhibition_hall
		}

		effect = {
			custom_tooltip = "GV_TT_VAULT_INFRASTRUCTURE_UNLOCKED"
			4217 = { #Gor Vazumbrog
				set_province_flag = gor_vazumbrog_vaults_rebuilt
			}

			custom_tooltip = " "
			custom_tooltip = "GV_TT_ARTIFICE_DEVELOPMENT_TOOLS_UNLOCKED"
			set_country_flag = gor_vazumbrog_artificers_development_tools_available
		}
	}
}

##################
######Part 3######
##################

gor_vazumbrog_3_5 = {
	slot = 5
	generic = no
	ai = yes
	has_country_shield = yes
	potential = {
		tag = I14
		has_country_flag = gor_vazumbrog_mt_part_3
	}

	gor_vazumbrog_the_suture = {
		icon = mam_tabriz
		required_missions = { gor_vazumbrog_picking_up_the_sword gor_vazumbrog_new_vaults }
		position = 13

		provinces_to_highlight = {
			province_id = 4217 #Gor Vazumbrog
		}

		trigger = {
			has_estate_privilege = estate_adventurers_hunter_of_the_deep_trophy
			has_estate_privilege = estate_artificers_development_tools
			treasury = 5000
			OR = {
				has_cast_reshape_terrain = yes
				has_cast_aid_construction = yes
				has_cast_deposit_divination = yes
			}
		}

		effect = {
			add_treasury = -5000
			country_event = { id = flavour_gor_vazumbrog.42 }
		}
	}
}

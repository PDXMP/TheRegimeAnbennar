spiked_log_1 = {
	slot = 1
	generic = no
	ai = yes
	has_country_shield = yes
	potential = { tag = I36 }

	spiked_log_the_prickly_alliance = {
		icon = mission_diplomatic_relation
		position = 1
		provinces_to_highlight = {
			owned_by = I35
		}

		trigger = {
			OR = {
				AND = {
					alliance_with = I35
					reverse_has_opinion = {
						who = I35
						value = 150
					}
					is_at_war = no
				}
				I35 = { 
					is_rival = ROOT
					has_spy_network_from = {
						who = ROOT
						value = 20
					}
					has_been_insulted_by_root = yes
				}
				NOT = { exists = I35 }
			}
		}

		effect = {
			simple_dynamic_effect = {
				first_custom_tooltip = spiked_log_the_prickly_alliance_trigger_tt
				first_limit = "alliance_with = I35"
				first_effect = "
					I35 = { country_event = { id = flavor_spiked_log.1 } }
					custom_tooltip = spiked_log_oubbligschild_war_tt
				"
				second_limit = "
					OR = {
						NOT = { exists = I35 }
						I35 = { is_rival = ROOT }
					}
				"
				second_effect = "
					hidden_effect = {
						I35 = { every_core_province = { add_permanent_claim = ROOT } }
						U12 = { every_core_province = { add_permanent_claim = ROOT } }
					}
					custom_tooltip = spiked_log_the_prickly_alliance_claims_tt
				"
			}
		}
	}

	spiked_log_punish_the_traitor = {
		icon = mission_fire_judgement
		position = 2
		required_missions = { spiked_log_the_prickly_alliance }
		provinces_to_highlight = {
			OR = {
				owned_by = U12
				AND = {
					is_core = U12
					NOT = { owned_by = I35 }
					I35 = { alliance_with = ROOT }
				}
				AND = {
					OR = {
						is_core = U12
						is_core = I35
					}
					NOT = { owned_by = ROOT }
					NOT = { I35 = { alliance_with = ROOT } }
				}
			}
		}

		trigger = {
			if = {
				limit = { is_subject = yes }
				is_subject = no
			}
			OR = {
				AND = {
					alliance_with = I35
					reverse_has_opinion = {
						who = I35
						value = 200
					}
					OR = {
						AND = {
							NOT = { exists = U12 }
							custom_trigger_tooltip = {
								tooltip = spiked_log_punish_the_traitor_trigger_tt_1
								U12 = { all_core_province = { owned_by = I35 } }
							}
						}
						AND = {
							war_with = U12
							war_score_against = {
								who = U12
								value = 100
							}
						}
					}
				}
				AND = {
					NOT = { exists = I35 }
					NOT = { exists = U12 }
					custom_trigger_tooltip = {
						tooltip = spiked_log_punish_the_traitor_trigger_tt_2
						U12 = { all_core_province = { owned_by = I36 } }
						I35 = { all_core_province = { owned_by = I36 } }
					}
				}
			}
		}

		effect = {
			simple_dynamic_effect = {
				first_custom_tooltip = spiked_log_alliance_with_brambleskinner_tt
				first_limit = "alliance_with = I35"
				first_effect = "
					custom_tooltip = spiked_log_punish_the_traitor_effect_tt_1
					I35 = { country_event = { id =  flavor_spiked_log.3 } }
				"
				second_limit = "NOT = { alliance_with = I35 }"
				second_effect = "
					custom_tooltip = spiked_log_punish_the_traitor_effect_tt_2
					hidden_effect = {
						every_owned_province = {
							limit = {
								OR = {
									is_core = U12
									is_core = I35
								}
							}
							add_nationalism = -5
							add_local_autonomy = -10
						}
					}
				"
			}
			country_event = { id = flavor_spiked_log.5 days = 365 }
		}
	}

	spiked_log_end_oubbligs_legacy = {
		icon = mission_alone_in_the_forest_2
		position = 3
		required_missions = { spiked_log_punish_the_traitor }
		provinces_to_highlight = {
			OR = {
				owned_by = ROOT
				owned_by = I35
			}
			religion_group = fey_religion
			culture = forest_goblin
		}

		trigger = {
			OR = {
				I35 = {
					is_subject_of = ROOT
					all_owned_province = { 
						OR = {
							NOT = { religion_group = fey_religion }
							NOT = { culture = forest_goblin }
						}
					}
				}
				AND = {
					NOT = { exists = I35 }
					all_owned_province = { 
						OR = {
							NOT = { religion_group = fey_religion }
							NOT = { culture = forest_goblin }
						}
					}
				}
			}
		}

		effect = {
			country_event = { id = flavor_spiked_log.6 }
			custom_tooltip = spiked_log_end_oubbligs_legacy_insight_tt
			simple_dynamic_effect = {
				first_custom_tooltip = spiked_log_end_oubbligs_legacy_trigger_tt
				first_limit = "I35 = { is_subject_of = ROOT }"
				first_effect = "tooltip = { I35 = { add_country_modifier = { name = spiked_log_loyal_subject_clan duration = -1 } } }"
				second_limit = "NOT = { exists = I35 }"
				second_effect = "tooltip = { add_country_modifier = { name = spiked_log_brambleskinner_vassals duration = 7300 } }"
			}
			complex_dynamic_effect_without_alternative = {
				first_custom_tooltip = spiked_log_end_oubbligs_legacy_bonus_trigger_tt
				first_limit = "
					I35 = {
						is_subject_of = ROOT
						NOT = { 
							num_of_cities = 20
						}
					}
				"
				first_effect = "custom_tooltip = spiked_log_end_oubbligs_legacy_bonus_effect_tt"
			}
		}
	}

	spiked_log_ivory_tinkering = {
		icon = mission_artificier_experience
		position = 4
		required_missions = { spiked_log_end_oubbligs_legacy }
		provinces_to_highlight = {
			OR = {
				province_id = 7003
				province_id = 3011
			}
			NOT = {
				AND = {
					country_or_non_sovereign_subject_holds = ROOT
					base_production = 6
					OR = {
						has_production_building_trigger = yes
						has_no_ongoing_construction = yes
					}
				}
			}
		}

		trigger = {
			7003 = {
				country_or_non_sovereign_subject_holds = ROOT
				base_production = 6
				OR = {
					has_production_building_trigger = yes
					has_no_ongoing_construction = yes
				}
			}
			3011 = {
				country_or_non_sovereign_subject_holds = ROOT
				base_production = 6
				OR = {
					has_production_building_trigger = yes
					has_no_ongoing_construction = yes
				}
			}
			custom_trigger_tooltip = {
				tooltip = spiked_log_ivory_tinkering_trigger_tt
				if = {
					limit = {
						7003 = { NOT = { has_production_building_trigger = yes } }
						3011 = { NOT = { has_production_building_trigger = yes } }
					}
					treasury = 200
				}
				else_if = {
					limit = {
						NOT = {
							AND = {
								7003 = { has_production_building_trigger = yes }
								3011 = { has_production_building_trigger = yes }
							}
						}
					}
					treasury = 100
				}
			}
				
		}

		effect = {
			add_country_modifier = { name = spiked_log_engravers_cartel duration = -1 }
			if = {
				limit = {
					7003 = { NOT = { has_production_building_trigger = yes } }
					3011 = { NOT = { has_production_building_trigger = yes } }
				}
				add_treasury = -200
			}
			else_if = {
				limit = {
					NOT = {
						AND = {
							7003 = { has_production_building_trigger = yes }
							3011 = { has_production_building_trigger = yes }
						}
					}
				}
				add_treasury = -100
			}
			3011 = {
				if = {
					limit = { NOT = { has_production_building_trigger = yes } }
					add_building_construction = {
						building = workshop
						speed = 1
						cost = 0
					}
				}
				add_province_modifier = { name = spiked_log_ivory_testing_ground duration = -1 }
			}
			7003 = {
				if = {
					limit = { NOT = { has_production_building_trigger = yes } }
					add_building_construction = {
						building = workshop
						speed = 1
						cost = 0
					}
				}
				add_province_modifier = { name = spiked_log_ivory_testing_ground duration = -1 }
			}
		}
	}

	spiked_log_cartel_collaboration = {
		icon = mission_magic_tower
		position = 6
		required_missions = { spiked_log_silver_lining }
		provinces_to_highlight = {
			superregion = deepwoods_superregion
			trade_goods = livestock
			NOT = { country_or_non_sovereign_subject_holds = ROOT }
			NOT = {
				ROOT = {
					num_of_provinces_owned_or_owned_by_non_sovereign_subjects_with = {
						value = 8
						trade_goods = livestock
					}
				}
			}
		}

		trigger = {
			num_of_provinces_owned_or_owned_by_non_sovereign_subjects_with = {
				value = 8
				trade_goods = livestock
				superregion = deepwoods_superregion
			}
			has_estate_privilege = estate_mages_reduced_research_regulations
			has_estate_privilege = estate_mages_seek_magical_advice
			OR = {
				estate_loyalty = {
					estate = estate_mages
					loyalty = 50
				}
				num_of_estate_agendas_completed = {
					estate = estate_mages
					value = 1
				}
				is_estate_any_school_level_1_minimum = yes
			}
		}

		effect = {
			add_estate_influence_modifier = {
				estate = estate_mages
				desc = SPIKED_LOG_BOLSTERED_MAGES
				influence = 10
				duration = 7300
			}
			capital_scope = { add_province_modifier = { name = spiked_log_feystomper_enhancement_lab duration = -1 } }
			mission_reward_artifice_points_3 = yes
			add_country_modifier = { name = spiked_log_ivory_experiments duration = 9125 } #25 years
			if = {
				limit = { has_country_modifier = spiked_log_unchecked_cartel_spending } #hidden before it's relevant
				complex_dynamic_effect = {
					first_custom_tooltip = spiked_log_cartel_collaboration_bonus_trigger_tt
					first_limit = "mission_completed = spiked_log_expand_log_production"
					first_effect = "remove_country_modifier = spiked_log_unchecked_cartel_spending"
				}
			}
		}
	}

	spiked_log_build_the_facility = {
		icon = mission_early_game_buildings
		position = 8
		required_missions = { spiked_log_cartel_collaboration }
		provinces_to_highlight = {
			is_capital_of = ROOT
			OR = {
				NOT = { num_of_buildings_in_province = 4 }
				AND = {
					has_dlc = "Leviathan"
					NOT = { num_of_times_expanded_infrastructure = 2 }
				}
				AND = {
					NOT = { has_dlc = "Leviathan" }
					NOT = { development = 30 }
				}
			}
		}

		trigger = {
			capital_scope = {
				if = {
					limit = {
						has_dlc = "Leviathan"
					}
					num_of_times_expanded_infrastructure = 2
				}
				else = {
					development = 30
				}
				num_of_buildings_in_province = 4
				has_no_ongoing_construction = yes
			}
			treasury = 250
		}

		effect = {
			add_treasury = -250
			capital_scope = {
				change_trade_goods = ivory
				add_building_construction = {
					building = tradecompany
					speed = 1
					cost = 0
				}
				remove_province_modifier = spiked_log_feystomper_enhancement_lab
				add_province_modifier = { name = spiked_log_ivory_engraving_manufactory duration = -1 }
			}
		}
	}
}
spiked_log_2 = {
	slot = 2
	generic = no
	ai = yes
	has_country_shield = yes
	potential = { tag = I36 }

	spiked_log_the_matter_with_orcs = {
		icon = mission_orc_chillin
		position = 3
		required_missions = { spiked_log_crush_the_slaughterer }
		provinces_to_highlight = {
			OR = {
				AND = {
					province_group = deepwoods_arrow_grove
					owned_by = ROOT
					fast_has_pop_of_race = { race = orcish }
					unrest = 1
					ROOT = {
						NOT = {
							has_country_modifier = racial_pop_orcish_purge
							has_country_modifier = racial_pop_orcish_expulsion
						}
					}
				}
				AND = {
					superregion = deepwoods_superregion
					owner = {
						culture_group = orcish
						capital_scope = { superregion = deepwoods_superregion }
						NOT = { has_been_insulted_by_root = yes }
					}
					ROOT = {
						OR = {
							has_country_modifier = racial_pop_orcish_purge
							has_country_modifier = racial_pop_orcish_expulsion
						}
					}
				}
			}
		}

		trigger = {
			has_country_modifier = racial_focus_orcish
			deepwoods_arrow_grove = {
				type = all
				OR = {
					NOT = { owned_by = ROOT }
					NOT = { fast_has_pop_of_race = { race = orcish } }
					NOT = { unrest = 1 }
				}
			}
			OR = { 
				custom_trigger_tooltip = {
					tooltip = spiked_log_the_matter_with_orcs_reconciliation_trigger_tt
					NOT = { has_country_modifier = racial_pop_orcish_purge }
					NOT = { has_country_modifier = racial_pop_orcish_expulsion }
					has_orcish_accepted_culture = yes
					OR = {
						medium_tolerance_orcish_race_trigger = yes
						high_tolerance_orcish_race_trigger = yes
					}
					has_orcish_advisor = yes
				}
				custom_trigger_tooltip = {
					tooltip = spiked_log_the_matter_with_orcs_retribution_trigger_tt
					OR = {
						has_country_modifier = racial_pop_orcish_purge
						has_country_modifier = racial_pop_orcish_expulsion
					}
					all_known_country = {
						OR = {
							capital_scope = { NOT = { superregion = deepwoods_superregion } }
							NOT = { culture_group = orcish }
							has_been_insulted_by_root = yes
						}
					}
				}
			}
		}

		effect = {
			custom_tooltip = spiked_log_the_matter_with_orcs_warning_tt
			simple_dynamic_effect = {
				first_custom_tooltip = spiked_log_the_matter_with_orcs_reconciliation_tt
				first_limit = "
					NOT = { has_country_modifier = racial_pop_orcish_purge }
					NOT = { has_country_modifier = racial_pop_orcish_expulsion }
				"
				first_effect = "
					custom_tooltip = spiked_log_the_matter_with_orcs_reconciliation_effect_tt
					set_country_flag = spiked_log_orc_reconciliation_flag
				"
				second_custom_tooltip = spiked_log_the_matter_with_orcs_retribution_tt
				second_limit = "
					OR = {
						has_country_modifier = racial_pop_orcish_purge
						has_country_modifier = racial_pop_orcish_expulsion
					}
				"
				second_effect = "
					custom_tooltip = spiked_log_the_matter_with_orcs_retribution_effect_tt
					set_country_flag = spiked_log_orc_retribution_flag
				"
			}
			
			hidden_effect = {
				if = { #Moving the actual effect bellow because it was too long for the simple dynamic effect
					limit = { has_country_flag = spiked_log_orc_reconciliation_flag }
					deepwoods_arrow_grove = {
						limit = {
							owned_by = ROOT
							fast_has_pop_of_race = { race = orcish }
						}
						add_nationalism = -10
						remove_province_modifier = religious_zeal_at_conv
					}
					add_country_modifier = { name = spiked_log_uneasy_reconciliation duration = 7300 }
					medium_increase_of_orcish_tolerance_effect = yes
				}
				else = {
					deepwoods_arrow_grove = {
						limit = {
							owned_by = ROOT
							fast_has_pop_of_race = { race = orcish }
						}
						remove_random_development = yes
						if = {
							limit = { culture_group = orcish }
							remove_racial_majority = { race = orcish }
							change_culture = ROOT
							change_religion = ROOT
						}
						else = {
							remove_orcish_minority_size_effect = yes
							remove_orcish_minority_size_effect = yes
						}
					}
					every_known_country = {
						limit = {
							culture_group = orcish
							capital_scope = { superregion = deepwoods_superregion }
						}
						add_aggressive_expansion = {
							who = ROOT
							value = 20
							apply_calc = no
						}
					}
					add_country_modifier = { name = spiked_log_bloody_revenge duration = 7300 }
					medium_decrease_of_orcish_tolerance_effect = yes
				}
			}
		}
	}

	spiked_log_silver_lining = {
		icon = mission_jawal_silver_mine
		position = 5
		required_missions = {
			spiked_log_ivory_tinkering
			spiked_log_the_matter_with_orcs
			spiked_log_feystomper_overcrowding
			spiked_log_sharpen_the_spikes
		}
		provinces_to_highlight = {
			OR = {
				owned_by = I44
				AND = {
					province_group = deepwoods_river_grove
					culture_group = orcish
					NOT = { AND = { owned_by = ROOT is_core = ROOT } }
				}
				AND = {
					province_id = 3042
					NOT = { AND = { owned_by = ROOT is_core = ROOT } }
				}
			}
		}

		trigger = {
			NOT = { exists = I44 }
			deepwoods_river_grove = {
				type = all
				OR = {
					NOT = { culture_group = orcish }
					AND = {
						owned_by = ROOT
						is_core = ROOT
					}
				}
			}
			custom_trigger_tooltip = {
				tooltip = spiked_log_silver_lining_yfelorr_trigger_tt
				3042 = { owned_by = ROOT is_core = ROOT }
			}
		}

		effect = {
			country_event = { id = flavor_spiked_log.12 }
		}
	}

	spiked_log_the_order_of_the_silver_tusk = {
		icon = mission_swear_fealty_knight
		position = 6
		required_missions = { spiked_log_silver_lining }
		provinces_to_highlight = {
			OR = {
				spiked_log_silver_tusk_highlight = { grove = arrow }
				spiked_log_silver_tusk_highlight = { grove = shadow }
				spiked_log_silver_tusk_highlight = { grove = bone }
				spiked_log_silver_tusk_highlight = { grove = lake }
				spiked_log_silver_tusk_highlight = { grove = thorn }
			}
		}

		trigger = {
			spiked_log_silver_tusk_trigger = { grove = arrow }
			spiked_log_silver_tusk_trigger = { grove = shadow }
			spiked_log_silver_tusk_trigger = { grove = bone }
			spiked_log_silver_tusk_trigger = { grove = lake }
			spiked_log_silver_tusk_trigger = { grove = thorn }
			cavalry_fraction = 0.2
		}

		effect = {
			country_event = { id = flavor_spiked_log.13 }
		}
	}

	spiked_log_overpower_the_greentide = {
		icon = mission_greentide
		position = 7
		required_missions = { spiked_log_the_order_of_the_silver_tusk }
		provinces_to_highlight = {
			superregion = deepwoods_superregion
			OR = {
				owner = {
					culture_group = orcish
					capital_scope = { superregion = deepwoods_superregion }
					total_development = 40
				}
				AND = {
					owned_by = ROOT
					culture_group = orcish
					NOT = {
						is_prosperous = yes
						num_of_buildings_in_province = 1
						num_of_times_improved_by_owner = 2
					}
					ROOT = { has_country_flag = spiked_log_orc_reconciliation_flag }
				}
				AND = {
					owned_by = ROOT
					fast_has_pop_of_race = { race = orcish }
					NOT = {
						NOT = { local_autonomy = 10 }
						has_province_modifier = autonomy_decreased
						num_of_units_in_province = { who = ROOT amount = 4 }
					}
					ROOT = { has_country_flag = spiked_log_orc_retribution_flag }
				}
			}
		}

		trigger = {
			custom_trigger_tooltip = {
				tooltip = spiked_log_repel_orcs_tt
				NOT = {
					any_known_country = {
						culture_group = orcish
						capital_scope = { superregion = deepwoods_superregion }
						total_development = 40
					}
				}
			}
			OR = {
				AND = {
					custom_trigger_tooltip = {
						tooltip = spiked_log_greentide_reconciliation_trigger_tt
						has_country_flag = spiked_log_orc_reconciliation_flag
					}
					num_of_owned_provinces_with = {
						value = 10
						culture_group = orcish
						OR = {
							is_prosperous = yes
							num_of_buildings_in_province = 1
							num_of_times_improved_by_owner = 2
						}
					}
				}
				AND = {
					custom_trigger_tooltip = {
						tooltip = spiked_log_greentide_retribution_trigger_tt
						has_country_flag = spiked_log_orc_retribution_flag
					}
					num_of_owned_provinces_with = {
						value = 10
						fast_has_pop_of_race = { race = orcish }
						OR = {
							NOT = { local_autonomy = 10 }
							has_province_modifier = autonomy_decreased
							num_of_units_in_province = { who = ROOT amount = 4 }
						}
					}
				}
			}
		}

		effect = {
			country_event = { id = flavor_spiked_log.14 }
			custom_tooltip = spiked_log_greentide_insight_tt
			simple_dynamic_effect = {
				first_custom_tooltip = spiked_log_greentide_reconciliation_tt
				first_limit = "has_country_flag = spiked_log_orc_reconciliation_flag"
				first_effect = "custom_tooltip = spiked_log_greentide_reconciliation_effect_tt"
				second_custom_tooltip = spiked_log_greentide_retribution_tt
				second_limit = "has_country_flag = spiked_log_orc_retribution_flag"
				second_effect = "custom_tooltip = spiked_log_greentide_retribution_effect_tt"
			}
		}
	}
}
spiked_log_3 = {
	slot = 3
	generic = no
	ai = yes
	has_country_shield = yes
	potential = { tag = I36 }

	spiked_log_defend_the_clan = {
		icon = defend_the_city
		position = 1
		provinces_to_highlight = {
			OR = {
				AND = {
					is_capital_of = ROOT
					NOT = {
						AND = {
							has_province_flag = anb_has_been_exploited_flag
							has_state_edict = edict_defensive_edict
						}
					}
				}
				AND = {
					owned_by = ROOT
					trade_goods = tropical_wood
					NOT = {
						ROOT = {
							any_owned_province = {
								trade_goods = tropical_wood
								has_province_flag = anb_has_been_exploited_flag
							}
						}
					}
				}
				AND = {
					owned_by = I42
					NOT = {
						ROOT = { is_rival = I42 }
						I42 = {
							has_opinion_modifier = {
								who = ROOT
								modifier = scornfully_insulted
							}
						}
					}
				}
			}
		}

		trigger = {
			army_size_percentage = 0.95
			capital_scope = {
				has_state_edict = edict_defensive_edict
				custom_trigger_tooltip = {
					tooltip = spiked_log_exploited_capital
					has_province_flag = anb_has_been_exploited_flag
				}
			}
			custom_trigger_tooltip = {
				tooltip = spiked_log_exploited_wood
				any_owned_province = { trade_goods = tropical_wood has_province_flag = anb_has_been_exploited_flag }
			}
			OR = {
				is_rival = I42
				I42 = {
					has_opinion_modifier = {
						who = ROOT
						modifier = scornfully_insulted
					}
				}
				NOT = { exists = I42 }
			}
		}

		effect = {
			define_ruler_to_general = {
				fire = 2
				shock = 4
				manuever = 5
				siege = 0
				trait = defensive_planner_personality
			}
			deepwoods_arrow_grove = {
				add_permanent_claim = ROOT
			}
			capital_scope = {
				add_province_modifier = { name = spiked_log_makeshift_fortifications duration = 3650 }
			}
			hidden_effect = { every_owned_province = { clr_province_flag = anb_has_been_exploited_flag } }
			clr_country_flag = anb_on_action_tracking_exploit_dev_flag
			custom_tooltip = spiked_log_defend_the_clan_bramble_help_tt
		}
	}

	spiked_log_crush_the_slaughterer = {
		icon = mission_head_on_spike
		position = 2
		required_missions = { spiked_log_defend_the_clan }
		provinces_to_highlight = {
			OR = {
				owned_by = I42
				AND = {
					owned_by = I43
					I43 = {
						NOT = {
							has_spy_network_from = {
								who = ROOT
								value = 20
							}
						}
					}
				}
				AND = {
					province_group = deepwoods_arrow_grove
					NOT = {
						owned_by = ROOT
						province_id = 3033
					}
				}
			}
		}

		trigger = {
			NOT = { exists = I42 }
			deepwoods_arrow_grove = {
				type = all
				OR = {
					owned_by = ROOT
					province_id = 3033
				}
			}
			I43 = {
				OR = {
					has_spy_network_from = {
						who = ROOT
						value = 20
					}
					exists = no
				}
			}
		}

		effect = {
			country_event = { id = flavor_spiked_log.7 }
		}
	}

	spiked_log_feystomper_taming_center = {
		icon = mission_green_village
		position = 3
		required_missions = { spiked_log_crush_the_slaughterer }
		provinces_to_highlight = {
			OR = {
				province_id = 3032
				province_id = 7015
				province_id = 3036
			}
			OR = {
				NOT = {
					num_of_units_in_province = {
						who = ROOT
						type = cavalry
						amount = 2
					}
				}
				NOT = { num_of_times_improved_by_owner = 2 }
				has_any_ongoing_construction = yes
			}
		}

		trigger = {
			3032 = {
				owned_by = ROOT
				num_of_times_improved_by_owner = 2
				num_of_units_in_province = {
					who = ROOT
					type = cavalry
					amount = 2
				}
				has_no_ongoing_construction = yes
			}
			7015 = {
				owned_by = ROOT
				num_of_times_improved_by_owner = 2
				num_of_units_in_province = {
					who = ROOT
					type = cavalry
					amount = 2
				}
				has_no_ongoing_construction = yes
			}
			3036 = {
				owned_by = ROOT
				num_of_times_improved_by_owner = 2
				num_of_units_in_province = {
					who = ROOT
					type = cavalry
					amount = 2
				}
				has_no_ongoing_construction = yes
			}
		}

		effect = {
			3032 = {
				kill_units = {
					type = cavalry
					amount = 2
					who = ROOT
				}
				custom_tooltip = spiked_log_add_or_upgrade_production_building_tt
				hidden_effect = {
					if = {
						limit = { has_building = workshop }
						add_building_construction = {
							building = counting_house
							speed = 1
							cost = 0
						}
					}
					else = {
						add_building_construction = {
							building = workshop
							speed = 1
							cost = 0
						}
					}
				}
			}
			7015 = {
				kill_units = {
					type = cavalry
					amount = 2
					who = ROOT
				}
				custom_tooltip = spiked_log_add_or_upgrade_production_building_tt
				hidden_effect = {
					if = {
						limit = { has_building = workshop }
						add_building_construction = {
							building = counting_house
							speed = 1
							cost = 0
						}
					}
					else = {
						add_building_construction = {
							building = workshop
							speed = 1
							cost = 0
						}
					}
				}
			}
			3036 = {
				kill_units = {
					type = cavalry
					amount = 2
					who = ROOT
				}
				custom_tooltip = spiked_log_add_or_upgrade_production_building_tt
				hidden_effect = {
					if = {
						limit = { has_building = workshop }
						add_building_construction = {
							building = counting_house
							speed = 1
							cost = 0
						}
					}
					else = {
						add_building_construction = {
							building = workshop
							speed = 1
							cost = 0
						}
					}
				}
			}
			custom_tooltip = spiked_log_grow_herds_timer_tt
			hidden_effect = { country_event = { id = flavor_spiked_log.10 days = 730 random = 365 } }
		}
	}

	spiked_log_feystomper_overcrowding = {
		icon = mission_ghost_town
		position = 4
		required_missions = { spiked_log_feystomper_taming_center }
		provinces_to_highlight = {
			country_or_non_sovereign_subject_holds = ROOT
			controlled_by = REB
		}

		trigger = {
			if = {
				limit = { NOT = { has_country_flag = spiked_log_stampede_happened } }
				custom_trigger_tooltip = {
					tooltip = spiked_log_feystomper_delay
					always = no
				}
			}
			else = {
				NOT = { num_of_rebel_armies = 1 }
				NOT = { num_of_rebel_controlled_provinces = 1 }
				all_subject_country = {
					NOT = { num_of_rebel_armies = 1 }
					NOT = { num_of_rebel_controlled_provinces = 1 }
				}
			}
		}

		effect = {
			country_event = { id = flavor_spiked_log.11 }
			if = {
				limit = { NOT = { has_country_flag = spiked_log_stampede_happened } }
				custom_tooltip = spiked_log_feystomper_overcrowding_insight1
			}
			else = {
				custom_tooltip = spiked_log_feystomper_overcrowding_insight2
			}
		}
	}

	spiked_log_no_goblin_left_behind = {
		icon = mission_cope_with_refugees
		position = 8
		required_missions = {
			spiked_log_overpower_the_greentide
			spiked_log_accomodate_the_cults
		}
		provinces_to_highlight = {
			superregion = deepwoods_superregion
			OR = {
				AND = {
					NOT = { country_or_non_sovereign_subject_holds = ROOT }
					culture = forest_goblin
				}
				owner = {
					primary_culture = forest_goblin
					NOT = { tag = ROOT }
					NOT = { is_subject_of = ROOT }
				}
			}
		}

		trigger = {
			deepwoods_superregion = {
				type = all
				OR = {
					NOT = { culture = forest_goblin }
					country_or_non_sovereign_subject_holds = ROOT
				}
			}
			custom_trigger_tooltip = {
				tooltip = spiked_log_no_indep_goblin_clan_tt
				all_known_country = {
					OR = {
						NOT = { primary_culture = forest_goblin }
						NOT = { capital_scope = { superregion = deepwoods_superregion } }
						is_subject_of = ROOT
					}
				}
			}
			employed_advisor = { category = ADM }
			employed_advisor = { category = DIP }
			employed_advisor = { category = MIL }
		}

		effect = {
			country_event = { id = flavor_spiked_log.15 }
		}
	}

	spiked_log_merge_the_cartels = {
		icon = mission_horde_trade
		position = 9
		required_missions = {
			spiked_log_build_the_facility
			spiked_log_no_goblin_left_behind
			spiked_log_pactbreakers
		}
		provinces_to_highlight = {
			OR = {
				AND = {
					country_or_non_sovereign_subject_holds = ROOT
					NOT = { num_of_buildings_in_province = 1 }
					NOT = { 
						ROOT = {
							num_of_provinces_owned_or_owned_by_non_sovereign_subjects_with = {
								value = 40
								num_of_buildings_in_province = 1
							}
						}
					}
				}
				AND = {
					province_id = 3023 #Deepwoods trade node
					NOT = {
						trade_share = {
							country = ROOT
							share = 50
						}
					}
				}
				AND = {
					superregion = deepwoods_superregion
					religion = pactseeker
				}
			}
		}

		trigger = {
			OR = {
				reform_level = 5
				NOT = { government = tribal }
			}
			monthly_income = 40
			num_of_provinces_owned_or_owned_by_non_sovereign_subjects_with = {
				value = 40
				num_of_buildings_in_province = 1
			}
			3023 = { #Deepwoods trade node
				trade_share = {
					country = ROOT
					share = 50
				}
			}
			deepwoods_superregion = {
				type = all
				NOT = { religion = pactseeker }
			}
		}

		effect = {
			change_innovativeness = 5
			if = {
				limit = {
					NOT = { government = republic }
				}
				change_government = republic
			}
			add_government_reform = technocracy_republic_reform
			country_event = { id = flavor_spiked_log.17 days = 2 }
			custom_tooltip = spiked_log_tale_of_many_tales_tt
		}
	}
}
spiked_log_4 = {
	slot = 4
	generic = no
	ai = yes
	has_country_shield = yes
	potential = { tag = I36 }

	spiked_log_reach_out = {
		icon = mission_expand_into_the_forest
		position = 3
		required_missions = { spiked_log_crush_the_slaughterer }
		provinces_to_highlight = {
			OR = {
				province_group = deepwoods_shadow_grove
				province_id = 3064
				province_id = 3065
				province_id = 3070
			}
			NOT = { owned_by = ROOT }
		}

		trigger = {
			deepwoods_shadow_grove = {
				type = all
				owned_by = ROOT
			}
			3064 = { owned_by = ROOT }
			OR = {
				3065 = { owned_by = ROOT }
				3070 = { owned_by = ROOT }
			}
		}

		effect = {
			country_event = { id = flavor_spiked_log.8 }
			custom_tooltip = spiked_log_bright_sun_insight
		}
	}

	spiked_log_sharpen_the_spikes = {
		icon = mission_alone_in_the_forest
		position = 4
		required_missions = { spiked_log_reach_out }
		provinces_to_highlight = {
			country_or_non_sovereign_subject_holds = ROOT
			OR = {
				AND = {
					is_capital_of = ROOT
					NOT = { has_fort_building_trigger = yes }
				}
				AND = {
					province_group = deepwoods_arrow_grove
					NOT = { is_capital_of = ROOT }
					NOT = {
						deepwoods_arrow_grove = {
							country_or_non_sovereign_subject_holds = ROOT
							NOT = { is_capital_of = ROOT }
							has_fort_building_trigger = yes
						}
					}
				}
				AND = {
					trade_goods = tropical_wood
					NOT = { num_of_times_improved = 2 }
					NOT = {
						ROOT = {
							num_of_provinces_owned_or_owned_by_non_sovereign_subjects_with = {
								value = 3
								trade_goods = tropical_wood
								num_of_times_improved = 2
							}
						}
					}
				}
			}
		}

		trigger = {
			num_of_provinces_owned_or_owned_by_non_sovereign_subjects_with = {
				value = 3
				trade_goods = tropical_wood
				num_of_times_improved = 2
			}
			custom_trigger_tooltip = {
				tooltip = spiked_log_sharpen_the_spikes_trigger_tt
				if = {
					limit = {
						capital_scope = { NOT = { has_fort_building_trigger = yes } }
						NOT = {
							deepwoods_arrow_grove = {
								country_or_non_sovereign_subject_holds = ROOT
								NOT = { is_capital_of = ROOT }
								has_fort_building_trigger = yes
							}
						}
					}
					treasury = 200
				}
				else_if = {
					limit = {
						NOT = {
							AND = {
								capital_scope = { has_fort_building_trigger = yes }
								deepwoods_arrow_grove = {
									country_or_non_sovereign_subject_holds = ROOT
									NOT = { is_capital_of = ROOT }
									has_fort_building_trigger = yes
								}
							}
						}
					}
					treasury = 100
				}
			}
			if = {
				limit = { capital_scope = { NOT = { has_fort_building_trigger = yes } } }
				capital_scope = { has_no_ongoing_construction = yes }
			}
			if = {
				limit = {
					NOT = {
						deepwoods_arrow_grove = {
							country_or_non_sovereign_subject_holds = ROOT
							NOT = { is_capital_of = ROOT }
							has_fort_building_trigger = yes
						}
					}
				}
				3037 = { has_no_ongoing_construction = yes }
			}
		}

		effect = {
			add_country_modifier = { name = spiked_log_trapsmiths_cartel duration = -1 }
			if = {
				limit = {
					capital_scope = { NOT = { has_fort_building_trigger = yes } }
					NOT = {
						deepwoods_arrow_grove = {
							country_or_non_sovereign_subject_holds = ROOT
							NOT = { is_capital_of = ROOT }
							has_fort_building_trigger = yes
						}
					}
				}
				add_treasury = -200
			}
			else_if = {
				limit = {
					NOT = {
						AND = {
							capital_scope = { has_fort_building_trigger = yes }
							deepwoods_arrow_grove = {
								country_or_non_sovereign_subject_holds = ROOT
								NOT = { is_capital_of = ROOT }
								has_fort_building_trigger = yes
							}
						}
					}
				}
				add_treasury = -100
			}
			capital_scope = {
				if = {
					limit = { NOT = { has_fort_building_trigger = yes } }
					add_building_construction = {
						building = fort_15th
						speed = 1
						cost = 0
					}
				}
				remove_country_modifier = spiked_log_makeshift_fortifications
				add_permanent_province_modifier = { name = spiked_log_spiky_traps duration = -1 }
			}
			if = {
				limit = {
					NOT = {
						deepwoods_arrow_grove = {
							country_or_non_sovereign_subject_holds = ROOT
							NOT = { is_capital_of = ROOT }
							has_fort_building_trigger = yes
						}
					}
				}
				3037 = {
					add_building_construction = {
						building = fort_15th
						speed = 1
						cost = 0
					}
					add_permanent_province_modifier = { name = spiked_log_spiky_traps duration = -1 }
				}
			}
			else = {
				random_owned_province = {
					limit = {
						province_group = deepwoods_arrow_grove
						NOT = { is_capital_of = ROOT }
						has_fort_building_trigger = yes
					}
					add_permanent_province_modifier = { name = spiked_log_spiky_traps duration = -1 }
				}
			}
			custom_tooltip = spiked_log_spiky_trap_removal_conditions_tt
		}
	}

	spiked_log_expand_log_production = {
		icon = mission_alone_in_the_wood
		position = 6
		required_missions = { spiked_log_silver_lining }
		provinces_to_highlight = {
			country_or_non_sovereign_subject_holds = ROOT
			trade_goods = tropical_wood
			OR = {
				NOT = { has_production_building_trigger = yes }
				NOT = { base_production = 6 }
			}
		}

		trigger = {
			num_of_provinces_owned_or_owned_by_non_sovereign_subjects_with = {
				value = 5
				trade_goods = tropical_wood
				base_production = 6
				has_production_building_trigger = yes
			}
			custom_trigger_tooltip = {
				tooltip = spiked_log_advisor_mil_tt
				OR = {
					employed_advisor = {
						type = fortification_expert
					}
					employed_advisor = {
						category = MIL
						skill = 2
					}
				}
			}
		}

		effect = {
			custom_tooltip = spiked_log_spikes_log_supply_tt
			hidden_effect = {
				for = {
					amount = 5
					effect = "
						random_owned_or_non_tributary_subject_province = {
							limit = {
								superregion = deepwoods_superregion
								trade_goods = tropical_wood
								has_production_building_trigger = yes
								base_production = 6
								NOT = { has_province_modifier = spiked_log_spikes_and_logs_supply }
							}
							add_permanent_province_modifier = { 
								name = spiked_log_spikes_and_logs_supply
								duration = -1
							}
						}
					"
				}
			}
			if = {
				limit = { has_country_modifier = spiked_log_unchecked_cartel_spending } #hidden before it's relevant
				complex_dynamic_effect = {
					first_custom_tooltip = spiked_log_expand_log_production_bonus_trigger_tt
					first_limit = "mission_completed = spiked_log_cartel_collaboration"
					first_effect = "remove_country_modifier = spiked_log_unchecked_cartel_spending"
				}
			}
			custom_tooltip = spiked_log_unlock_install_trap_button_tt
			set_country_flag = spiked_log_unlock_install_trap_button
		}
	}
}
spiked_log_5_blank = {
	slot = 5
	generic = no
	ai = yes
	has_country_shield = yes
	potential = { tag = I36 }

}
spiked_log_5 = {
	slot = 5
	generic = no
	ai = yes
	has_country_shield = yes
	potential = { tag = I36 }

	spiked_log_beyond_the_veil = {
		icon = mission_harpy_diplomats
		position = 4
		required_missions = { spiked_log_reach_out }
		provinces_to_highlight = {
			superregion = bulwar_superregion
			is_capital = yes
		}

		trigger = {
			OR = {
				any_ally = {
					culture_group = harpy
					capital_scope = { superregion = bulwar_superregion }
					has_opinion = {
						who = ROOT
						value = 150
					}
				}
				any_known_country = {
					capital_scope = { superregion = bulwar_superregion }
					has_90_opinion_improved_relation = { target = ROOT }
					has_20_opinion_sent_gift = { target = ROOT }
				}
			}
			OR = {
				capital_scope = { has_trade_building_trigger = yes }
				AND = {
					treasury = 50
					capital_scope = { has_no_ongoing_construction = yes }
				}
			}
		}

		effect = {
			capital_scope = {
				add_harpy_minority_size_effect = yes
				center_of_trade = 1
			}
			medium_increase_of_harpy_tolerance_effect = yes
			if = {
				limit = { capital_scope = { NOT = { has_trade_building_trigger = yes } } }
				capital_scope = {
					add_building_construction = {
						building = marketplace
						speed = 1
						cost = 0
					}
				}
				add_treasury = -50
			}
			unlock_merc_company = {
				merc_company = merc_haasananthu
			}
			country_event = { id = flavor_spiked_log.9 days = 365 }
		}
	}

	spiked_log_accomodate_the_cults = {
		icon = mission_forest_shrine
		position = 7
		required_missions = {
			spiked_log_beyond_the_veil
			spiked_log_expand_log_production
		}
		provinces_to_highlight = {
			OR = {
				brambleskinner_building_grove_highlight = { grove = arrow building = tax }
				brambleskinner_building_grove_highlight = { grove = shadow building = tax }
				brambleskinner_building_grove_highlight = { grove = river building = tax }
				brambleskinner_building_grove_highlight = { grove = hunter building = tax }
				brambleskinner_building_grove_highlight = { grove = thorn building = tax }
				brambleskinner_building_grove_highlight = { grove = lake building = tax }
				brambleskinner_building_grove_highlight = { grove = bone building = tax }
				brambleskinner_building_grove_highlight = { grove = mountain building = tax }
				brambleskinner_building_grove_highlight = { grove = flower building = tax }
			}
		}

		trigger = {
			spiked_log_accomodate_cult_trigger = { grove = arrow }
			spiked_log_accomodate_cult_trigger = { grove = shadow }
			spiked_log_accomodate_cult_trigger = { grove = river }
			spiked_log_accomodate_cult_trigger = { grove = hunter }
			spiked_log_accomodate_cult_trigger = { grove = thorn }
			spiked_log_accomodate_cult_trigger = { grove = lake }
			spiked_log_accomodate_cult_trigger = { grove = bone }
			spiked_log_accomodate_cult_trigger = { grove = mountain }
			spiked_log_accomodate_cult_trigger = { grove = flower }
			custom_trigger_tooltip = {
				tooltip = spiked_log_advisor_adm_tt
				OR = {
					AND = {
						religion = the_jadd
						employed_advisor = {
							type = inquisitor
						}
					}
					AND = {
						NOT = { religion = the_jadd }
						employed_advisor = {
							type = theologian
						}
					}
					employed_advisor = {
						category = ADM
						skill = 2
					}
				}
			}
		}

		effect = {
			complex_dynamic_effect = {
				first_custom_tooltip = spiked_log_accomodate_the_cults_gob_shamanism
				first_limit = "religion = goblinic_shamanism"
				first_effect = "
					custom_tooltip = spiked_log_accomodate_the_cults_gob_shamanism_effect_tt
					set_country_flag = spiked_log_very_flexible_cults
					spiked_log_unlock_upgrade_shamanist_cult = { cult = vortza_lesa }
				"
				second_custom_tooltip = spiked_log_accomodate_the_cults_the_jadd
				second_limit = "religion = the_jadd"
				second_effect = "
					capital_scope = { add_permanent_province_modifier = { name = spiked_log_lesa_eduz_sunka duration = -1 } }
					custom_tooltip = spiked_log_accomodate_the_cults_the_jadd_effect_tt
					set_country_flag = spiked_log_jadd_holy_order_refund
				"
				third_custom_tooltip = spiked_log_accomodate_the_cults_others
				third_limit = "NOT = { religion = goblinic_shamanism religion = the_jadd }"
				third_effect = "
					add_country_modifier = { name = spiked_log_appeased_the_cults duration = 9125 } #25 years
				"
			}
		}
	}

	spiked_log_pactbreakers = {
		icon = mission_magical_forest
		position = 8
		required_missions = { spiked_log_accomodate_the_cults }
		provinces_to_highlight = {
			owner = { primary_culture = wood_elf }
			superregion = deepwoods_superregion
			OR = {
				owner = { war_with = ROOT }
				ROOT = {
					NOT = {
						any_war_enemy_country = {
							primary_culture = wood_elf
							capital_scope = { superregion = deepwoods_superregion }
						}
					}
				}
			}
		}

		trigger = {
			OR = {
				custom_trigger_tooltip = {
					tooltip = spiked_log_war_with_elves_tt
					any_war_enemy_country = {
						primary_culture = wood_elf
						capital_scope = { superregion = deepwoods_superregion }
						NOT = {
							war_score_against = {
								who = ROOT
								value = -94
							}
						}
					}
				}
				custom_trigger_tooltip = {
					tooltip = brambleskinner_no_more_elves_tt
					NOT = {
						any_known_country = {
							primary_culture = wood_elf
							capital_scope = { superregion = deepwoods_superregion }
						}
					}
				}
			}
		}

		effect = {
			country_event = { id = flavor_spiked_log.16 }
		}
	}
}
